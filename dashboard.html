<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DLS Draft - Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/emoji-picker-element@latest">
    <style>
        :root {
            --primary-dark: #0a0e27;
            --secondary-dark: #151930;
            --accent-gold: #ffd700;
            --accent-green: #00ff88;
            --text-white: #ffffff;
            --text-gray: #b8b8b8;
            --hover-glow: rgba(255, 215, 0, 0.4);
            --card-bg: rgba(21, 25, 48, 0.85);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--primary-dark);
            color: var(--text-white);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* HEADER */
        .header {
            background: rgba(10, 14, 39, 0.95);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
            padding: 20px 6%;
            display: flex;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            gap: 50px;
        }

        .app-logo {
            font-size: 1.8em;
            font-weight: 900;
            color: var(--accent-gold);
            text-shadow: 0 0 20px var(--hover-glow);
            letter-spacing: 2px;
        }

        .header-center {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin-left: auto;
            margin-right: auto;
        }

        .header-btn {
            padding: 12px 30px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            background: transparent;
            color: var(--text-white);
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .header-btn:hover {
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            color: var(--accent-gold);
        }

        .profile-btn {
            position: fixed;
            top: 20px;
            right: 30px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            border: 2px solid rgba(255, 215, 0, 0.5);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            transition: all 0.3s ease;
            z-index: 101;
        }

        .profile-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--hover-glow);
        }

        /* BANNER ADS */
        .banner-section {
            padding: 30px 6%;
            background: linear-gradient(135deg, rgba(21, 25, 48, 0.5), rgba(10, 14, 39, 0.8));
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .banner-container {
            position: relative;
            height: 200px;
            border-radius: 20px;
            overflow: hidden;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .banner-scroll {
            display: flex;
            height: 100%;
            animation: scrollBanner 15s linear infinite;
        }

        .banner-item {
            min-width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.8);
        }

        @keyframes scrollBanner {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-400%);
            }
        }

        .banner-label {
            position: absolute;
            top: 50%;
            left: 6%;
            transform: translateY(-50%);
            font-size: 2.5em;
            font-weight: 900;
            color: var(--accent-gold);
            text-shadow: 0 0 30px var(--hover-glow);
            z-index: 10;
        }

        /* NAVIGATION BUTTONS */
        .nav-buttons-section {
            padding: 20px 6%;
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .nav-buttons-scroll {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 10px 0;
            scroll-behavior: smooth;
        }

        .nav-buttons-scroll::-webkit-scrollbar {
            height: 6px;
        }

        .nav-buttons-scroll::-webkit-scrollbar-track {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
        }

        .nav-buttons-scroll::-webkit-scrollbar-thumb {
            background: var(--accent-gold);
            border-radius: 10px;
        }

        .nav-btn {
            padding: 12px 25px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            color: var(--text-white);
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .nav-btn:hover {
            background: rgba(255, 215, 0, 0.15);
            border-color: var(--accent-gold);
            color: var(--accent-gold);
            transform: translateY(-3px);
            box-shadow: 0 5px 20px var(--hover-glow);
        }

        /* MORE MENU POPUP */
        .more-menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 900;
            justify-content: center;
            align-items: center;
        }

        .more-menu-overlay.active {
            display: flex;
        }

        .more-menu-container {
            background: var(--card-bg);
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(255, 215, 0, 0.2);
            animation: slideIn 0.3s ease;
        }

        .more-menu-title {
            font-size: 1.5em;
            font-weight: 900;
            color: var(--accent-gold);
            text-align: center;
            margin-bottom: 25px;
            text-shadow: 0 0 20px var(--hover-glow);
        }

        .more-menu-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .more-menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 20px 15px;
            background: rgba(255, 215, 0, 0.08);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-white);
            text-decoration: none;
        }

        .more-menu-item:hover {
            background: rgba(255, 215, 0, 0.15);
            border-color: var(--accent-gold);
            color: var(--accent-gold);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px var(--hover-glow);
        }

        .more-menu-icon {
            font-size: 2.5em;
            color: var(--accent-gold);
            transition: all 0.3s ease;
        }

        .more-menu-item:hover .more-menu-icon {
            transform: scale(1.2) rotate(10deg);
        }

        .more-menu-text {
            font-weight: 600;
            font-size: 0.95em;
            text-align: center;
        }

        .more-menu-close {
            margin-top: 25px;
            padding: 12px 25px;
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--accent-gold);
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            font-size: 0.95em;
        }

        .more-menu-close:hover {
            background: rgba(255, 215, 0, 0.25);
            border-color: var(--accent-gold);
        }



        /* TABS */
        .tabs-section {
            padding: 20px 6%;
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .tabs-container {
            display: flex;
            gap: 20px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.1);
            overflow-x: auto;
            scroll-behavior: smooth;
        }

        .tabs-container::-webkit-scrollbar {
            height: 4px;
        }

        .tabs-container::-webkit-scrollbar-track {
            background: rgba(255, 215, 0, 0.05);
        }

        .tabs-container::-webkit-scrollbar-thumb {
            background: var(--accent-gold);
            border-radius: 10px;
        }

        .tab {
            padding: 15px 25px;
            background: transparent;
            border: none;
            color: var(--text-gray);
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s ease;
            position: relative;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .tab.active {
            color: var(--accent-gold);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-gold);
            box-shadow: 0 0 10px var(--hover-glow);
        }

        .tab:hover {
            color: var(--accent-gold);
        }

        /* MATCHES SECTION */
        .matches-section {
            padding: 30px 6%;
        }

        .matches-container {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 15px 0;
            scroll-behavior: smooth;
            width: 100%;
            max-width: 100%;
        }

        .matches-container[style*="flex-wrap"] {
            overflow-x: visible;
            overflow-y: visible;
        }

        .matches-container[style*="nowrap"] {
            overflow-x: auto;
            overflow-y: hidden;
        }

        .matches-container::-webkit-scrollbar {
            height: 6px;
        }

        .matches-container::-webkit-scrollbar-track {
            background: rgba(255, 215, 0, 0.05);
        }

        .matches-container::-webkit-scrollbar-thumb {
            background: var(--accent-gold);
            border-radius: 10px;
        }

        /* MAIN MATCH CARD */
        .match-card {
            min-width: 700px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 20px;
            padding: 15px 25px;
            flex-shrink: 0;
            transition: all 0.3s ease;
            animation: slideIn 0.5s ease forwards;
            opacity: 0;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
            }
        }

        .match-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 10px 40px var(--hover-glow);
            transform: translateY(-5px);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .competition-type {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid rgba(255, 215, 0, 0.4);
            color: var(--accent-gold);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .match-time {
            font-size: 1.1em;
            color: var(--text-gray);
            font-weight: 600;
        }

        .teams-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            gap: 30px;
        }

        .team {
            text-align: center;
            flex: 1;
        }

        .team-logo {
            width: 45px;
            height: 45px;
            border-radius: 8px;
            margin: 0 auto 8px;
            background: rgba(255, 215, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .team-name {
            font-size: 1em;
            font-weight: 700;
            color: var(--text-white);
            margin-bottom: 4px;
        }

        .team-info {
            font-size: 0.75em;
            color: var(--text-gray);
        }

        .vs-divider {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            color: var(--accent-gold);
            font-weight: 900;
            min-width: 80px;
        }

        .match-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 215, 0, 0.1);
        }

        .live-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.4);
            color: #ff6b6b;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .live-badge.available {
            background: rgba(0, 255, 136, 0.2);
            border-color: rgba(0, 255, 136, 0.4);
            color: var(--accent-green);
        }

        .host-name {
            font-size: 0.9em;
            color: var(--text-gray);
            font-weight: 500;
        }

        /* MINI PROFILE CARD */
        .profile-card {
            min-width: 15px;
            height: auto;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            overflow: hidden;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
        }

        .profile-side {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            min-height: 100px;
        }

        .profile-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.9);
        }

        /* PREDICTIONS & GOAL SCORERS STYLES */
        .prediction-item {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-white);
            font-size: 0.95em;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--accent-gold);
        }

        .checkbox-item label {
            cursor: pointer;
            color: var(--text-white);
            font-weight: 500;
        }

        .goal-input-row {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr auto;
            gap: 10px;
            margin-bottom: 15px;
        }

        .stat-card {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-label {
            color: var(--text-gray);
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .stat-value {
            color: var(--accent-gold);
            font-size: 1.8em;
            font-weight: 900;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .watch-fee-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 1300;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .watch-fee-modal.active {
            display: flex;
        }

        .watch-fee-content {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 25px;
            padding: 40px;
            width: 100%;
            max-width: 700px;
            margin: auto;
            animation: slideUp 0.4s ease;
        }

        .watch-fee-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
        }

        .watch-fee-title {
            color: var(--accent-gold);
            font-size: 1.5em;
            font-weight: 900;
            margin: 0;
        }

        .watch-fee-close {
            background: transparent;
            border: none;
            color: var(--text-white);
            font-size: 2em;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .watch-fee-close:hover {
            color: var(--accent-gold);
        }

        .watch-fee-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.1);
        }

        .watch-fee-tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            color: var(--text-gray);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
        }

        .watch-fee-tab.active {
            color: var(--accent-gold);
        }

        .watch-fee-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-gold);
        }

        .watch-fee-tab-content {
            display: none;
        }

        .watch-fee-tab-content.active {
            display: block;
        }

        .viewers-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .viewer-item {
            background: rgba(255, 215, 0, 0.08);
            border: 1px solid rgba(255, 215, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .no-viewers-message {
            text-align: center;
            color: var(--text-gray);
            padding: 40px 20px;
        }

        /* FULL STATS MODAL */
        .stats-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 8000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .stats-modal-overlay.active {
            display: flex;
        }

        .stats-modal {
            background: var(--primary-dark);
            border: 3px solid rgba(255, 215, 0, 0.5);
            border-radius: 25px;
            width: 100%;
            max-width: 1200px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            animation: slideInUp 0.4s ease;
        }

        .stats-modal-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(0, 255, 136, 0.1));
            border-bottom: 2px solid rgba(255, 215, 0, 0.4);
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .stats-modal-title {
            font-size: 2em;
            font-weight: 900;
            color: var(--accent-gold);
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
            margin: 0;
        }

        .stats-modal-close {
            font-size: 2.5em;
            cursor: pointer;
            color: var(--text-gray);
            background: none;
            border: none;
            padding: 0;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .stats-modal-close:hover {
            color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            transform: rotate(90deg);
        }

        .stats-modal-content {
            padding: 30px;
        }

        .stats-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 15px;
        }

        .stats-section-title {
            color: var(--accent-gold);
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .stat-box {
            background: rgba(255, 215, 0, 0.08);
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-box-label {
            color: var(--text-gray);
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .stat-box-value {
            color: var(--accent-gold);
            font-size: 1.8em;
            font-weight: 900;
        }

        .prediction-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .prediction-badge {
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 10px 15px;
            border-radius: 8px;
            color: var(--text-white);
            font-size: 0.95em;
        }

        .goal-scorers-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .goal-scorer-item {
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 12px 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .livestream-btn {
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
            border: 2px solid rgba(255, 107, 107, 0.4);
            color: white;
            padding: 12px 30px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .livestream-btn:hover {
            background: linear-gradient(135deg, #ff5252, #ff3838);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
            transform: translateY(-2px);
        }

        /* UPCOMING MATCH COMPACT CARD */
        .upcoming-match-card {
            width: 100%;
            min-width: 280px;
            max-width: 450px;
            height: auto;
            padding: 15px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .upcoming-match-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 5px 20px var(--hover-glow);
            transform: translateY(-3px);
        }

        .upcoming-logo-section {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            flex-shrink: 0;
            overflow: hidden;
            background: rgba(255, 215, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .upcoming-team-logo {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.5em;
            color: var(--accent-gold);
        }

        .upcoming-team-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 4px;
        }

        .upcoming-info-section {
            flex: 1;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 8px;
            min-width: 0;
        }

        .upcoming-teams {
            font-size: 0.95em;
            font-weight: 700;
            color: var(--text-white);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.2;
        }

        .upcoming-date {
            font-size: 0.8em;
            color: var(--accent-gold);
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .upcoming-datetime {
            font-size: 0.85em;
            color: var(--text-gray);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .upcoming-players-btn {
            padding: 6px 12px;
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--accent-gold);
            border-radius: 6px;
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            font-weight: 500;
        }

        .upcoming-players-btn:hover {
            background: rgba(255, 215, 0, 0.25);
            border-color: var(--accent-gold);
            transform: translateY(-2px);
        }

        /* RESPONSIVE DESIGN FOR UPCOMING CARDS */
        @media (max-width: 1200px) {
            .upcoming-match-card {
                min-width: 260px;
                max-width: 400px;
            }
        }

        @media (max-width: 768px) {
            .upcoming-match-card {
                min-width: 240px;
                max-width: 350px;
                padding: 12px;
            }

            .upcoming-logo-section {
                width: 50px;
                height: 50px;
            }

            .upcoming-team-logo {
                font-size: 1.2em;
            }

            .upcoming-teams {
                font-size: 0.9em;
            }

            .upcoming-date {
                font-size: 0.75em;
            }

            .upcoming-datetime {
                font-size: 0.8em;
            }

            .upcoming-players-btn {
                padding: 5px 10px;
                font-size: 0.75em;
            }
        }

        @media (max-width: 480px) {
            .upcoming-match-card {
                min-width: 200px;
                max-width: 100%;
                padding: 10px;
                gap: 10px;
            }

            .upcoming-logo-section {
                width: 45px;
                height: 45px;
            }

            .upcoming-team-logo {
                font-size: 1em;
            }

            .upcoming-teams {
                font-size: 0.85em;
            }

            .upcoming-date {
                font-size: 0.7em;
            }

            .upcoming-datetime {
                font-size: 0.75em;
            }

            .upcoming-players-btn {
                padding: 4px 8px;
                font-size: 0.7em;
            }
        }

        /* PLAYERS MODAL */
        .players-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 8000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .players-modal-overlay.active {
            display: flex;
        }

        .players-modal {
            background: var(--primary-dark);
            border: 3px solid rgba(255, 215, 0, 0.5);
            border-radius: 25px;
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            animation: slideInUp 0.4s ease;
        }

        .players-modal-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(0, 255, 136, 0.1));
            border-bottom: 2px solid rgba(255, 215, 0, 0.4);
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .players-modal-title {
            font-size: 1.8em;
            font-weight: 900;
            color: var(--accent-gold);
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
            margin: 0;
        }

        .players-modal-close {
            font-size: 2.5em;
            cursor: pointer;
            color: var(--text-gray);
            background: none;
            border: none;
            padding: 0;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .players-modal-close:hover {
            color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            transform: rotate(90deg);
        }

        .players-modal-content {
            padding: 30px;
        }

        .team-players-section {
            margin-bottom: 30px;
        }

        /* HIGHLIGHTS MODAL */
        .highlights-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.98);
            z-index: 7000;
            overflow-y: auto;
        }

        .highlights-modal-overlay.active {
            display: block;
        }

        .highlights-modal {
            background: var(--primary-dark);
            min-height: 100vh;
            padding: 0;
        }

        .highlights-modal-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(0, 255, 136, 0.1));
            border-bottom: 2px solid rgba(255, 215, 0, 0.4);
            padding: 20px 6%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .highlights-modal-close {
            font-size: 3em;
            cursor: pointer;
            color: var(--text-gray);
            background: none;
            border: none;
            padding: 0;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .highlights-modal-close:hover {
            color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            transform: rotate(90deg);
        }

        .highlights-banner {
            padding: 20px 6%;
        }

        .highlights-controls {
            padding: 20px 6%;
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .highlights-categories {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 10px 20px;
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.2);
            color: var(--text-white);
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .category-btn:hover,
        .category-btn.active {
            background: rgba(255, 215, 0, 0.3);
            border-color: var(--accent-gold);
            color: var(--accent-gold);
        }

        .highlights-container {
            padding: 30px 6%;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .highlight-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .highlight-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 10px 40px var(--hover-glow);
            transform: translateY(-5px);
        }

        .highlight-thumbnail {
            width: 100%;
            height: 160px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(0, 255, 136, 0.05));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            position: relative;
            overflow: hidden;
        }

        .highlight-play-btn {
            position: absolute;
            width: 60px;
            height: 60px;
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid var(--accent-gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            transition: all 0.3s ease;
        }

        .highlight-card:hover .highlight-play-btn {
            background: rgba(255, 215, 0, 0.4);
            transform: scale(1.1);
        }

        .highlight-info {
            padding: 15px;
        }

        .highlight-title {
            color: var(--text-white);
            font-weight: 700;
            font-size: 0.95em;
            margin-bottom: 8px;
        }

        .highlight-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
            color: var(--text-gray);
        }

        /* FULL MATCHES MODAL */
        .full-matches-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.98);
            z-index: 7000;
            overflow-y: auto;
        }

        .full-matches-modal-overlay.active {
            display: block;
        }

        .full-matches-modal {
            background: var(--primary-dark);
            min-height: 100vh;
            padding: 0;
        }

        .full-matches-modal-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(0, 255, 136, 0.1));
            border-bottom: 2px solid rgba(255, 215, 0, 0.4);
            padding: 20px 6%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .full-matches-modal-close {
            font-size: 3em;
            cursor: pointer;
            color: var(--text-gray);
            background: none;
            border: none;
            padding: 0;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .full-matches-modal-close:hover {
            color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            transform: rotate(90deg);
        }

        .full-matches-banner {
            padding: 20px 6%;
        }

        .full-matches-controls {
            padding: 20px 6%;
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .full-matches-container {
            padding: 30px 6%;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .full-match-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            padding: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .full-match-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 10px 40px var(--hover-glow);
            transform: translateY(-5px);
        }

        .full-match-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .full-match-card-score {
            font-size: 1.8em;
            font-weight: 900;
            color: var(--accent-gold);
            text-align: center;
            margin: 15px 0;
        }

        .full-match-mini-banner {
            width: 100%;
            height: 60px;
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-gray);
            font-size: 0.9em;
            margin: 20px 0;
        }

        .team-players-title {
            color: var(--accent-gold);
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
        }

        .players-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .player-card {
            background: rgba(255, 215, 0, 0.08);
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .player-name {
            color: var(--text-white);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .player-role {
            color: var(--accent-gold);
            font-size: 0.85em;
            font-weight: 500;
        }

        /* PLAYERS RATING MODAL */
        .players-rating-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 8000;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            padding: 20px;
        }

        .players-rating-overlay.active {
            display: flex;
        }

        .players-rating-modal {
            background: var(--primary-dark);
            border: 3px solid rgba(255, 215, 0, 0.5);
            border-radius: 25px;
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            animation: slideInUp 0.4s ease;
        }

        .players-rating-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(0, 255, 136, 0.1));
            border-bottom: 2px solid rgba(255, 215, 0, 0.4);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .players-rating-title {
            font-size: 1.8em;
            font-weight: 900;
            color: var(--accent-gold);
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.4);
            margin: 0;
        }

        .players-rating-close {
            font-size: 2.5em;
            cursor: pointer;
            color: var(--text-gray);
            background: none;
            border: none;
            padding: 0;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .players-rating-close:hover {
            color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            transform: rotate(90deg);
        }

        .players-rating-content {
            padding: 30px;
        }

        .players-rating-top {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 30px;
        }

        .players-rating-search-input {
            flex: 1;
            max-width: 400px;
            padding: 12px 16px;
            background: rgba(255, 215, 0, 0.08);
            border: 2px solid rgba(255, 215, 0, 0.3);
            color: var(--text-white);
            border-radius: 10px;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .players-rating-search-input:focus {
            outline: none;
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.12);
            box-shadow: 0 0 20px var(--hover-glow);
        }

        .players-rating-search-input::placeholder {
            color: var(--text-gray);
        }

        .players-rating-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .register-btn {
            padding: 10px 18px;
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            border: none;
            color: var(--primary-dark);
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .register-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--hover-glow);
        }

        .edit-card-btn {
            padding: 10px 18px;
            background: rgba(0, 255, 136, 0.15);
            border: 2px solid rgba(0, 255, 136, 0.3);
            color: var(--accent-green);
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .edit-card-btn:hover {
            background: rgba(0, 255, 136, 0.25);
            border-color: var(--accent-green);
            transform: translateY(-2px);
        }

        .delete-card-btn {
            padding: 10px 18px;
            background: rgba(255, 76, 76, 0.15);
            border: 2px solid rgba(255, 76, 76, 0.3);
            color: #ff6b6b;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .delete-card-btn:hover {
            background: rgba(255, 76, 76, 0.25);
            border-color: #ff6b6b;
            transform: translateY(-2px);
        }

        /* REGISTERED PLAYERS CARDS - ID FORMAT */
        .registered-players-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
            width: 100%;
        }

        .player-card {
            background: var(--card-bg);
            border: 2px solid rgba(255, 215, 0, 0.2);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            animation: slideIn 0.5s ease forwards;
            opacity: 0;
            display: flex;
            align-items: stretch;
            height: 140px;
            width: 100%;
            box-sizing: border-box;
            gap: 0;
            position: relative;
        }

        .player-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 10px 30px var(--hover-glow);
        }

        .player-card-picture-section {
            width: 140px;
            height: 140px;
            flex-shrink: 0;
            overflow: hidden;
            background: rgba(255, 215, 0, 0.08);
        }

        .player-card-picture {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .player-card-default-icon {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            color: var(--accent-gold);
        }

        .player-card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 12px 15px 8px 15px;
            gap: 6px;
            box-sizing: border-box;
            overflow: hidden;
            justify-content: space-between;
        }

        .player-card-info-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            width: 100%;
            box-sizing: border-box;
        }

        .player-card-name-section {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        .player-card-name {
            font-size: 1em;
            font-weight: 900;
            color: var(--accent-gold);
            margin: 0;
            line-height: 1.1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-card-club {
            font-size: 0.7em;
            color: var(--text-gray);
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-card-stats-mini {
            display: flex;
            gap: 15px;
            font-size: 0.75em;
            color: var(--text-gray);
        }

        .player-card-stat-mini {
            display: flex;
            align-items: center;
            gap: 3px;
            white-space: nowrap;
        }

        .player-card-stat-value-mini {
            color: var(--accent-gold);
            font-weight: 700;
        }

        .player-card-footer {
            display: flex;
            gap: 8px;
            padding: 0 15px 12px 15px;
            width: 100%;
            box-sizing: border-box;
        }

        .player-card-footer button {
            padding: 7px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.75em;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 80px;
        }

        .player-card-view-btn {
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--accent-gold);
        }

        .player-card-view-btn:hover {
            background: rgba(255, 215, 0, 0.25);
            border-color: var(--accent-gold);
        }

        .player-card-rating-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.2), rgba(255, 215, 0, 0.2));
            border: 2px solid var(--accent-gold);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px var(--hover-glow);
            font-weight: 700;
            flex-shrink: 0;
            z-index: 10;
        }

        .player-card-rating-number {
            font-size: 1.6em;
            color: var(--accent-gold);
            line-height: 1;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
        }

        .player-card-rating-count {
            font-size: 0.6em;
            color: var(--text-gray);
            margin-top: 2px;
        }

        /* SHARE LINK MODAL */
        .share-link-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .share-link-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .share-link-container {
            background: var(--card-bg);
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 20px;
            padding: 40px 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 80px rgba(255, 215, 0, 0.3);
            animation: slideUp 0.3s ease;
            text-align: center;
        }

        .share-link-title {
            font-size: 1.8em;
            font-weight: 900;
            color: var(--accent-gold);
            margin-bottom: 20px;
            text-shadow: 0 0 20px var(--hover-glow);
        }

        .share-link-input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            color: var(--text-white);
            font-size: 0.9em;
            margin-bottom: 15px;
            word-break: break-all;
            user-select: all;
            transition: all 0.3s ease;
        }

        .share-link-input:focus {
            border-color: var(--accent-gold);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }

        .share-link-buttons {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        .share-link-btn {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            background: rgba(255, 215, 0, 0.1);
            color: var(--accent-gold);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .share-link-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: var(--accent-gold);
            transform: translateY(-2px);
        }

        .share-link-btn.copy {
            background: var(--accent-gold);
            color: var(--primary-dark);
        }

        .share-link-btn.copy:hover {
            background: #ffed4e;
            box-shadow: 0 5px 15px var(--hover-glow);
        }

        .share-link-description {
            color: var(--text-gray);
            font-size: 0.95em;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .share-link-input-group {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }

        .share-link-input {
            flex: 1;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            color: var(--text-white);
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .share-link-input:focus {
            border-color: var(--accent-gold);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
            outline: none;
        }

        .share-link-copy-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            border: none;
            color: var(--primary-dark);
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .share-link-copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px var(--hover-glow);
        }

        .share-link-close-btn {
            width: 100%;
            padding: 12px 20px;
            margin-top: 20px;
            background: rgba(255, 215, 0, 0.15);
            border: 2px solid rgba(255, 215, 0, 0.3);
            color: var(--accent-gold);
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .share-link-close-btn:hover {
            background: rgba(255, 215, 0, 0.25);
            border-color: var(--accent-gold);
        }

        /* REGISTRATION FORM MODAL */
        .registration-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9000;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            padding: 20px;
        }

        .registration-modal-overlay.active {
            display: flex;
        }

        .registration-modal {
            background: var(--primary-dark);
            border: 3px solid rgba(255, 215, 0, 0.5);
            border-radius: 25px;
            width: 100%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            animation: slideInUp 0.4s ease;
        }

        .registration-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(0, 255, 136, 0.1));
            border-bottom: 2px solid rgba(255, 215, 0, 0.4);
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .registration-title {
            font-size: 1.6em;
            font-weight: 900;
            color: var(--accent-gold);
            margin: 0;
        }

        .registration-close {
            font-size: 2.5em;
            cursor: pointer;
            color: var(--text-gray);
            background: none;
            border: none;
            padding: 0;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .registration-close:hover {
            color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            transform: rotate(90deg);
        }

        .registration-content {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            color: var(--accent-gold);
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 215, 0, 0.08);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--text-white);
            border-radius: 8px;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.12);
            box-shadow: 0 0 15px var(--hover-glow);
        }

        .form-input::placeholder {
            color: var(--text-gray);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-upload {
            padding: 20px;
            background: rgba(255, 215, 0, 0.08);
            border: 2px dashed rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .form-upload:hover {
            background: rgba(255, 215, 0, 0.12);
            border-color: var(--accent-gold);
        }

        .form-upload input[type="file"] {
            display: none;
        }

        .upload-text {
            color: var(--accent-gold);
            font-weight: 600;
            font-size: 0.95em;
        }

        .form-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            border: none;
            color: var(--primary-dark);
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .form-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px var(--hover-glow);
        }

        .form-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* PLAYER DETAILS MODAL */
        .player-details-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9500;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            padding: 20px;
        }

        .player-details-overlay.active {
            display: flex;
        }

        .player-details-modal {
            background: var(--primary-dark);
            border: 3px solid rgba(255, 215, 0, 0.5);
            border-radius: 25px;
            width: 90%;
            max-width: 850px;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
            animation: slideInUp 0.4s ease;
            overflow: hidden;
            max-height: 85vh;
            overflow-y: auto;
        }

        .player-details-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(0, 255, 136, 0.1));
            border-bottom: 2px solid rgba(255, 215, 0, 0.4);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .player-details-title {
            font-size: 1.6em;
            font-weight: 900;
            color: var(--accent-gold);
            margin: 0;
        }

        .player-details-close {
            font-size: 2.5em;
            cursor: pointer;
            color: var(--text-gray);
            background: none;
            border: none;
            padding: 0;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .player-details-close:hover {
            color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            transform: rotate(90deg);
        }

        /* ID CARD LAYOUT */
        .player-id-card {
            display: flex;
            gap: 25px;
            padding: 25px;
            position: relative;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(0, 255, 136, 0.05));
            flex-wrap: wrap;
            box-sizing: border-box;
        }

        .player-id-left {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        .player-id-picture-container {
            width: 200px;
            height: 200px;
            border: 4px solid var(--accent-gold);
            border-radius: 15px;
            overflow: hidden;
            background: rgba(255, 215, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px var(--hover-glow);
            flex-shrink: 0;
        }

        .player-id-picture {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .player-id-default-icon {
            font-size: 5em;
            color: var(--accent-gold);
        }

        .player-id-right {
            flex: 1 1 250px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            position: relative;
            min-width: 200px;
            box-sizing: border-box;
        }

        .player-id-name {
            font-size: 2em;
            font-weight: 900;
            color: var(--accent-gold);
            margin: 0;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .player-id-club {
            font-size: 1.1em;
            color: var(--text-gray);
            margin: 5px 0 20px 0;
        }

        .player-id-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 15px;
            margin-top: 10px;
        }

        .player-id-stat-block {
            background: rgba(255, 215, 0, 0.08);
            border: 2px solid rgba(255, 215, 0, 0.2);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .player-id-stat-label {
            font-size: 0.85em;
            color: var(--text-gray);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .player-id-stat-value {
            font-size: 1.5em;
            color: var(--accent-gold);
            font-weight: 900;
        }

        .player-id-rating-corner {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.2), rgba(255, 215, 0, 0.2));
            border: 3px solid var(--accent-gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            box-shadow: 0 0 30px var(--hover-glow);
            z-index: 20;
        }

        .player-id-rating-label {
            font-size: 0.7em;
            color: var(--text-gray);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .player-id-rating-number {
            font-size: 2.5em;
            font-weight: 900;
            color: var(--accent-gold);
            line-height: 1;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
        }

        .player-id-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 215, 0, 0.2);
            width: 100%;
            box-sizing: border-box;
        }

        .player-id-btn {
            flex: 1 1 auto;
            min-width: 100px;
            padding: 10px 12px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            background: rgba(255, 215, 0, 0.1);
            color: var(--accent-gold);
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            text-align: center;
            white-space: nowrap;
        }

        .player-id-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: var(--accent-gold);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px var(--hover-glow);
        }

        .player-id-best-players {
            margin-top: 15px;
            padding: 12px 15px;
            background: rgba(255, 215, 0, 0.08);
            border-radius: 10px;
            border-left: 4px solid var(--accent-gold);
            width: 100%;
            box-sizing: border-box;
            flex-basis: 100%;
        }

        .player-id-best-players-label {
            font-size: 0.9em;
            color: var(--text-gray);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .player-id-best-players-value {
            color: var(--accent-gold);
            font-size: 0.95em;
            line-height: 1.5;
        }

        /* CARD MESSAGING MODAL */
        .card-messaging-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            z-index: 9500;
            overflow-y: auto;
        }

        .card-messaging-overlay.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .card-messaging-modal {
            background: var(--primary-dark);
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 20px;
            width: 100%;
            max-width: 600px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
        }

        .card-messaging-header {
            background: rgba(255, 215, 0, 0.1);
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-messaging-title {
            color: var(--accent-gold);
            font-size: 1.3em;
            font-weight: 900;
            margin: 0;
        }

        .card-messaging-close {
            background: none;
            border: none;
            color: var(--text-gray);
            font-size: 2em;
            cursor: pointer;
            transition: color 0.3s ease;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-messaging-close:hover {
            color: var(--accent-gold);
        }

        .card-messages-list {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .card-message-item {
            background: rgba(255, 215, 0, 0.08);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 12px;
            padding: 15px;
            word-wrap: break-word;
            position: relative;
            transition: all 0.3s ease;
        }

        .card-message-item:hover {
            background: rgba(255, 215, 0, 0.12);
            border-color: rgba(255, 215, 0, 0.4);
        }

        .card-message-item:hover .message-actions {
            opacity: 1;
            visibility: visible;
        }

        .message-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 8px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .message-action-btn {
            width: 32px;
            height: 32px;
            background: rgba(255, 215, 0, 0.15);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 8px;
            color: var(--accent-gold);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .message-action-btn:hover {
            background: rgba(255, 215, 0, 0.3);
            border-color: var(--accent-gold);
            transform: scale(1.1);
        }

        .card-message-sender {
            color: var(--accent-gold);
            font-weight: 700;
            font-size: 0.9em;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-message-time {
            color: var(--text-gray);
            font-size: 0.75em;
        }

        .card-message-text {
            color: var(--text-white);
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .card-message-voice {
            margin: 10px 0;
        }

        .card-message-voice audio {
            width: 100%;
            max-width: 300px;
        }

        /* REPLY MODAL */
        .reply-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9600;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .reply-modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .reply-modal-container {
            background: rgba(21, 25, 48, 0.98);
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 20px;
            width: 100%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 80px rgba(255, 215, 0, 0.3);
            animation: slideUp 0.3s ease;
        }

        .reply-modal-header {
            padding: 25px 20px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .reply-modal-title {
            color: var(--accent-gold);
            font-size: 1.2em;
            font-weight: 700;
        }

        .reply-modal-sender-name {
            color: var(--text-gray);
            font-size: 0.9em;
            margin-top: 3px;
        }

        .reply-modal-close-btn {
            font-size: 1.8em;
            background: none;
            border: none;
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .reply-modal-close-btn:hover {
            color: var(--accent-gold);
            transform: rotate(90deg);
        }

        .reply-modal-content {
            padding: 20px;
        }

        .reply-original-message {
            background: rgba(255, 215, 0, 0.08);
            border-left: 4px solid var(--accent-gold);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .reply-original-text {
            color: var(--text-white);
            font-size: 0.95em;
            line-height: 1.4;
        }

        .reply-original-label {
            color: var(--text-gray);
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }

        .reply-original-audio {
            margin-top: 12px;
        }

        .reply-original-audio audio {
            width: 100%;
            max-width: 100%;
            height: 35px;
        }

        .user-reply-message {
            margin-top: 15px;
            padding: 12px;
            background: rgba(0, 255, 136, 0.1);
            border-left: 3px solid var(--accent-green);
            border-radius: 6px;
        }

        .user-reply-label {
            color: var(--accent-green);
            font-weight: 600;
            font-size: 0.9em;
            margin-bottom: 8px;
            display: block;
        }

        .user-reply-text {
            color: var(--text-white);
        }

        .user-reply-voice {
            color: var(--text-gray);
        }

        .user-reply-voice audio {
            width: 100%;
            height: 30px;
            margin-top: 8px;
        }

        .reply-input-section {
            margin-bottom: 15px;
        }

        .reply-input-label {
            display: block;
            color: var(--text-gray);
            font-size: 0.85em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .reply-textarea {
            width: 100%;
            min-height: 100px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--text-white);
            border-radius: 8px;
            padding: 12px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.95em;
            resize: vertical;
            box-sizing: border-box;
        }

        .reply-textarea:focus {
            outline: none;
            border-color: var(--accent-gold);
            background: rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
        }

        .reply-voice-indicator {
            display: none;
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
            color: #ff6b6b;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 0.85em;
            text-align: center;
            animation: pulse 1s infinite;
        }

        .reply-voice-indicator.active {
            display: block;
        }

        .reply-emoji-sticker-container {
            margin-bottom: 15px;
            display: flex;
            gap: 8px;
        }

        .reply-emoji-btn,
        .reply-sticker-btn {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            background: rgba(255, 215, 0, 0.1);
            color: var(--text-white);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 0.9em;
        }

        .reply-emoji-btn:hover,
        .reply-sticker-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: var(--accent-gold);
            color: var(--accent-gold);
        }

        .emoji-picker {
            display: none;
            position: absolute;
            bottom: 60px;
            right: 20px;
            z-index: 9700;
            background: var(--primary-dark);
            border: 2px solid var(--accent-gold);
            border-radius: 10px;
        }

        .emoji-picker.active {
            display: block;
        }

        .sticker-picker {
            display: none;
            position: absolute;
            bottom: 60px;
            right: 20px;
            z-index: 9700;
            background: var(--primary-dark);
            border: 2px solid var(--accent-gold);
            border-radius: 10px;
            padding: 15px;
            max-width: 300px;
        }

        .sticker-picker.active {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .sticker-item {
            padding: 10px;
            text-align: center;
            font-size: 2em;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s ease;
            background: rgba(255, 215, 0, 0.1);
        }

        .sticker-item:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: scale(1.2);
        }

        .reply-button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .reply-btn {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            background: rgba(255, 215, 0, 0.1);
            color: var(--text-white);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 0.9em;
        }

        .reply-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: var(--accent-gold);
            color: var(--accent-gold);
        }

        .reply-btn.recording {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff6b6b;
            color: #ff6b6b;
            animation: pulse 1s infinite;
        }

        .reply-send-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            border: none;
            color: var(--primary-dark);
            border-radius: 8px;
            font-weight: 700;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reply-send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
        }

        .reply-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .card-messaging-input-area {
            padding: 20px;
            border-top: 1px solid rgba(255, 215, 0, 0.2);
            background: rgba(255, 215, 0, 0.05);
        }

        .card-messaging-input {
            width: 100%;
            min-height: 80px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--text-white);
            border-radius: 10px;
            padding: 12px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.95em;
            resize: vertical;
            margin-bottom: 12px;
            box-sizing: border-box;
        }

        .card-messaging-input:focus {
            outline: none;
            border-color: var(--accent-gold);
            background: rgba(0, 0, 0, 0.5);
        }

        .card-messaging-buttons {
            display: flex;
            gap: 10px;
        }

        .card-messaging-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 0.9em;
        }

        .card-messaging-voice-btn {
            background: rgba(0, 255, 136, 0.2);
            color: var(--accent-green);
            border: 1px solid rgba(0, 255, 136, 0.4);
        }

        .card-messaging-voice-btn:hover {
            background: rgba(0, 255, 136, 0.3);
            border-color: var(--accent-green);
        }

        .card-messaging-voice-btn.recording {
            background: #ff6b6b;
            color: white;
            border-color: #ff6b6b;
            animation: pulse 1s infinite;
        }

        .card-messaging-send-btn {
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            color: var(--primary-dark);
            border: none;
        }

        .card-messaging-send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px var(--hover-glow);
        }

        @keyframes pulse {

            0%,
            100% {
                box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7);
            }

            50% {
                box-shadow: 0 0 0 10px rgba(255, 107, 107, 0);
            }
        }

        /* MESSENGER MODAL */


        /* HIGHLIGHT VIEWER MODAL */
        .highlight-viewer-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            z-index: 8500;
            overflow-y: auto;
        }

        .highlight-viewer-overlay.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .highlight-viewer-modal {
            background: var(--primary-dark);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 20px;
            width: 95%;
            max-width: 1000px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .highlight-viewer-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: var(--accent-gold);
            font-size: 2.5em;
            cursor: pointer;
            z-index: 10;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .highlight-viewer-close:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: rotate(90deg);
        }

        .highlight-viewer-video {
            width: 100%;
            height: 400px;
            background: #000;
            position: relative;
        }

        .highlight-viewer-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
        }

        .highlight-viewer-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .highlight-viewer-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .highlight-viewer-comments {
            border-left: 1px solid rgba(255, 215, 0, 0.2);
            padding-left: 20px;
            display: flex;
            flex-direction: column;
        }

        #commentsSection {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 15px;
            max-height: 300px;
        }

        .comment-item {
            padding: 10px;
            background: rgba(255, 215, 0, 0.05);
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 0.9em;
            color: var(--text-white);
        }

        .comment-item strong {
            color: var(--accent-gold);
        }

        /* GIFT POPUP */
        .gift-popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 9000;
            align-items: center;
            justify-content: center;
        }

        .gift-popup-overlay.active {
            display: flex;
        }

        .gift-popup {
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 20px;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .gifts-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .gift-item {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .gift-item:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: var(--accent-gold);
            transform: translateY(-5px);
            box-shadow: 0 5px 20px var(--hover-glow);
        }

        .gift-item div {
            font-size: 0.85em;
            color: var(--text-white);
            font-weight: 600;
        }

        .gift-item small {
            font-size: 0.7em;
            color: var(--text-gray);
        }

        /* RESPONSIVE */
        @media (max-width: 968px) {
            .match-card {
                min-width: 100%;
            }

            .header {
                flex-direction: column;
                gap: 15px;
            }

            .header-center {
                gap: 15px;
            }

            .banner-label {
                font-size: 1.8em;
                left: 3%;
            }

            .teams-section {
                gap: 15px;
            }
        }

        /* WALLET STYLES */
        .wallet-btn {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid rgba(0, 255, 136, 0.4);
            color: var(--accent-green);
        }

        .wallet-btn:hover {
            background: rgba(0, 255, 136, 0.3);
            border-color: var(--accent-green);
        }

        .wallet-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 1300;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .wallet-modal-overlay.active {
            display: flex;
        }

        .wallet-modal {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 25px;
            padding: 40px;
            width: 100%;
            max-width: 600px;
            position: relative;
            animation: slideUp 0.4s ease;
            margin: auto;
        }

        /* WITHDRAWAL MODAL */
        .withdrawal-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 1400;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .withdrawal-modal-overlay.active {
            display: flex;
        }

        .withdrawal-modal {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 25px;
            padding: 40px;
            width: 100%;
            max-width: 600px;
            position: relative;
            animation: slideUp 0.4s ease;
            margin: auto;
        }

        .withdrawal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2em;
            color: var(--text-gray);
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .withdrawal-close:hover {
            color: var(--accent-gold);
        }

        .withdrawal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .withdrawal-title {
            font-size: 2em;
            font-weight: 900;
            color: var(--accent-gold);
            margin-bottom: 10px;
        }

        .withdrawal-section {
            margin-bottom: 25px;
        }

        .section-label {
            font-size: 0.9em;
            color: var(--text-gray);
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .bank-details-display {
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .bank-detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .bank-detail-row:last-child {
            margin-bottom: 0;
        }

        .bank-detail-label {
            color: var(--text-gray);
        }

        .bank-detail-value {
            color: var(--text-white);
            font-weight: 600;
        }

        .withdrawal-type-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .withdrawal-type-btn {
            flex: 1;
            padding: 15px;
            background: rgba(255, 215, 0, 0.05);
            border: 2px solid rgba(255, 215, 0, 0.2);
            border-radius: 12px;
            color: var(--text-white);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.95em;
        }

        .withdrawal-type-btn.active {
            background: rgba(255, 215, 0, 0.2);
            border-color: var(--accent-gold);
            color: var(--accent-gold);
        }

        .withdrawal-type-btn:hover {
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .withdrawal-type-info {
            font-size: 0.8em;
            color: var(--text-gray);
            margin-top: 5px;
        }

        .amount-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .amount-input {
            flex: 1;
            padding: 12px;
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            color: var(--text-white);
            font-size: 0.95em;
            outline: none;
            transition: all 0.3s ease;
        }

        .amount-input:focus {
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .amount-currency {
            display: flex;
            align-items: center;
            padding: 0 12px;
            color: var(--accent-gold);
            font-weight: 600;
        }

        .fee-breakdown {
            background: rgba(0, 255, 136, 0.05);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .fee-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .fee-row:last-child {
            margin-bottom: 0;
            border-top: 1px solid rgba(0, 255, 136, 0.2);
            padding-top: 10px;
            color: var(--accent-green);
            font-weight: 600;
        }

        .pin-input-group {
            margin-bottom: 20px;
        }

        .pin-input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            color: var(--text-white);
            font-size: 1.2em;
            letter-spacing: 0.5em;
            text-align: center;
            outline: none;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
        }

        .pin-input:focus {
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .withdrawal-btn {
            width: 100%;
            padding: 12px;
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid var(--accent-gold);
            color: var(--accent-gold);
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .withdrawal-btn:hover {
            background: rgba(255, 215, 0, 0.3);
            box-shadow: 0 0 15px var(--hover-glow);
        }

        .withdrawal-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .withdrawal-error {
            color: #ff6b6b;
            font-size: 0.9em;
            padding: 10px;
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.2);
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .withdrawal-success {
            color: var(--accent-green);
            font-size: 0.9em;
            padding: 10px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: 8px;
            margin-bottom: 15px;
        }

        /* TOAST NOTIFICATION SYSTEM */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        .toast {
            padding: 16px 20px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95em;
            backdrop-filter: blur(10px);
            border: 2px solid;
            animation: slideInToast 0.3s ease forwards;
            pointer-events: auto;
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 280px;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideInToast {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast.removing {
            animation: slideOutToast 0.3s ease forwards;
        }

        @keyframes slideOutToast {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        .toast.success {
            background: rgba(0, 255, 136, 0.2);
            border-color: rgba(0, 255, 136, 0.6);
            color: var(--accent-green);
        }

        .toast.error {
            background: rgba(255, 107, 107, 0.2);
            border-color: rgba(255, 107, 107, 0.6);
            color: #ff6b6b;
        }

        .toast.info {
            background: rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.6);
            color: var(--accent-gold);
        }

        .toast.warning {
            background: rgba(255, 165, 0, 0.2);
            border-color: rgba(255, 165, 0, 0.6);
            color: #ffa500;
        }

        .toast-icon {
            font-size: 1.2em;
            flex-shrink: 0;
        }

        .toast-message {
            flex: 1;
        }

        .toast-close {
            cursor: pointer;
            font-size: 1.5em;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }

        .toast-close:hover {
            opacity: 1;
        }

        .wallet-close {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2em;
            color: var(--text-gray);
            cursor: pointer;
            background: none;
            border: none;
            transition: all 0.3s ease;
        }

        .wallet-close:hover {
            color: var(--accent-gold);
            transform: rotate(90deg);
        }

        .wallet-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .wallet-header h2 {
            font-size: 2em;
            font-weight: 800;
            color: var(--accent-gold);
        }

        .wallet-balance-card {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(0, 255, 136, 0.1));
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin-bottom: 25px;
        }

        .balance-label {
            color: var(--text-gray);
            font-size: 0.95em;
            margin-bottom: 8px;
        }

        .balance-amount {
            font-size: 2.5em;
            font-weight: 900;
            color: var(--accent-gold);
            text-shadow: 0 0 20px var(--hover-glow);
            margin-bottom: 15px;
        }

        .wallet-account-number {
            color: var(--accent-green);
            font-size: 0.9em;
            word-break: break-all;
        }

        .wallet-info-banner {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
        }

        .banner-icon {
            font-size: 1.5em;
            min-width: 30px;
        }

        .banner-content h4 {
            color: var(--accent-green);
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .banner-content p {
            color: var(--text-gray);
            font-size: 0.85em;
            line-height: 1.4;
        }

        .wallet-tabs-container {
            margin-top: 20px;
        }

        .wallet-tabs {
            display: flex;
            gap: 10px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.1);
            margin-bottom: 20px;
        }

        .wallet-tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            color: var(--text-gray);
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            transition: all 0.3s ease;
            position: relative;
        }

        .wallet-tab.active {
            color: var(--accent-gold);
        }

        .wallet-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-gold);
        }

        .wallet-tab:hover {
            color: var(--accent-gold);
        }

        .wallet-tab-content {
            display: none;
        }

        .wallet-tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .bank-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            color: var(--text-gray);
            font-weight: 600;
            font-size: 0.9em;
        }

        .form-input {
            padding: 12px;
            background: rgba(10, 14, 39, 0.6);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 8px;
            color: var(--text-white);
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-gold);
            box-shadow: 0 0 15px var(--hover-glow);
        }

        .bank-status {
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9em;
            text-align: center;
            margin: 10px 0;
            min-height: 20px;
        }

        .bank-status.success {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid rgba(0, 255, 136, 0.4);
            color: var(--accent-green);
        }

        .bank-status.error {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.4);
            color: #ff6b6b;
        }

        .btn-save-bank,
        .btn-edit-bank {
            padding: 12px;
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            color: var(--primary-dark);
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn-save-bank:hover,
        .btn-edit-bank:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px var(--hover-glow);
        }

        .lock-message {
            padding: 12px;
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid rgba(255, 165, 0, 0.4);
            border-radius: 8px;
            color: #ffa500;
            font-size: 0.9em;
            text-align: center;
            margin-top: 15px;
        }

        .history-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.2);
            color: var(--text-gray);
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: rgba(255, 215, 0, 0.3);
            border-color: var(--accent-gold);
            color: var(--accent-gold);
        }

        .filter-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            border-color: var(--accent-gold);
        }

        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            background: rgba(10, 14, 39, 0.5);
            border: 1px solid rgba(255, 215, 0, 0.15);
            border-radius: 10px;
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .transaction-item:hover {
            border-color: rgba(255, 215, 0, 0.3);
            background: rgba(10, 14, 39, 0.7);
        }

        .transaction-details {
            flex: 1;
        }

        .transaction-type {
            color: var(--text-white);
            font-weight: 600;
            font-size: 0.95em;
        }

        .transaction-date {
            color: var(--text-gray);
            font-size: 0.8em;
            margin-top: 4px;
        }

        .transaction-amount {
            font-size: 1.1em;
            font-weight: 700;
            text-align: right;
        }

        .no-transactions {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-gray);
        }

        /* WITHDRAWAL STYLES */
        .wallet-action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 215, 0, 0.1);
        }

        .btn-withdraw {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, #ff6b6b, #ff9999);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .btn-withdraw:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
        }

        .request-type-section {
            margin-bottom: 25px;
        }

        .request-type-label {
            display: block;
            color: var(--text-gray);
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 0.95em;
        }

        .request-type-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .request-option {
            position: relative;
        }

        .request-option input[type="radio"] {
            display: none;
        }

        .request-option-label {
            display: block;
            padding: 15px;
            background: rgba(10, 14, 39, 0.5);
            border: 2px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .request-option input[type="radio"]:checked+.request-option-label {
            background: rgba(255, 215, 0, 0.1);
            border-color: var(--accent-gold);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }

        .request-title {
            color: var(--accent-gold);
            font-weight: 700;
            font-size: 1em;
            margin-bottom: 8px;
        }

        .request-details {
            color: var(--text-gray);
            font-size: 0.85em;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .withdrawal-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .fee-breakdown {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 215, 0, 0.05));
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            padding: 15px;
        }

        .fee-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: var(--text-gray);
            font-size: 0.95em;
        }

        .fee-item span:last-child {
            color: var(--text-white);
            font-weight: 600;
        }

        .fee-item.total {
            border-top: 2px solid rgba(255, 215, 0, 0.2);
            padding-top: 12px;
            margin-top: 12px;
        }

        .fee-item.total span:last-child {
            color: var(--accent-green);
            font-size: 1.1em;
        }

        .withdrawal-status {
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9em;
            text-align: center;
            min-height: 20px;
        }

        .withdrawal-status.error {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.4);
            color: #ff6b6b;
        }

        .withdrawal-status.warning {
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid rgba(255, 165, 0, 0.4);
            color: #ffa500;
        }

        .withdrawal-status.success {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid rgba(0, 255, 136, 0.4);
            color: var(--accent-green);
        }

        .btn-submit-withdrawal {
            padding: 12px;
            background: linear-gradient(135deg, #ff6b6b, #ff9999);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn-submit-withdrawal:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
        }

        .btn-submit-withdrawal:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @media (max-width: 600px) {
            .header-btn {
                padding: 10px 20px;
                font-size: 0.8em;
            }

            .match-card {
                min-width: 100%;
                padding: 15px;
            }

            .banner-label {
                font-size: 1.3em;
            }

            .wallet-modal {
                padding: 20px;
                max-width: 95%;
            }

            .balance-amount {
                font-size: 1.8em;
            }
        }

        /* LOADING ANIMATION */
        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .loading {
            animation: pulse 1.5s ease-in-out infinite;
        }

        /* SPONSORS SECTION */
        .sponsors-section {
            padding: 12px 0;
            border-top: 1px solid rgba(255, 215, 0, 0.1);
            margin-top: 12px;
            overflow: hidden;
        }

        .sponsors-scroll {
            display: flex;
            gap: 25px;
            animation: scrollSponsors 8s linear infinite;
        }

        .sponsor-item {
            display: flex;
            align-items: center;
            gap: 12px;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .sponsor-logo {
            width: 35px;
            height: 35px;
            border-radius: 8px;
            background: rgba(255, 215, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .sponsor-name {
            font-size: 0.85em;
            color: var(--text-gray);
            font-weight: 600;
        }

        @keyframes scrollSponsors {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-50%);
            }
        }

        /* MINI BANNER ADS */
        .mini-banner-section {
            padding: 20px 6%;
            display: none;
        }

        .mini-banner-section.active {
            display: block;
        }

        .mini-banner-container {
            height: 75px;
            border-radius: 15px;
            overflow: hidden;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            margin-bottom: 30px;
        }

        .mini-banner-scroll {
            display: flex;
            height: 100%;
            animation: scrollMini 10s linear infinite;
        }

        .mini-banner-item {
            min-width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.7);
        }

        @keyframes scrollMini {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-100%);
            }
        }

        /* MINI MATCH CARDS */
        .mini-cards-section {
            padding: 0 6%;
            display: none;
            margin-bottom: 40px;
        }

        .mini-cards-section.active {
            display: block;
        }

        .mini-cards-header {
            margin-bottom: 15px;
        }

        .mini-cards-header h3 {
            color: var(--accent-gold);
            font-size: 1.1em;
            font-weight: 700;
        }

        .mini-cards-container {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding: 10px 0;
            scroll-behavior: smooth;
            margin-bottom: 20px;
        }

        .mini-cards-container::-webkit-scrollbar {
            height: 6px;
        }

        .mini-cards-container::-webkit-scrollbar-track {
            background: rgba(255, 215, 0, 0.05);
        }

        .mini-cards-container::-webkit-scrollbar-thumb {
            background: var(--accent-gold);
            border-radius: 10px;
        }

        .mini-match-card {
            min-width: 300px;
            height: 50px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 12px;
            display: flex;
            overflow: hidden;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .mini-match-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 5px 20px var(--hover-glow);
            transform: translateY(-2px);
        }

        .mini-card-teamA-img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .mini-card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 15px;
            gap: 4px;
        }

        .mini-card-teams {
            display: flex;
            gap: 8px;
            font-size: 0.85em;
            font-weight: 600;
            color: var(--text-white);
        }

        .mini-card-teams span {
            flex: 1;
        }

        .mini-card-time {
            font-size: 0.75em;
            color: var(--text-gray);
        }

        .mini-card-teamB-img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .see-more-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px 30px;
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            color: var(--primary-dark);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.95em;
            transition: all 0.3s ease;
            margin-left: 6%;
        }

        .see-more-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px var(--hover-glow);
        }

        /* SUB TABS & SEARCH */
        .matches-controls {
            padding: 20px 6%;
            display: none;
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .matches-controls.active {
            display: block;
        }

        .sub-tabs-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.1);
        }

        .sub-tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            color: var(--text-gray);
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95em;
            transition: all 0.3s ease;
            position: relative;
        }

        .sub-tab.active {
            color: var(--accent-gold);
        }

        .sub-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-gold);
        }

        .sub-tab:hover {
            color: var(--accent-gold);
        }

        .search-filter-bar {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .search-input {
            flex: 1;
            padding: 12px 18px;
            background: rgba(10, 14, 39, 0.6);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            color: var(--text-white);
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .search-input::placeholder {
            color: var(--text-gray);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-gold);
            box-shadow: 0 0 15px var(--hover-glow);
        }

        .filter-btn {
            padding: 12px 20px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            color: var(--text-white);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .filter-btn:hover {
            border-color: var(--accent-gold);
            background: rgba(255, 215, 0, 0.1);
            color: var(--accent-gold);
        }

        /* TOURNAMENT CARDS */
        .tournament-cards-section {
            padding: 30px 6%;
            display: none;
            margin-bottom: 40px;
        }

        .tournament-cards-section.active {
            display: block;
        }

        .tournament-cards-container {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 15px 0;
            scroll-behavior: smooth;
        }

        .tournament-cards-container::-webkit-scrollbar {
            height: 6px;
        }

        .tournament-cards-container::-webkit-scrollbar-track {
            background: rgba(255, 215, 0, 0.05);
        }

        .tournament-cards-container::-webkit-scrollbar-thumb {
            background: var(--accent-gold);
            border-radius: 10px;
        }

        .tournament-card {
            min-width: 200px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            flex-shrink: 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tournament-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 10px 40px var(--hover-glow);
            transform: translateY(-5px);
        }

        .tournament-logo {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            margin: 0 auto 15px;
            background: rgba(255, 215, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .tournament-name {
            font-size: 1.1em;
            font-weight: 700;
            color: var(--text-white);
            margin-bottom: 10px;
        }

        .tournament-info {
            font-size: 0.8em;
            color: var(--text-gray);
        }

        /* TOURNAMENT POPUP */
        .tournament-popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .tournament-popup-overlay.active {
            display: flex;
        }

        .tournament-popup {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 25px;
            padding: 40px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.4s ease;
        }

        .popup-close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2em;
            color: var(--text-gray);
            cursor: pointer;
            transition: all 0.3s ease;
            background: none;
            border: none;
        }

        .popup-close-btn:hover {
            color: var(--accent-gold);
            transform: rotate(90deg);
        }

        .popup-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
            padding-bottom: 20px;
        }

        .popup-logo {
            width: 100px;
            height: 100px;
            border-radius: 15px;
            background: rgba(255, 215, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .popup-title {
            font-size: 2em;
            font-weight: 900;
            color: var(--accent-gold);
            text-shadow: 0 0 20px var(--hover-glow);
        }

        .popup-matches-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .popup-match-item {
            background: rgba(10, 14, 39, 0.5);
            border: 1px solid rgba(255, 215, 0, 0.15);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .popup-match-item:hover {
            border-color: rgba(255, 215, 0, 0.3);
            background: rgba(10, 14, 39, 0.7);
        }

        .popup-match-teams {
            flex: 1;
            text-align: center;
        }

        .popup-match-teams strong {
            color: var(--text-white);
            display: block;
            margin-bottom: 5px;
        }

        .popup-match-time {
            font-size: 0.9em;
            color: var(--text-gray);
        }

        .popup-match-status {
            padding: 6px 12px;
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid rgba(0, 255, 136, 0.4);
            color: var(--accent-green);
            border-radius: 8px;
            font-size: 0.8em;
            font-weight: 600;
        }

        /* TAB BANNER ADS */
        .tab-banner-section {
            padding: 20px 6%;
            background: linear-gradient(135deg, rgba(21, 25, 48, 0.5), rgba(10, 14, 39, 0.8));
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .tab-banner-container {
            height: 100px;
            border-radius: 15px;
            overflow: hidden;
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            position: relative;
        }

        .tab-banner-scroll {
            display: flex;
            height: 100%;
            animation: scrollTabBanner 12s linear infinite;
        }

        .tab-banner-item {
            min-width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.75);
        }

        @keyframes scrollTabBanner {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-200%);
            }
        }

        /* NEWS SECTION */
        .news-section {
            padding: 40px 6%;
            background: linear-gradient(135deg, rgba(21, 25, 48, 0.3), rgba(10, 14, 39, 0.5));
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .news-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .news-header h2 {
            font-size: 1.8em;
            font-weight: 800;
            color: var(--accent-gold);
            text-shadow: 0 0 20px var(--hover-glow);
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .news-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            animation: fadeIn 0.6s ease forwards;
            opacity: 0;
        }

        .news-card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .news-card:nth-child(2) {
            animation-delay: 0.2s;
        }

        .news-card:nth-child(3) {
            animation-delay: 0.3s;
        }

        .news-card:nth-child(4) {
            animation-delay: 0.4s;
        }

        .news-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 10px 40px var(--hover-glow);
            transform: translateY(-5px);
        }

        .news-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            filter: brightness(0.8);
        }

        .news-content {
            padding: 20px;
        }

        .news-date {
            font-size: 0.75em;
            color: var(--accent-gold);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .news-title {
            font-size: 1.05em;
            font-weight: 700;
            color: var(--text-white);
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .news-excerpt {
            font-size: 0.9em;
            color: var(--text-gray);
            line-height: 1.5;
            margin-bottom: 12px;
        }

        .read-more {
            color: var(--accent-gold);
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .read-more:hover {
            text-decoration: underline;
            gap: 5px;
        }

        /* SPONSORS SECTION */
        .sponsors-footer-section {
            padding: 50px 6%;
            background: linear-gradient(135deg, rgba(21, 25, 48, 0.7), rgba(10, 14, 39, 0.9));
            border-top: 2px solid rgba(255, 215, 0, 0.2);
            border-bottom: 1px solid rgba(255, 215, 0, 0.1);
        }

        .sponsors-footer-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .sponsors-footer-header h2 {
            font-size: 1.8em;
            font-weight: 800;
            color: var(--accent-gold);
            margin-bottom: 10px;
        }

        .sponsors-footer-header p {
            color: var(--text-gray);
            font-size: 1em;
        }

        .sponsors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .sponsor-footer-card {
            background: rgba(10, 14, 39, 0.5);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .sponsor-footer-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 10px 40px var(--hover-glow);
            transform: translateY(-5px);
        }

        .sponsor-footer-logo {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .sponsor-footer-name {
            font-size: 1.1em;
            font-weight: 700;
            color: var(--text-white);
            margin-bottom: 8px;
        }

        .sponsor-footer-type {
            font-size: 0.85em;
            color: var(--text-gray);
        }

        /* FOOTER */
        .footer-main {
            background: rgba(10, 14, 39, 0.95);
            border-top: 1px solid rgba(255, 215, 0, 0.2);
            padding: 40px 6%;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 30px;
        }

        .footer-section h3 {
            color: var(--accent-gold);
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 10px;
        }

        .footer-section a {
            color: var(--text-gray);
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .footer-section a:hover {
            color: var(--accent-gold);
            padding-left: 5px;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 215, 0, 0.1);
            padding-top: 20px;
            text-align: center;
            color: var(--text-gray);
            font-size: 0.9em;
        }

        .footer-bottom p {
            margin-bottom: 8px;
        }

        .social-links {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 15px;
        }

        .social-links a {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.3s ease;
        }

        .social-links a:hover {
            background: rgba(255, 215, 0, 0.3);
            transform: translateY(-3px);
        }

        /* PROFILE MODAL */
        .profile-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 1200;
            justify-content: center;
            align-items: center;
        }

        .profile-modal-overlay.active {
            display: flex;
        }

        .profile-modal {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 25px;
            padding: 40px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.4s ease;
        }

        .profile-close {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2em;
            color: var(--text-gray);
            cursor: pointer;
            background: none;
            border: none;
            transition: all 0.3s ease;
        }

        .profile-close:hover {
            color: var(--accent-gold);
            transform: rotate(90deg);
        }

        .profile-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.1);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            border: 3px solid var(--accent-gold);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .profile-avatar:hover {
            box-shadow: 0 0 20px var(--hover-glow);
            transform: scale(1.05);
        }

        .profile-avatar-upload {
            display: none;
        }

        .profile-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .profile-form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .profile-form-group label {
            color: var(--text-gray);
            font-weight: 600;
            font-size: 0.9em;
        }

        .profile-form-group input,
        .profile-form-group textarea {
            padding: 12px;
            background: rgba(10, 14, 39, 0.6);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 10px;
            color: var(--text-white);
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .profile-form-group input:focus,
        .profile-form-group textarea:focus {
            outline: none;
            border-color: var(--accent-gold);
            box-shadow: 0 0 15px var(--hover-glow);
        }

        .profile-modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid rgba(255, 215, 0, 0.15);
        }

        .profile-modal-btn {
            padding: 18px 20px;
            border: 2px solid transparent;
            border-radius: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            min-height: 50px;
        }

        .profile-modal-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        .profile-modal-save {
            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
            color: var(--primary-dark);
            border: none;
        }

        .profile-modal-save:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px var(--hover-glow);
        }

        /* Responsive modal buttons */
        @media (max-width: 480px) {
            .profile-modal-buttons {
                gap: 16px;
                margin-top: 30px;
                padding-top: 20px;
            }

            .profile-modal-btn {
                padding: 16px 18px;
                font-size: 0.95em;
                min-height: 48px;
            }
        }



        /* WITHDRAWAL MODAL */
        .withdrawal-fee-breakdown p {
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
        }

        .withdrawal-fee-breakdown hr {
            border: none;
            border-top: 1px solid rgba(0, 255, 136, 0.3);
            margin: 10px 0;
        }

        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: none;
            color: var(--text-gray);
            font-size: 2em;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close-btn:hover {
            color: var(--accent-gold);
            transform: rotate(90deg);
        }
    </style>
</head>

<body>

    <!-- TOAST NOTIFICATION CONTAINER -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- HEADER -->
    <header class="header">
        <div class="app-logo">DLS DRAFT</div>
        <div class="header-center">
            <button class="header-btn">SECRETS</button>
            <button class="header-btn">ISMART DC</button>
        </div>
        <button class="profile-btn" onclick="openProfile()"></button>
    </header>

    <!-- BANNER ADS -->
    <section class="banner-section">
        <div class="banner-container">
            <div class="banner-label">Football Competition</div>
            <div class="banner-scroll">
                <img src="https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=1200&q=80" alt="DLS"
                    class="banner-item">
                <video src="https://commondatastorage.googleapis.com/gtv-videos-library/sample/BigBuckBunny.mp4"
                    class="banner-item" muted autoplay playsinline></video>
                <img src="https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=1200&q=80" alt="Football"
                    class="banner-item">
                <img src="https://images.unsplash.com/photo-1579952363873-27f3bade9f55?w=1200&q=80" alt="Player"
                    class="banner-item">
                <video src="https://commondatastorage.googleapis.com/gtv-videos-library/sample/ElephantsDream.mp4"
                    class="banner-item" muted autoplay playsinline></video>
                <img src="https://images.unsplash.com/photo-1560272564-c83b66b1ad12?w=1200&q=80" alt="Football Match"
                    class="banner-item">
            </div>
        </div>
    </section>

    <!-- NAVIGATION BUTTONS -->
    <section class="nav-buttons-section">
        <div class="nav-buttons-scroll">
            <button class="nav-btn" onclick="openFullMatchesModal()">Matches</button>
            <button class="nav-btn" onclick="activeNavBtn(this)">Tournaments</button>
            <button class="nav-btn" onclick="openHighlightsModal()">Highlights</button>
            <button class="nav-btn" onclick="activeNavBtn(this)">Tables</button>
            <button class="nav-btn" onclick="openPlayersRatingModal()"><i class="fas fa-star"></i> Players
                Rating</button>
            <button class="nav-btn" onclick="activeNavBtn(this)">Online Linking</button>
            <button class="nav-btn" onclick="activeNavBtn(this)">Communities</button>
            <button class="nav-btn" onclick="openMoreMenu()"><i class="fas fa-ellipsis-h"></i> More</button>
        </div>
    </section>

    <!-- TABS -->
    <section class="tabs-section">
        <div class="tabs-container">
            <button class="tab active" onclick="switchTab(this, 'today')">Today's Games</button>
            <button class="tab" onclick="switchTab(this, 'tomorrow')">Tomorrow</button>
            <button class="tab" onclick="switchTab(this, 'upcoming')">Upcoming</button>
            <button class="tab" onclick="switchTab(this, 'live')">Live Games</button>
            <button class="tab" onclick="switchTab(this, 'finished')">Finished</button>
        </div>
    </section>

    <!-- TAB BANNER ADS -->
    <section class="tab-banner-section" id="tabBannerSection">
        <div class="tab-banner-container">
            <div class="tab-banner-scroll">
                <img src="https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=1200&q=80" alt="DLS"
                    class="tab-banner-item">
                <img src="https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=1200&q=80" alt="Football"
                    class="tab-banner-item">
                <img src="https://images.unsplash.com/photo-1579952363873-27f3bade9f55?w=1200&q=80" alt="Player"
                    class="tab-banner-item">
            </div>
        </div>
    </section>

    <!-- MATCHES CONTROLS (Sub-tabs & Search/Filter) -->
    <section class="matches-controls" id="matchesControls">
        <div class="sub-tabs-container">
            <button class="sub-tab active" onclick="switchSubTab(this, 'single')">Single Matches</button>
            <button class="sub-tab" onclick="switchSubTab(this, 'tournament')">Tournament Matches</button>
        </div>
        <div class="search-filter-bar">
            <input type="text" class="search-input" id="searchInput"
                placeholder=" Search by team name or competition..." oninput="filterMatches()">
            <button class="filter-btn" onclick="toggleFilterMenu()"> Filter</button>
        </div>
    </section>

    <!-- MATCHES -->
    <section class="matches-section">
        <div class="matches-container" id="matchesContainer">
            <!-- Match cards will be generated here -->
        </div>
    </section>

    <!-- MINI BANNER ADS (Today's Games Only) -->
    <section class="mini-banner-section" id="miniBannerSection">
        <div class="mini-banner-container">
            <div class="mini-banner-scroll">
                <img src="https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=1200&q=80" alt="DLS"
                    class="mini-banner-item">
                <img src="https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=1200&q=80" alt="Football"
                    class="mini-banner-item">
            </div>
        </div>
    </section>

    <!-- MINI MATCH CARDS (Single Matches - Today's Games Only) -->
    <section class="mini-cards-section" id="miniCardsSection">
        <div class="mini-cards-header">
            <h3>Single Matches</h3>
        </div>
        <div class="mini-cards-container" id="miniCardsContainer">
            <!-- Mini cards will be generated here -->
        </div>
        <button class="see-more-btn" onclick="openFullMatchesModal()">See More Matches </button>
    </section>

    <!-- TOURNAMENT CARDS (Today's Games Only) -->
    <section class="tournament-cards-section" id="tournamentCardsSection">
        <div class="mini-cards-header">
            <h3>Tournaments of the Day</h3>
        </div>
        <div class="tournament-cards-container" id="tournamentCardsContainer">
            <!-- Tournament cards will be generated here -->
        </div>
    </section>

    <!-- PROFILE MODAL -->
    <div class="profile-modal-overlay" id="profileModalOverlay">
        <div class="profile-modal">
            <button class="profile-close" onclick="closeProfileModal()"></button>
            <div class="profile-header">
                <div class="profile-avatar" onclick="document.getElementById('profileAvatarUpload').click()"></div>
                <input type="file" id="profileAvatarUpload" class="profile-avatar-upload" accept="image/*">
                <h2 style="color: var(--accent-gold); margin-bottom: 10px;" id="profileName">User Name</h2>
                <p style="color: var(--text-gray);" id="profileEmail">user@email.com</p>
            </div>
            <form class="profile-form">
                <div class="profile-form-group">
                    <label>Full Name</label>
                    <input type="text" id="inputName" placeholder="Enter your full name">
                </div>
                <div class="profile-form-group">
                    <label>Email Address</label>
                    <input type="email" id="inputEmail" placeholder="Your email" disabled>
                </div>
                <div class="profile-form-group">
                    <label>Bio</label>
                    <textarea id="inputBio" placeholder="Tell us about yourself" rows="4"></textarea>
                </div>
                <div class="profile-modal-buttons">
                    <button type="button" class="profile-modal-btn profile-modal-save" onclick="saveProfileChanges()">
                        Save Changes</button>
                    <button type="button" class="profile-modal-btn" onclick="openWalletModal()"
                        style="background: rgba(0, 255, 136, 0.2); border: 1px solid rgba(0, 255, 136, 0.4); color: var(--accent-green);">
                        Wallet</button>
                    <button type="button" class="profile-modal-btn"
                        style="background: rgba(255, 215, 0, 0.2); border: 1px solid rgba(255, 215, 0, 0.4); color: var(--accent-gold);"
                        onclick="editProfile()"> Edit Profile</button>
                    <button type="button" class="profile-modal-btn"
                        style="background: rgba(255, 107, 107, 0.2); border: 1px solid rgba(255, 107, 107, 0.4); color: #ff6b6b;"
                        onclick="closeProfileModal()"> Close</button>
                </div>
            </form>
        </div>
    </div>


    </div>
    </section>

    <!-- PREDICTIONS MODAL -->
    <div class="wallet-modal-overlay" id="predictionsModalOverlay">
        <div class="wallet-modal" style="max-width: 700px;">
            <button class="wallet-close" onclick="closePredictionsModal()"></button>
            <div class="wallet-header">
                <h2> Manage Predictions</h2>
            </div>

            <div style="margin-bottom: 25px;">
                <label class="form-label">Select Match for Predictions</label>
                <select id="predictionsMatchSelect" class="form-input"
                    style="width: 100%; padding: 12px; border-radius: 8px;"
                    onchange="loadPredictionsForMatch(this.value)">
                    <option value="">-- Select a match --</option>
                </select>
            </div>

            <div id="predictionsContainer" style="display: none;">
                <div style="margin-bottom: 25px;">
                    <h3 style="color: var(--accent-gold); margin-bottom: 15px;"> Prediction Types</h3>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="pred_scoreEnabled" onchange="updatePredictionTypes()">
                            <label for="pred_scoreEnabled">Predict Exact Score (e.g., 2-1)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="pred_teamEnabled" onchange="updatePredictionTypes()">
                            <label for="pred_teamEnabled">Predict Team to Score</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="pred_goalsEnabled" onchange="updatePredictionTypes()">
                            <label for="pred_goalsEnabled">Predict Number of Goals Only</label>
                        </div>
                    </div>
                </div>

                <div id="pred_scoreOptions" style="display: none; margin-bottom: 25px;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 10px;">Exact Score Predictions</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                        <div>
                            <label class="form-label">Team A Score</label>
                            <input type="number" id="predTeamAScore" class="form-input" min="0" max="20" placeholder="0"
                                style="width: 100%; padding: 10px; border-radius: 8px;">
                        </div>
                        <div style="display: flex; align-items: flex-end;">
                            <button class="add-btn" onclick="addScorePrediction()"
                                style="width: 100%; margin-bottom: 0; padding: 10px; background: rgba(255, 215, 0, 0.2); border: 1px solid rgba(255, 215, 0, 0.4); color: var(--accent-gold); border-radius: 8px; cursor: pointer; font-weight: 600;">Add
                                Score</button>
                        </div>
                        <div>
                            <label class="form-label">Team B Score</label>
                            <input type="number" id="predTeamBScore" class="form-input" min="0" max="20" placeholder="0"
                                style="width: 100%; padding: 10px; border-radius: 8px;">
                        </div>
                    </div>
                    <div id="scorePredictionsList"></div>
                </div>

                <div id="pred_teamOptions" style="display: none; margin-bottom: 25px;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 10px;">Team to Score Predictions</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                        <button class="add-btn" onclick="addTeamPrediction('teamA')"
                            style="background: rgba(100, 150, 255, 0.2); border: 1px solid rgba(100, 150, 255, 0.4); color: #6496ff; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: 600;">Team
                            A Will Score</button>
                        <button class="add-btn" onclick="addTeamPrediction('teamB')"
                            style="background: rgba(255, 150, 100, 0.2); border: 1px solid rgba(255, 150, 100, 0.4); color: #ff9664; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: 600;">Team
                            B Will Score</button>
                    </div>
                    <div id="teamPredictionsList"></div>
                </div>

                <div id="pred_goalsOptions" style="display: none; margin-bottom: 25px;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 10px;">Total Goals Predictions</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                        <div>
                            <label class="form-label">Total Goals</label>
                            <input type="number" id="predTotalGoals" class="form-input" min="0" max="30" placeholder="0"
                                style="width: 100%; padding: 10px; border-radius: 8px;">
                        </div>
                        <div style="display: flex; align-items: flex-end;">
                            <button class="add-btn" onclick="addGoalsPrediction()"
                                style="width: 100%; margin-bottom: 0; padding: 10px; background: rgba(255, 215, 0, 0.2); border: 1px solid rgba(255, 215, 0, 0.4); color: var(--accent-gold); border-radius: 8px; cursor: pointer; font-weight: 600;">Add
                                Prediction</button>
                        </div>
                    </div>
                    <div id="goalsPredictionsList"></div>
                </div>

                <button class="submit-btn" onclick="savePredictions()"
                    style="width: 100%; padding: 15px; background: rgba(0, 255, 136, 0.2); border: 2px solid rgba(0, 255, 136, 0.4); color: var(--accent-green); border-radius: 10px; cursor: pointer; font-weight: 700; font-size: 1em;">
                    Save All Predictions</button>
            </div>
        </div>
    </div>

    <!-- GOAL SCORERS MODAL -->
    <div class="wallet-modal-overlay" id="goalScorersModalOverlay">
        <div class="wallet-modal" style="max-width: 700px;">
            <button class="wallet-close" onclick="closeGoalScorersModal()"></button>
            <div class="wallet-header">
                <h2> Goal Scorers</h2>
            </div>

            <div style="margin-bottom: 25px;">
                <label class="form-label">Select Match</label>
                <select id="goalScorersMatchSelect" class="form-input"
                    style="width: 100%; padding: 12px; border-radius: 8px;"
                    onchange="loadGoalScorersForMatch(this.value)">
                    <option value="">-- Select a match --</option>
                </select>
            </div>

            <div id="goalScorersContainer" style="display: none;">
                <div style="margin-bottom: 25px;">
                    <h3 style="color: var(--accent-gold); margin-bottom: 15px;"> Add Goal Scorer</h3>
                    <div class="goal-input-row">
                        <select id="goalScorerTeam" class="form-input" style="padding: 10px; border-radius: 8px;">
                            <option value="teamA">Team A</option>
                            <option value="teamB">Team B</option>
                        </select>
                        <input type="text" id="goalScorerName" class="form-input" placeholder="Player name"
                            style="padding: 10px; border-radius: 8px;">
                        <input type="number" id="goalScorerMinute" class="form-input" placeholder="Minute" min="0"
                            max="120" style="padding: 10px; border-radius: 8px;">
                        <button class="add-btn" onclick="addGoalScorer()"
                            style="padding: 10px 15px; background: rgba(255, 215, 0, 0.2); border: 1px solid rgba(255, 215, 0, 0.4); color: var(--accent-gold); border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Add</button>
                    </div>
                </div>

                <div style="margin-bottom: 25px;">
                    <h3 style="color: var(--accent-gold); margin-bottom: 15px;"> Goal Scorers List</h3>
                    <div id="goalScorersList"></div>
                </div>

                <button class="submit-btn" onclick="saveGoalScorers()"
                    style="width: 100%; padding: 15px; background: rgba(0, 255, 136, 0.2); border: 2px solid rgba(0, 255, 136, 0.4); color: var(--accent-green); border-radius: 10px; cursor: pointer; font-weight: 700; font-size: 1em;">
                    Save Goal Scorers</button>
            </div>
        </div>
    </div>

    <!-- WATCH FEE MODAL -->
    <div class="watch-fee-modal" id="watchFeeModal">
        <div class="watch-fee-content">
            <div class="watch-fee-header">
                <h2 class="watch-fee-title"> Watch Fee Management</h2>
                <button class="watch-fee-close" onclick="closeWatchFeeModal()"></button>
            </div>

            <div id="watchFeeMatchInfo"
                style="background: rgba(0, 255, 136, 0.1); border-left: 4px solid rgba(0, 255, 136, 0.5); padding: 15px; border-radius: 8px; margin-bottom: 25px; display: none;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <div style="font-size: 0.9em; color: var(--text-gray); margin-bottom: 5px;">Match</div>
                        <div id="watchFeeMatchName"
                            style="font-weight: 600; color: var(--text-white); font-size: 1.1em;"></div>
                    </div>
                    <div>
                        <div style="font-size: 0.9em; color: var(--text-gray); margin-bottom: 5px;">Fee</div>
                        <div id="watchFeePrice" style="font-weight: 900; color: var(--accent-gold); font-size: 1.1em;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="watch-fee-tabs">
                <button class="watch-fee-tab active" onclick="switchWatchFeeTab('stats')"> Statistics</button>
                <button class="watch-fee-tab" onclick="switchWatchFeeTab('paidViewers')"> Paid Viewers</button>
            </div>

            <!-- Stats Tab -->
            <div id="statsTab" class="watch-fee-tab-content active">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; font-size: 1.3em;"> Audience Statistics
                </h3>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Viewers</div>
                        <div class="stat-value" id="totalViewers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Paid Viewers</div>
                        <div class="stat-value" id="paidViewersCount">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Revenue</div>
                        <div class="stat-value" id="totalRevenue">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Average Watch Time</div>
                        <div class="stat-value" id="avgWatchTime">0m</div>
                    </div>
                </div>

                <div
                    style="background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <h4 style="color: #00d4ff; margin-bottom: 10px;">Viewing Platform Stats</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.9em;">
                        <div>
                            <span style="color: var(--text-gray);">Peak Concurrent Viewers:</span>
                            <div style="color: var(--text-white); font-weight: 600; margin-top: 5px;" id="peakViewers">0
                            </div>
                        </div>
                        <div>
                            <span style="color: var(--text-gray);">Stream Duration:</span>
                            <div style="color: var(--text-white); font-weight: 600; margin-top: 5px;"
                                id="streamDuration">0m</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Paid Viewers Tab -->
            <div id="paidViewersTab" class="watch-fee-tab-content">
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; font-size: 1.3em;"> Paid Viewers List</h3>

                <div id="paidViewersList" class="viewers-list">
                    <div class="no-viewers-message">No paid viewers yet</div>
                </div>
            </div>

            <div style="margin-top: 25px; padding-top: 20px; border-top: 2px solid rgba(255, 215, 0, 0.1);">
                <button class="submit-btn" onclick="closeWatchFeeModal()"
                    style="width: 100%; padding: 15px; background: rgba(0, 255, 136, 0.2); border: 2px solid rgba(0, 255, 136, 0.4); color: var(--accent-green); border-radius: 10px; cursor: pointer; font-weight: 700; font-size: 1em;">
                    Close</button>
            </div>
        </div>
    </div>

    <!-- OLD WITHDRAWAL MODAL (DEPRECATED - Replaced by Wallet System) -->

    <!-- WALLET MODAL -->
    <div class="wallet-modal-overlay" id="walletModalOverlay">
        <div class="wallet-modal">
            <button class="wallet-close" onclick="closeWalletModal()"></button>

            <div class="wallet-header">
                <h2> My Wallet</h2>
            </div>

            <!-- Balance Card -->
            <div class="wallet-balance-card">
                <div class="balance-label">Available Balance</div>
                <div class="balance-amount" id="displayBalance">0.00</div>
                <div class="wallet-account-number">
                    Account Number: <strong id="displayWalletAcctNumber">DLS00000</strong>
                </div>
            </div>

            <!-- Info Banner -->
            <div class="wallet-info-banner">
                <div class="banner-icon"></div>
                <div class="banner-content">
                    <h4>How It Works</h4>
                    <p>Add your bank account details to enable withdrawals. Your account is locked for 7 days after
                        adding. After that, you can edit your details anytime.</p>
                </div>
            </div>

            <!-- Wallet Tabs -->
            <div class="wallet-tabs-container">
                <div class="wallet-tabs">
                    <button class="wallet-tab active" onclick="switchWalletTab('bank', this)">Add Bank Account</button>
                    <button class="wallet-tab" onclick="switchWalletTab('history', this)">Transaction History</button>
                </div>

                <!-- Add Bank Account Tab -->
                <div class="wallet-tab-content active" id="walletBankTab">
                    <div class="bank-form">
                        <div class="form-group">
                            <label>Select Bank</label>
                            <select id="bankSelect" class="form-input" required onchange="updateBankSelection()">
                                <option value="">-- Choose Bank --</option>
                                <optgroup label="MAJOR BANKS">
                                    <option value="044">Access Bank</option>
                                    <option value="050">Ecobank</option>
                                    <option value="058">Guaranty Trust Bank</option>
                                    <option value="076">Zenith Bank</option>
                                    <option value="011">First Bank</option>
                                    <option value="035">Wema Bank</option>
                                    <option value="012">UBA</option>
                                </optgroup>
                                <optgroup label="FINTECH & DIGITAL BANKS">
                                    <option value="120">Opay (OPay)</option>
                                    <option value="105">PalmPay</option>
                                    <option value="119">Monie Point</option>
                                    <option value="103">Polaris Bank</option>
                                    <option value="114">GTCo (Globus)</option>
                                    <option value="125">TagPay</option>
                                    <option value="126">Kuda Bank</option>
                                </optgroup>
                            </select>
                            <small id="bankSelected"
                                style="color: var(--text-gray); margin-top: 5px; display: none;"></small>
                        </div>

                        <div class="form-group">
                            <label>Account Number</label>
                            <input type="text" id="accountNumber" class="form-input"
                                placeholder="10-digit account number" maxlength="10">
                        </div>

                        <div class="form-group">
                            <label>Account Name</label>
                            <input type="text" id="accountName" class="form-input" placeholder="Name on account">
                        </div>

                        <div id="bankAccountStatus" class="bank-status"></div>

                        <button class="btn-save-bank" onclick="saveBankAccount()" id="saveBankBtn">Save Bank
                            Account</button>
                        <button class="btn-edit-bank" onclick="editBankAccount()" id="editBankBtn"
                            style="display: none;">Edit Account</button>

                        <div id="lockMessage" class="lock-message"></div>
                    </div>
                </div>

                <!-- Transaction History Tab -->
                <div class="wallet-tab-content" id="walletHistoryTab">
                    <div class="history-filters">
                        <button class="filter-btn active" onclick="filterTransactions('all', this)">All</button>
                        <button class="filter-btn" onclick="filterTransactions('successful', this)">
                            Successful</button>
                        <button class="filter-btn" onclick="filterTransactions('pending', this)"> Pending</button>
                        <button class="filter-btn" onclick="filterTransactions('rejected', this)"> Rejected</button>
                    </div>

                    <div class="transactions-list" id="transactionsList">
                        <div class="no-transactions">No transactions yet</div>
                    </div>
                </div>
            </div>

            <!-- Withdrawal Button -->
            <div class="wallet-action-buttons">
                <button class="btn-withdraw" onclick="openDepositModal()"> Deposit</button>
                <button class="btn-withdraw" onclick="openWithdrawalModal()"> Withdraw</button>
            </div>
        </div>
    </div>

    <!-- WITHDRAWAL MODAL -->
    <div class="withdrawal-modal-overlay" id="withdrawalModalOverlay">
        <div class="withdrawal-modal">
            <button class="withdrawal-close" onclick="closeWithdrawalModal()"></button>

            <div class="withdrawal-header">
                <h2> Withdraw Funds</h2>
            </div>

            <!-- Account Details Display -->
            <div class="withdrawal-account-card">
                <div class="account-detail-item">
                    <span class="detail-label">Bank Account:</span>
                    <span class="detail-value" id="withdrawAccountDisplay">Not added</span>
                </div>
                <div class="account-detail-item">
                    <span class="detail-label">Account Name:</span>
                    <span class="detail-value" id="withdrawNameDisplay">-</span>
                </div>
                <div class="account-detail-item">
                    <span class="detail-label">Available Balance:</span>
                    <span class="detail-value" id="withdrawBalanceDisplay">0</span>
                </div>
            </div>

            <!-- Request Type Selection -->
            <div class="request-type-section">
                <label class="request-type-label">Select Request Type</label>
                <div class="request-type-options">
                    <div class="request-option">
                        <input type="radio" id="normalRequest" name="requestType" value="normal" checked
                            onchange="updateWithdrawalFees()">
                        <label for="normalRequest" class="request-option-label">
                            <div class="request-title">Normal Request</div>
                            <div class="request-details">
                                <div>Fee: 10 per 100</div>
                                <div>Time: 10AM - 8PM</div>
                                <div>Min: 100 | Max: 480,000</div>
                            </div>
                        </label>
                    </div>

                    <div class="request-option">
                        <input type="radio" id="speedRequest" name="requestType" value="speed"
                            onchange="updateWithdrawalFees()">
                        <label for="speedRequest" class="request-option-label">
                            <div class="request-title"> Speed Request</div>
                            <div class="request-details">
                                <div>Fee: 150 per 1000 (Max 2000)</div>
                                <div>Time: 1AM - 10PM</div>
                                <div>Min: 1000 | Max: 480,000</div>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Withdrawal Amount -->
            <div class="withdrawal-form">
                <div class="form-group">
                    <label>Amount to Withdraw</label>
                    <input type="number" id="withdrawalAmount" class="form-input" placeholder="Enter amount" min="100"
                        max="480000" oninput="updateWithdrawalFees()">
                </div>

                <!-- Fee Breakdown -->
                <div class="fee-breakdown">
                    <div class="fee-item">
                        <span>Amount:</span>
                        <span id="feeAmount">0</span>
                    </div>
                    <div class="fee-item">
                        <span>Fee:</span>
                        <span id="feeCharge">0</span>
                    </div>
                    <div class="fee-item total">
                        <span>You'll receive:</span>
                        <span id="feeTotal">0</span>
                    </div>
                </div>

                <!-- Status Message -->
                <div id="withdrawalStatus" class="withdrawal-status"></div>

                <!-- Submit Button -->
                <button class="btn-submit-withdrawal" onclick="submitWithdrawal()" id="submitWithdrawalBtn">Confirm &
                    Withdraw</button>
            </div>
        </div>
    </div>

    <!-- DEPOSIT MODAL -->
    <div class="withdrawal-modal-overlay" id="depositModalOverlay">
        <div class="withdrawal-modal">
            <button class="withdrawal-close" onclick="closeDepositModal()"></button>
            <div class="withdrawal-header">
                <h2 class="withdrawal-title"> Add Funds to Wallet</h2>
                <p style="color: var(--text-gray); margin-top: 10px; text-align: center;">Quick and secure deposit with
                    Flutterwave</p>
            </div>

            <div class="withdrawal-section">
                <label class="section-label">Amount to Deposit ()</label>
                <input type="number" id="depositAmount" class="form-input" placeholder="Enter amount" min="1" value="">
                <small style="color: var(--text-gray); display: block; margin-top: 5px;">Minimum: 1</small>
            </div>

            <div id="depositStatus" class="withdrawal-status"></div>

            <button class="btn-submit-withdrawal" onclick="processDepositPayment()" id="depositPayBtn">
                <i class="fas fa-credit-card"></i> Pay Now with Flutterwave
            </button>
        </div>
    </div>

    <!-- TOURNAMENT POPUP -->
    <div class="tournament-popup-overlay" id="tournamentPopupOverlay">
        <div class="tournament-popup">
            <button class="popup-close-btn" onclick="closeTournamentPopup()"></button>
            <div class="popup-header">
                <div class="popup-logo" id="popupLogo"></div>
                <h2 class="popup-title" id="popupTitle"></h2>
            </div>
            <div class="popup-matches-list" id="popupMatchesList">
                <!-- Matches will be generated here -->
            </div>
        </div>
    </div>

    <!-- NEWS SECTION -->
    <section class="news-section">
        <div class="news-header">
            <h2> Latest DLS Updates & News</h2>
        </div>
        <div class="news-grid" id="newsGrid">
            <!-- News cards will be generated here -->
        </div>
    </section>

    <!-- SPONSORS & PARTNERSHIPS -->
    <section class="sponsors-footer-section">
        <div class="sponsors-footer-header">
            <h2> Our Partners & Sponsors</h2>
            <p>Trusted by leading brands in gaming and sports</p>
        </div>
        <div class="sponsors-grid" id="sponsorsGrid">
            <!-- Sponsor cards will be generated here -->
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="footer-main">
        <div class="footer-grid">
            <div class="footer-section">
                <h3>About DLS Draft</h3>
                <ul>
                    <li><a href="#about">About Us</a></li>
                    <li><a href="#mission">Our Mission</a></li>
                    <li><a href="#team">Our Team</a></li>
                    <li><a href="#careers">Careers</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Resources</h3>
                <ul>
                    <li><a href="#rules">Game Rules</a></li>
                    <li><a href="#faq">FAQ</a></li>
                    <li><a href="#support">Support Center</a></li>
                    <li><a href="#blog">Blog</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Legal</h3>
                <ul>
                    <li><a href="#terms">Terms of Service</a></li>
                    <li><a href="#privacy">Privacy Policy</a></li>
                    <li><a href="#cookie">Cookie Policy</a></li>
                    <li><a href="#disclaimer">Disclaimer</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Connect With Us</h3>
                <ul>
                    <li><a href="https://twitter.com">Twitter</a></li>
                    <li><a href="https://facebook.com">Facebook</a></li>
                    <li><a href="https://instagram.com">Instagram</a></li>
                    <li><a href="https://discord.com">Discord</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="social-links">
                <a href="https://twitter.com" title="Twitter"></a>
                <a href="https://facebook.com" title="Facebook">f</a>
                <a href="https://instagram.com" title="Instagram"></a>
                <a href="https://youtube.com" title="YouTube"></a>
            </div>
            <p>&copy; 2025 DLS Draft. All rights reserved.</p>
            <p>Made with  by iSMART DIGITAL CONNECT</p>
        </div>
    </footer>



    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://checkout.flutterwave.com/v3.js"></script>

    <script>
        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyDW8V2SjNITrA4LcdmeILh944mTbOKnM0c",
            authDomain: "rewarderhub.firebaseapp.com",
            projectId: "rewarderhub",
            storageBucket: "rewarderhub.appspot.com",
            messagingSenderId: "85965945106",
            appId: "1:85965945106:web:fa0a57d8968926e1041bcb",
            measurementId: "G-F2ERB5NGN0"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Check if user is logged in
        auth.onAuthStateChanged((user) => {
            if (!user) {
                window.location.href = 'lasuleaguee.html';
            } else {
                // Create or update user document on login
                db.collection('users').doc(user.uid).set({
                    email: user.email,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                }, { merge: true }).then(() => {
                    console.log('User document created/updated');
                    // Load both wallet and user profile data
                    loadUserDataFromFirebase();
                    loadWalletDataFromFirebase();
                }).catch(error => {
                    console.error('Error creating user document:', error);
                    // Still load data even on error
                    loadUserDataFromFirebase();
                    loadWalletDataFromFirebase();
                });
            }
        });

        // Sample tournaments
        const tournaments = [
            { name: 'Premier League', logo: '', color: '#FFD700' },
            { name: 'Champions League', logo: '', color: '#00FF88' },
            { name: 'FA Cup', logo: '', color: '#FF6B6B' },
            { name: 'League Cup', logo: '', color: '#FFA500' }
        ];

        // Sample news data
        // Production Data - Loaded from Firebase
        let newsData = [];
        let sponsorsData = [];
        let sampleMatches = [];

        // Current host index for rotation
        let currentHostIndex = 0;
        let hostRotationInterval;

        // Nav button active state
        function activeNavBtn(btn) {
            document.querySelectorAll('.nav-btn').forEach(b => {
                b.style.background = 'var(--card-bg)';
                b.style.borderColor = 'rgba(255,215,0,0.2)';
                b.style.color = 'var(--text-white)';
            });
            btn.style.background = 'rgba(255,215,0,0.15)';
            btn.style.borderColor = 'var(--accent-gold)';
            btn.style.color = 'var(--accent-gold)';
        }

        // More Menu Functions
        function openMoreMenu() {
            const overlay = document.getElementById('moreMenuOverlay');
            if (overlay) {
                overlay.classList.add('active');
            }
        }

        function closeMoreMenu() {
            const overlay = document.getElementById('moreMenuOverlay');
            if (overlay) {
                overlay.classList.remove('active');
            }
        }

        // Close more menu when clicking outside
        document.addEventListener('DOMContentLoaded', function () {
            const moreMenuOverlay = document.getElementById('moreMenuOverlay');
            if (moreMenuOverlay) {
                moreMenuOverlay.addEventListener('click', function (e) {
                    if (e.target === moreMenuOverlay) {
                        closeMoreMenu();
                    }
                });
            }
        });

        // User profile storage
        let userData = {
            name: 'User',
            bio: '',
            avatar: ''
        };

        // Firebase Firestore functions
        function saveUserDataToFirebase() {
            if (!auth.currentUser) return;

            // Use set with merge to create or update document
            db.collection('users').doc(auth.currentUser.uid).set({
                email: auth.currentUser.email,
                profile: {
                    name: userData.name || 'User',
                    bio: userData.bio || '',
                    avatar: userData.avatar || ''
                },
                updatedAt: new Date().toISOString()
            }, { merge: true }).catch(error => {
                console.error('Error saving to Firebase:', error);
            });
        }

        function loadUserDataFromFirebase() {
            if (!auth.currentUser) return Promise.resolve();

            return db.collection('users').doc(auth.currentUser.uid).get().then(doc => {
                if (doc.exists) {
                    const data = doc.data();
                    userData.name = (data.profile && data.profile.name) || 'User';
                    userData.bio = (data.profile && data.profile.bio) || '';
                    userData.avatar = (data.profile && data.profile.avatar) || '';
                    console.log(' User data loaded from Firebase:', userData);
                    // Update profile display on page
                    updateProfileDisplay();
                } else {
                    console.log('No user data found, will create on first save');
                    // Still update display with default
                    updateProfileDisplay();
                }
            }).catch(error => {
                console.error('Error loading from Firebase:', error);
            });
        }

        // Update profile display on page
        function updateProfileDisplay() {
            const profileNameEl = document.getElementById('profileName');
            if (profileNameEl) {
                profileNameEl.textContent = userData.name || 'User';
            }
            console.log('Profile display updated:', userData.name);
        }

        // Save balance to Firebase
        function saveBalanceToFirebase(newBalance) {
            userData.balance = newBalance;
            saveUserDataToFirebase();
        }

        // Save transaction to Firebase
        function saveTransactionToFirebase(transaction) {
            userData.transactions.unshift(transaction);
            saveUserDataToFirebase();
        }

        // Open profile modal
        function openProfile() {
            document.getElementById('profileModalOverlay').classList.add('active');
            document.getElementById('inputName').value = userData.name;
            document.getElementById('inputEmail').value = auth.currentUser.email;
            document.getElementById('inputBio').value = userData.bio;
            document.getElementById('profileName').textContent = userData.name;
            document.getElementById('profileEmail').textContent = auth.currentUser.email;
        }

        // Close profile modal
        function closeProfileModal() {
            document.getElementById('profileModalOverlay').classList.remove('active');
        }

        // Save profile changes
        function saveProfileChanges() {
            userData.name = document.getElementById('inputName').value;
            userData.bio = document.getElementById('inputBio').value;
            updateProfileDisplay();
            saveUserDataToFirebase();
            showToast('Profile updated successfully!', 'success');
            closeProfileModal();
        }

        // ===== WALLET FUNCTIONS =====

        // TEST: Add balance to wallet (for testing withdrawal)
        let currentWalletFilter = 'all';
        let walletData = {
            dlsAccountNumber: null, // DLS00000-DLS99999 (unique per user, generated once)
            bankCode: null,
            bankAccountNumber: null,
            accountName: null,
            bankAddedDate: null,
            balance: 0,
            transactions: []
        };

        // Generate unique wallet account number (DLS00000-DLS99999)
        function generateWalletAccountNumber() {
            const randomNumber = Math.floor(Math.random() * 100000);
            return 'DLS' + String(randomNumber).padStart(5, '0');
        }

        // Open wallet modal
        function openWalletModal() {
            document.getElementById('walletModalOverlay').classList.add('active');

            // Generate DLS account number if not exists (only once per user)
            if (!walletData.dlsAccountNumber) {
                walletData.dlsAccountNumber = generateWalletAccountNumber();
                saveWalletDataToFirebase();
            }

            // Clear form inputs on open
            document.getElementById('bankSelect').value = '';
            document.getElementById('accountNumber').value = '';
            document.getElementById('accountName').value = '';
            document.getElementById('bankAccountStatus').innerHTML = '';

            // Load fresh data from Firebase
            loadWalletDataFromFirebase().then(() => {
                // Display balance and account number
                document.getElementById('displayBalance').textContent = '' + (walletData.balance || 0).toLocaleString();
                document.getElementById('displayWalletAcctNumber').textContent = walletData.dlsAccountNumber;

                // Display saved bank details if they exist
                if (walletData.bankCode && walletData.bankAccountNumber) {
                    document.getElementById('accountNumber').value = walletData.bankAccountNumber;
                    document.getElementById('accountName').value = walletData.accountName || '';
                    document.getElementById('bankSelect').value = walletData.bankCode;
                }

                renderTransactionHistory();
                checkBankAccountLock();
            }).catch(error => {
                showToast('Error loading wallet data', 'error');
            });
        }

        // Close wallet modal
        function closeWalletModal() {
            document.getElementById('walletModalOverlay').classList.remove('active');
        }

        // Switch wallet tabs
        function switchWalletTab(tab, tabElement) {
            document.querySelectorAll('.wallet-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.wallet-tab-content').forEach(c => c.classList.remove('active'));

            const activeTab = tabElement || event.target;
            activeTab.classList.add('active');
            document.getElementById('walletBankTab').classList.toggle('active', tab === 'bank');
            document.getElementById('walletHistoryTab').classList.toggle('active', tab === 'history');
        }

        // Check 7-day lock on bank account
        function checkBankAccountLock() {
            const lockMessage = document.getElementById('lockMessage');
            const saveBankBtn = document.getElementById('saveBankBtn');
            const editBankBtn = document.getElementById('editBankBtn');
            const bankSelect = document.getElementById('bankSelect');
            const accountNumber = document.getElementById('accountNumber');
            const accountName = document.getElementById('accountName');

            if (!walletData.bankAddedDate) {
                // No bank account registered yet
                lockMessage.innerHTML = '';
                saveBankBtn.style.display = 'block';
                editBankBtn.style.display = 'none';
                bankSelect.disabled = false;
                accountNumber.disabled = false;
                accountName.disabled = false;
                return;
            }

            const daysPassed = Math.floor((new Date() - new Date(walletData.bankAddedDate)) / (1000 * 60 * 60 * 24));

            if (daysPassed < 7) {
                // Account is locked
                const daysLeft = 7 - daysPassed;
                lockMessage.innerHTML = ` Account locked for ${daysLeft} more day(s). You can edit after the lock period.`;
                saveBankBtn.style.display = 'none';
                editBankBtn.style.display = 'none';
                bankSelect.disabled = true;
                accountNumber.disabled = true;
                accountName.disabled = true;

                // Display current account details
                bankSelect.value = walletData.bankCode || '';
                accountNumber.value = walletData.bankAccountNumber || '';
                accountName.value = walletData.accountName || '';
            } else {
                // Lock period passed, can edit
                lockMessage.innerHTML = '';
                saveBankBtn.style.display = 'none';
                editBankBtn.style.display = 'block';
                bankSelect.disabled = true;
                accountNumber.disabled = true;
                accountName.disabled = true;

                // Display current account details
                bankSelect.value = walletData.bankCode || '';
                accountNumber.value = walletData.bankAccountNumber || '';
                accountName.value = walletData.accountName || '';
            }
        }

        // Update bank selection display
        function updateBankSelection() {
            const bankSelect = document.getElementById('bankSelect');
            const bankSelected = document.getElementById('bankSelected');
            const selectedOption = bankSelect.selectedOptions[0];

            if (bankSelect.value) {
                bankSelected.textContent = ` Selected: ${selectedOption.text}`;
                bankSelected.style.display = 'block';
                console.log('Bank selected:', bankSelect.value, selectedOption.text);
            } else {
                bankSelected.style.display = 'none';
            }
        }

        // Save bank account
        function saveBankAccount() {
            const bankSelect = document.getElementById('bankSelect');
            const accountNumInput = document.getElementById('accountNumber');
            const accountNameInput = document.getElementById('accountName');
            const statusDiv = document.getElementById('bankAccountStatus');

            const bank = bankSelect.value.trim();
            const accountNum = accountNumInput.value.trim();
            const accountName = accountNameInput.value.trim();

            console.log('Save bank account clicked:', { bank, accountNum, accountName });

            // Simple validation - just check if filled
            if (!bank || !accountNum || !accountName) {
                statusDiv.className = 'bank-status error';
                statusDiv.textContent = ' Please fill all fields';
                return;
            }

            // Save to walletData
            walletData.bankCode = bank;
            walletData.bankAccountNumber = accountNum;
            walletData.accountName = accountName;
            walletData.bankAddedDate = new Date().toISOString();

            console.log('Updated walletData:', walletData);

            // Save to Firebase
            saveWalletDataToFirebase();

            statusDiv.className = 'bank-status success';
            statusDiv.textContent = ' Bank account saved successfully! Your account is locked for 7 days.';
            showToast('Bank account registered! Locked for 7 days.', 'success');

            // Disable inputs and update UI after 2 seconds
            setTimeout(() => {
                statusDiv.innerHTML = '';
                checkBankAccountLock();
            }, 2000);
        }

        // Edit bank account (after 7 days)
        function editBankAccount() {
            const bank = document.getElementById('bankSelect');
            const accountNum = document.getElementById('accountNumber');
            const accountName = document.getElementById('accountName');

            // Enable editing
            bank.disabled = false;
            accountNum.disabled = false;
            accountName.disabled = false;

            // Populate current values
            bank.value = walletData.bankCode || '';
            accountNum.value = walletData.bankAccountNumber || '';
            accountName.value = walletData.accountName || '';

            // Show save button
            document.getElementById('saveBankBtn').style.display = 'block';
            document.getElementById('editBankBtn').style.display = 'none';

            showToast('Account edit mode activated', 'info');
        }

        // Filter transactions
        function filterTransactions(type, buttonElement) {
            currentWalletFilter = type;

            // Update active button - use the passed button element or find it
            const activeBtn = buttonElement || event.target;
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            activeBtn.classList.add('active');

            renderTransactionHistory();
        }

        // Render transaction history
        function renderTransactionHistory() {
            const list = document.getElementById('transactionsList');

            if (!list) {
                console.error('Transaction list element not found!');
                return;
            }

            console.log('Rendering transactions:', walletData.transactions);
            console.log('Current filter:', currentWalletFilter);

            let filtered = walletData.transactions;
            if (currentWalletFilter !== 'all') {
                filtered = walletData.transactions.filter(tx => tx.status === currentWalletFilter);
            }

            console.log('Filtered transactions:', filtered);

            if (filtered.length === 0) {
                list.innerHTML = '<div class="no-transactions">No transactions found</div>';
                return;
            }

            list.innerHTML = filtered.map(tx => {
                const statusIcon = tx.status === 'successful' ? '' : tx.status === 'pending' ? '' : tx.status === 'rejected' ? '' : '';
                const amountColor = '#ff6b6b';
                const date = new Date(tx.date);
                const timeString = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                // Additional details for withdrawals
                let additionalInfo = '';
                if (tx.type === 'withdrawal') {
                    let rejectionInfo = '';
                    if (tx.status === 'rejected' && tx.rejectionReason) {
                        const reasonText = {
                            'insufficient': 'Insufficient Balance',
                            'max_requests': 'Max Requests Per Day',
                            'not_paying': 'Not Paying Out Now',
                            'other': 'Other Reason'
                        }[tx.rejectionReason] || tx.rejectionReason;

                        rejectionInfo = `
                           <div style="background: rgba(255,107,107,0.2); border-left: 2px solid #ff6b6b; padding: 6px; margin-top: 6px; border-radius: 3px;">
                               <div style="color: #ff6b6b; font-weight: 600; font-size: 0.8em;">Reason: ${reasonText}</div>
                               ${tx.rejectionNotes ? `<div style="color: var(--text-gray); font-size: 0.75em; margin-top: 2px;">Note: ${tx.rejectionNotes}</div>` : ''}
                           </div>
                       `;
                    }

                    additionalInfo = `
                       <div style="font-size: 0.75em; color: var(--text-gray); margin-top: 5px; line-height: 1.4;">
                           <div>Fee: ${(tx.fee || 0).toLocaleString()}</div>
                           <div>Net: ${(tx.net || tx.amount).toLocaleString()}</div>
                           ${tx.requestType ? `<div>Type: ${tx.requestType === 'normal' ? ' Normal' : ' Speed'}</div>` : ''}
                           ${tx.id ? `<div>Ref: ${tx.id}</div>` : ''}
                           ${rejectionInfo}
                       </div>
                   `;
                }

                return `
                     <div class="transaction-item" style="display: flex; justify-content: space-between; align-items: flex-start; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-bottom: 10px; border-left: 3px solid ${amountColor};">
                         <div class="transaction-details" style="flex: 1;">
                             <div class="transaction-type" style="font-weight: 600; margin-bottom: 4px;">
                                 ${statusIcon} ${tx.type.charAt(0).toUpperCase() + tx.type.slice(1)}
                                 <span style="color: var(--text-gray); font-weight: 400; margin-left: 10px;">${tx.status.charAt(0).toUpperCase() + tx.status.slice(1)}</span>
                             </div>
                             <div class="transaction-date" style="font-size: 0.85em; color: var(--text-gray);">${timeString}</div>
                             ${additionalInfo}
                         </div>
                         <div class="transaction-amount" style="color: ${amountColor}; font-weight: 700; white-space: nowrap; margin-left: 10px;">
                             -${tx.amount.toLocaleString()}
                         </div>
                     </div>
                 `;
            }).join('');
        }

        // Save wallet data to Firebase
        function saveWalletDataToFirebase() {
            if (!auth.currentUser) {
                console.error('Cannot save: No auth user');
                return;
            }

            const dataToSave = {
                wallet: {
                    dlsAccountNumber: walletData.dlsAccountNumber || null,
                    bankCode: walletData.bankCode || null,
                    bankAccountNumber: walletData.bankAccountNumber || null,
                    accountName: walletData.accountName || null,
                    bankAddedDate: walletData.bankAddedDate || null,
                    balance: walletData.balance || 0
                },
                transactions: walletData.transactions || [],
                updatedAt: new Date().toISOString()
            };

            console.log('Saving to Firebase:', {
                userId: auth.currentUser.uid,
                email: auth.currentUser.email,
                data: dataToSave
            });

            db.collection('users').doc(auth.currentUser.uid).set(dataToSave, { merge: true })
                .then(() => {
                    console.log(' Wallet data saved to Firebase successfully');
                })
                .catch(error => {
                    console.error(' Error saving wallet data to Firebase:', error);
                });
        }

        // Load wallet data from Firebase (returns Promise)
        function loadWalletDataFromFirebase() {
            if (!auth.currentUser) {
                console.log('No auth user, skipping Firebase load');
                return Promise.resolve();
            }

            console.log('Loading wallet data for user:', auth.currentUser.uid);
            return db.collection('users').doc(auth.currentUser.uid).get().then(doc => {
                console.log('Firebase document exists:', doc.exists);

                if (!doc.exists) {
                    console.log('Document does not exist in Firebase - no wallet data saved yet');
                    return;
                }

                const allData = doc.data() || {};
                console.log('Raw Firebase data:', allData);

                // Load wallet data - simple assignment
                if (allData.wallet) {
                    console.log('Wallet data found in Firebase:', allData.wallet);
                    walletData.dlsAccountNumber = allData.wallet.dlsAccountNumber || null;
                    walletData.bankCode = allData.wallet.bankCode || null;
                    walletData.bankAccountNumber = allData.wallet.bankAccountNumber || null;
                    walletData.accountName = allData.wallet.accountName || null;
                    walletData.bankAddedDate = allData.wallet.bankAddedDate || null;
                    walletData.balance = allData.wallet.balance || 0;
                } else {
                    console.log('No wallet object in Firebase document');
                }

                // Load transactions - simple assignment
                walletData.transactions = (allData.transactions && Array.isArray(allData.transactions)) ? allData.transactions : [];
                console.log('Loaded wallet data:', walletData);

                checkBankAccountLock();
                renderTransactionHistory();
            }).catch(error => {
                console.error('Error loading wallet data:', error);
            });
        }

        // ===== WITHDRAWAL FUNCTIONS =====

        // Open withdrawal modal
        function openWithdrawalModal() {
            try {
                const overlay = document.getElementById('withdrawalModalOverlay');
                if (!overlay) {
                    showToast('Withdrawal modal not found', 'error');
                    return;
                }
                // Open modal first
                overlay.classList.add('active');

                // Display account details (with defaults if not set)
                const bankName = document.querySelector(`#bankSelect option[value="${walletData.bankCode}"]`)?.textContent || 'Not Added';
                document.getElementById('withdrawAccountDisplay').textContent = bankName;
                document.getElementById('withdrawNameDisplay').textContent = walletData.accountName || '-';
                document.getElementById('withdrawBalanceDisplay').textContent = '' + (walletData.balance || 0).toLocaleString();

                // Reset form
                document.getElementById('withdrawalAmount').value = '';
                document.getElementById('normalRequest').checked = true;
                document.getElementById('withdrawalStatus').innerHTML = '';

                // Update fees (with error handling)
                try {
                    updateWithdrawalFees();
                } catch (e) {
                    // Continue even if fees update fails
                }
            } catch (error) {
                showToast('Error opening withdrawal modal', 'error');
            }
        }

        // Close withdrawal modal
        function closeWithdrawalModal() {
            document.getElementById('withdrawalModalOverlay').classList.remove('active');
        }

        // Calculate and update withdrawal fees
        function updateWithdrawalFees() {
            const amount = parseFloat(document.getElementById('withdrawalAmount').value) || 0;
            const requestType = document.querySelector('input[name="requestType"]:checked').value;

            let fee = 0;
            let minAmount = 100;
            let maxAmount = 480000;

            if (requestType === 'normal') {
                // Normal: 10 per 100
                fee = Math.floor(amount / 100) * 10;
                minAmount = 100;
            } else if (requestType === 'speed') {
                // Speed: 150 per 1000 (Max 2000)
                fee = Math.min(Math.floor(amount / 1000) * 150, 2000);
                minAmount = 1000;
            }

            // Update display
            document.getElementById('feeAmount').textContent = '' + amount.toLocaleString();
            document.getElementById('feeCharge').textContent = '' + fee.toLocaleString();
            document.getElementById('feeTotal').textContent = '' + (amount - fee).toLocaleString();

            // Validation
            const statusDiv = document.getElementById('withdrawalStatus');
            if (amount > 0) {
                if (amount < minAmount) {
                    statusDiv.className = 'withdrawal-status error';
                    statusDiv.textContent = ` Minimum amount is ${minAmount.toLocaleString()}`;
                } else if (amount > maxAmount) {
                    statusDiv.className = 'withdrawal-status error';
                    statusDiv.textContent = ` Maximum amount is ${maxAmount.toLocaleString()}`;
                } else if (amount > walletData.balance) {
                    statusDiv.className = 'withdrawal-status error';
                    statusDiv.textContent = ` Insufficient balance`;
                } else {
                    statusDiv.innerHTML = '';
                }
            } else {
                statusDiv.innerHTML = '';
            }
        }

        // Submit withdrawal request
        function submitWithdrawal() {
            const statusDiv = document.getElementById('withdrawalStatus');
            const amount = parseFloat(document.getElementById('withdrawalAmount').value);
            const requestType = document.querySelector('input[name="requestType"]:checked').value;

            console.log('Withdrawal submitted:', { amount, requestType, currentBalance: walletData.balance });

            // Validate amount
            if (!amount || amount <= 0) {
                statusDiv.className = 'withdrawal-status error';
                statusDiv.textContent = ' Please enter a valid amount';
                return;
            }

            // Check balance
            if (amount > walletData.balance) {
                statusDiv.className = 'withdrawal-status error';
                statusDiv.textContent = ` Insufficient balance. Available: ${walletData.balance.toLocaleString()}`;
                return;
            }

            // Check limits
            const minAmount = requestType === 'normal' ? 100 : 1000;
            const maxAmount = 480000;

            if (amount < minAmount || amount > maxAmount) {
                statusDiv.className = 'withdrawal-status error';
                statusDiv.textContent = ` Amount must be between ${minAmount.toLocaleString()} and ${maxAmount.toLocaleString()}`;
                return;
            }

            // Calculate fee
            let fee = 0;
            if (requestType === 'normal') {
                fee = Math.floor(amount / 100) * 10;
            } else {
                fee = Math.min(Math.floor(amount / 1000) * 150, 2000);
            }

            // Create transaction record
            const transaction = {
                id: 'WTH-' + Date.now(),
                type: 'withdrawal',
                amount: amount,
                fee: fee,
                net: amount - fee,
                status: 'pending',
                requestType: requestType,
                bankCode: walletData.bankCode,
                accountName: walletData.accountName,
                date: new Date().toISOString(),
                description: `${requestType === 'normal' ? 'Normal' : 'Speed'} Withdrawal Request`,
                balanceAtRequest: walletData.balance  // Store balance at time of request
            };

            // DO NOT deduct from balance yet - only when admin approves
            // Balance will be deducted when admin approves the withdrawal
            walletData.transactions.unshift(transaction);

            // Save to Firebase
            saveWalletDataToFirebase();

            // Show success message
            statusDiv.className = 'withdrawal-status success';
            statusDiv.innerHTML = `
                   Withdrawal request submitted successfully!<br>
                  <small>Amount: ${amount.toLocaleString()}<br>
                  Fee: ${fee.toLocaleString()}<br>
                  You'll receive: ${(amount - fee).toLocaleString()}<br>
                  Reference: ${transaction.id}</small>
              `;

            showToast(`Withdrawal request submitted! Ref: ${transaction.id}`, 'success');

            // Reset form and close after delay
            setTimeout(() => {
                document.getElementById('withdrawalAmount').value = '';
                closeWithdrawalModal();
                openWalletModal(); // Refresh wallet to show updated balance
            }, 2500);
        }

        // ===== DEPOSIT FUNCTIONS (FLUTTERWAVE) =====

        // Open deposit modal
        function openDepositModal() {
            document.getElementById('depositModalOverlay').classList.add('active');
            document.getElementById('depositAmount').value = '';
            document.getElementById('depositStatus').innerHTML = '';
        }

        // Close deposit modal
        function closeDepositModal() {
            document.getElementById('depositModalOverlay').classList.remove('active');
        }

        // Process deposit payment with Flutterwave
        function processDepositPayment() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            const statusDiv = document.getElementById('depositStatus');

            // Validation
            if (!amount || amount <= 0) {
                statusDiv.className = 'withdrawal-status error';
                statusDiv.textContent = ' Please enter a valid amount';
                return;
            }

            if (amount < 1) {
                statusDiv.className = 'withdrawal-status error';
                statusDiv.textContent = ' Minimum amount is 1';
                return;
            }

            if (amount > 99999999) {
                statusDiv.className = 'withdrawal-status error';
                statusDiv.textContent = ' Amount too large';
                return;
            }

            // Get user email (required for Flutterwave)
            const userEmail = auth.currentUser?.email || 'user@example.com';
            const userName = userData.name || 'User';
            const txRef = 'DLS_DEPOSIT_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

            // Disable button and show loading
            const payBtn = document.getElementById('depositPayBtn');
            payBtn.disabled = true;
            payBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';

            // Initialize Flutterwave checkout
            FlutterwaveCheckout({
                public_key: 'FLWPUBK-d3902fdb2f80f41ada9c077eb569466a-X',
                tx_ref: txRef,
                amount: amount,
                currency: 'NGN',
                country: 'NG',
                payment_options: 'card,ussd,banktransfer,mobilemoney',
                customer: {
                    email: userEmail,
                    name: userName
                },
                customizations: {
                    title: 'DLS Draft - Wallet Deposit',
                    description: `Deposit ${amount.toLocaleString()} to your DLS Draft wallet`,
                    logo: 'https://i.ibb.co/zWr7G0xB/IMG-20250819-WA0055-1.jpg'
                },
                callback: (response) => {
                    // Handle successful payment
                    if (response.status === 'successful' || response.status === 'Done' || response.tx_ref) {
                        processDepositAfterPayment(response, amount, txRef)
                            .then(() => {
                                showToast(` Deposit successful! ${amount.toLocaleString()} added to your wallet`, 'success');
                                setTimeout(() => {
                                    closeDepositModal();
                                    openWalletModal(); // Refresh wallet
                                }, 1500);
                            })
                            .catch(error => {
                                showToast('Payment successful but error saving. Contact support with Ref: ' + txRef, 'warning');
                            });
                    } else if (response.status === 'cancelled') {
                        showToast('Payment was cancelled', 'info');
                        payBtn.disabled = false;
                        payBtn.innerHTML = '<i class="fas fa-credit-card"></i> Pay Now with Flutterwave';
                    } else {
                        showToast('Payment failed. Please try again', 'error');
                        payBtn.disabled = false;
                        payBtn.innerHTML = '<i class="fas fa-credit-card"></i> Pay Now with Flutterwave';
                    }
                },
                onclose: () => {
                    payBtn.disabled = false;
                    payBtn.innerHTML = '<i class="fas fa-credit-card"></i> Pay Now with Flutterwave';
                }
            });
        }

        // Process deposit after successful payment
        async function processDepositAfterPayment(paymentResponse, amount, txRef) {
            try {
                if (!auth.currentUser) {
                    throw new Error('User not authenticated');
                }

                // Create deposit transaction record
                const depositTransaction = {
                    id: txRef,
                    type: 'deposit',
                    amount: amount,
                    status: 'successful',
                    date: new Date().toISOString(),
                    flutterwaveRef: paymentResponse.transaction_id || paymentResponse.flw_ref,
                    description: `Deposit of ${amount.toLocaleString()}`,
                    paymentResponse: {
                        status: paymentResponse.status,
                        charged_amount: paymentResponse.charged_amount,
                        currency: paymentResponse.currency || 'NGN'
                    }
                };

                // Add transaction to wallet
                walletData.transactions.unshift(depositTransaction);

                // Update balance
                walletData.balance = (walletData.balance || 0) + amount;

                console.log('Deposit processed:', {
                    amount: amount,
                    newBalance: walletData.balance,
                    transaction: depositTransaction
                });

                // Save to Firebase
                await saveWalletDataToFirebase();

                // Update display
                renderTransactionHistory();

                return true;

            } catch (error) {
                console.error('Error processing deposit:', error);
                throw error;
            }
        }

        // Initial render
        renderMatches();

        // Show mini sections and controls on initial load for Today's Games
        document.getElementById('miniBannerSection').classList.add('active');
        document.getElementById('miniCardsSection').classList.add('active');
        document.getElementById('matchesControls').classList.add('active');
        renderMiniCards();

        // Load news from Firebase
        function loadNewsFromFirebase() {
            db.collection('news').limit(4).get().then(snapshot => {
                newsData = [];
                snapshot.forEach(doc => {
                    newsData.push(doc.data());
                });
                renderNewsCards();
            }).catch(err => console.error('Error loading news:', err));
        }

        // Render news cards
        function renderNewsCards() {
            const newsGrid = document.getElementById('newsGrid');
            if (!newsGrid) return;
            newsGrid.innerHTML = '';

            newsData.forEach((news, index) => {
                const newsCard = document.createElement('div');
                newsCard.className = 'news-card';
                newsCard.style.animationDelay = (index * 0.1) + 's';
                newsCard.innerHTML = `
                    <img src="${news.image || 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22250%22%3E%3Crect fill=%22%23333%22 width=%22400%22 height=%22250%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2224%22 fill=%22%23999%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22%3ENo Image%3C/text%3E%3C/svg%3E'}" alt="${news.title}" class="news-image">
                    <div class="news-content">
                        <div class="news-date">${news.date || new Date().toLocaleDateString()}</div>
                        <h3 class="news-title">${news.title}</h3>
                        <p class="news-excerpt">${news.excerpt}</p>
                        <span class="read-more">Read More </span>
                    </div>
                `;
                newsCard.addEventListener('click', () => {
                    showToast(`${news.title}`, 'info', 5000);
                });
                newsGrid.appendChild(newsCard);
            });
        }

        // Load sponsors from Firebase
        function loadSponsorsFromFirebase() {
            db.collection('sponsors').get().then(snapshot => {
                sponsorsData = [];
                snapshot.forEach(doc => {
                    sponsorsData.push(doc.data());
                });
                renderSponsors();
            }).catch(err => console.error('Error loading sponsors:', err));
        }

        // Render sponsors
        function renderSponsors() {
            const sponsorsGrid = document.getElementById('sponsorsGrid');
            if (!sponsorsGrid) return;
            sponsorsGrid.innerHTML = '';

            sponsorsData.forEach((sponsor, index) => {
                const sponsorCard = document.createElement('div');
                sponsorCard.className = 'sponsor-footer-card';
                sponsorCard.style.animationDelay = (index * 0.1) + 's';
                sponsorCard.innerHTML = `
                    <div class="sponsor-footer-logo">${sponsor.logo}</div>
                    <div class="sponsor-footer-name">${sponsor.name}</div>
                    <div class="sponsor-footer-type">${sponsor.type || 'Partner'}</div>
                `;
                sponsorsGrid.appendChild(sponsorCard);
            });
        }

        // Close tournament popup when clicking outside
        document.getElementById('tournamentPopupOverlay').addEventListener('click', (e) => {
            if (e.target.id === 'tournamentPopupOverlay') {
                closeTournamentPopup();
            }
        });

        // ===== MISSING FUNCTIONS =====

        // Open profile modal
        function openProfileModal() {
            document.getElementById('profileModalOverlay').classList.add('active');
        }

        // Close profile modal
        function closeProfileModal() {
            document.getElementById('profileModalOverlay').classList.remove('active');
        }

        // Edit profile
        function editProfile() {
            showToast('Profile edit mode enabled', 'info');
            document.getElementById('inputName').focus();
        }

        // Update bank selection display
        function updateBankSelection() {
            const bankSelect = document.getElementById('bankSelect');
            const bankSelected = document.getElementById('bankSelected');
            if (bankSelect.value) {
                bankSelected.textContent = ' Bank selected: ' + bankSelect.options[bankSelect.selectedIndex].text;
                bankSelected.style.display = 'block';
            } else {
                bankSelected.style.display = 'none';
            }
        }



        // ===== TOAST NOTIFICATION SYSTEM =====
        function showToast(message, type = 'info', duration = 4000) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const icons = {
                success: '',
                error: '',
                info: '',
                warning: ''
            };

            toast.innerHTML = `
                <span class="toast-icon">${icons[type] || ''}</span>
                <span class="toast-message">${message}</span>
                <span class="toast-close" onclick="this.parentElement.remove()"></span>
            `;

            container.appendChild(toast);

            if (duration > 0) {
                setTimeout(() => {
                    toast.classList.add('removing');
                    setTimeout(() => toast.remove(), 300);
                }, duration);
            }

            return toast;
        }

        // ===== PREDICTIONS MANAGEMENT =====
        let currentMatchPredictions = {};

        function openPredictionsModal() {
            document.getElementById('predictionsModalOverlay').classList.add('active');
            loadMatchesForPredictions();
        }

        function closePredictionsModal() {
            document.getElementById('predictionsModalOverlay').classList.remove('active');
        }

        function loadMatchesForPredictions() {
            const select = document.getElementById('predictionsMatchSelect');
            select.innerHTML = '<option value="">-- Select a match --</option>';

            db.collection('matches').where('status', '==', 'upcoming').get().then(snapshot => {
                snapshot.forEach(doc => {
                    const match = doc.data();
                    const option = document.createElement('option');
                    option.value = doc.id;
                    option.textContent = `${match.teamA?.name || 'Team A'} vs ${match.teamB?.name || 'Team B'} - ${match.matchTime || 'TBD'}`;
                    select.appendChild(option);
                });
            });
        }

        function loadPredictionsForMatch(matchId) {
            const container = document.getElementById('predictionsContainer');

            if (!matchId) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';
            currentMatchPredictions = { matchId: matchId, scores: [], teams: [], goals: [] };

            // Load existing predictions from Firebase
            db.collection('matches').doc(matchId).collection('predictions').get().then(snapshot => {
                snapshot.forEach(doc => {
                    const pred = doc.data();
                    if (pred.type === 'exactScore') currentMatchPredictions.scores.push(pred);
                    else if (pred.type === 'teamToScore') currentMatchPredictions.teams.push(pred);
                    else if (pred.type === 'totalGoals') currentMatchPredictions.goals.push(pred);
                });
                renderPredictionsList();
            });
        }

        function updatePredictionTypes() {
            document.getElementById('pred_scoreOptions').style.display =
                document.getElementById('pred_scoreEnabled').checked ? 'block' : 'none';
            document.getElementById('pred_teamOptions').style.display =
                document.getElementById('pred_teamEnabled').checked ? 'block' : 'none';
            document.getElementById('pred_goalsOptions').style.display =
                document.getElementById('pred_goalsEnabled').checked ? 'block' : 'none';
        }

        function addScorePrediction() {
            const teamAScore = parseInt(document.getElementById('predTeamAScore').value) || 0;
            const teamBScore = parseInt(document.getElementById('predTeamBScore').value) || 0;

            const prediction = {
                type: 'exactScore',
                teamAScore: teamAScore,
                teamBScore: teamBScore,
                id: Date.now()
            };

            currentMatchPredictions.scores.push(prediction);
            document.getElementById('predTeamAScore').value = '';
            document.getElementById('predTeamBScore').value = '';
            renderPredictionsList();
        }

        function addTeamPrediction(team) {
            const prediction = {
                type: 'teamToScore',
                team: team,
                id: Date.now()
            };

            currentMatchPredictions.teams.push(prediction);
            renderPredictionsList();
        }

        function addGoalsPrediction() {
            const totalGoals = parseInt(document.getElementById('predTotalGoals').value) || 0;

            const prediction = {
                type: 'totalGoals',
                totalGoals: totalGoals,
                id: Date.now()
            };

            currentMatchPredictions.goals.push(prediction);
            document.getElementById('predTotalGoals').value = '';
            renderPredictionsList();
        }

        function renderPredictionsList() {
            document.getElementById('scorePredictionsList').innerHTML = currentMatchPredictions.scores
                .map((p, i) => `<div class="prediction-item">Exact Score: ${p.teamAScore}-${p.teamBScore} 
                    <button onclick="removePrediction('scores', ${i})" style="margin-left: 10px; background: #ff4444; border: 1px solid #ff8888; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer;">Remove</button></div>`)
                .join('');

            document.getElementById('teamPredictionsList').innerHTML = currentMatchPredictions.teams
                .map((p, i) => `<div class="prediction-item">${p.team === 'teamA' ? 'Team A' : 'Team B'} Will Score
                    <button onclick="removePrediction('teams', ${i})" style="margin-left: 10px; background: #ff4444; border: 1px solid #ff8888; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer;">Remove</button></div>`)
                .join('');

            document.getElementById('goalsPredictionsList').innerHTML = currentMatchPredictions.goals
                .map((p, i) => `<div class="prediction-item">Total Goals: ${p.totalGoals}
                    <button onclick="removePrediction('goals', ${i})" style="margin-left: 10px; background: #ff4444; border: 1px solid #ff8888; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer;">Remove</button></div>`)
                .join('');
        }

        function removePrediction(type, index) {
            if (type === 'scores') currentMatchPredictions.scores.splice(index, 1);
            else if (type === 'teams') currentMatchPredictions.teams.splice(index, 1);
            else if (type === 'goals') currentMatchPredictions.goals.splice(index, 1);
            renderPredictionsList();
        }

        function savePredictions() {
            const matchId = currentMatchPredictions.matchId;
            if (!matchId) {
                showToast('Please select a match', 'error');
                return;
            }

            const batch = db.batch();
            const batch_ref = db.collection('matches').doc(matchId).collection('predictions');

            // Clear existing predictions
            batch_ref.get().then(snapshot => {
                snapshot.docs.forEach(doc => {
                    batch.delete(doc.ref);
                });

                // Add all new predictions
                [...currentMatchPredictions.scores, ...currentMatchPredictions.teams, ...currentMatchPredictions.goals].forEach(pred => {
                    batch.set(batch_ref.doc(pred.id.toString()), pred);
                });

                batch.commit().then(() => {
                    showToast(' Predictions saved successfully!', 'success');
                    setTimeout(() => closePredictionsModal(), 1500);
                }).catch(err => showToast('Error saving predictions: ' + err.message, 'error'));
            });
        }

        // ===== GOAL SCORERS MANAGEMENT =====
        let currentMatchGoalScorers = {};

        function openGoalScorersModal() {
            document.getElementById('goalScorersModalOverlay').classList.add('active');
            loadMatchesForGoalScorers();
        }

        function closeGoalScorersModal() {
            document.getElementById('goalScorersModalOverlay').classList.remove('active');
        }

        function loadMatchesForGoalScorers() {
            const select = document.getElementById('goalScorersMatchSelect');
            select.innerHTML = '<option value="">-- Select a match --</option>';

            db.collection('matches').where('status', '==', 'live').get().then(snapshot => {
                snapshot.forEach(doc => {
                    const match = doc.data();
                    const option = document.createElement('option');
                    option.value = doc.id;
                    option.textContent = `${match.teamA?.name || 'Team A'} vs ${match.teamB?.name || 'Team B'}`;
                    select.appendChild(option);
                });
            });
        }

        function loadGoalScorersForMatch(matchId) {
            const container = document.getElementById('goalScorersContainer');

            if (!matchId) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';
            currentMatchGoalScorers = { matchId: matchId, scorers: [] };

            // Load existing goal scorers from Firebase
            db.collection('matches').doc(matchId).get().then(doc => {
                if (doc.exists && doc.data().goalScorers) {
                    currentMatchGoalScorers.scorers = doc.data().goalScorers;
                }
                renderGoalScorersList();
            });
        }

        function addGoalScorer() {
            const team = document.getElementById('goalScorerTeam').value;
            const name = document.getElementById('goalScorerName').value;
            const minute = parseInt(document.getElementById('goalScorerMinute').value) || 0;

            if (!name) {
                showToast('Please enter player name', 'error');
                return;
            }

            const scorer = {
                team: team,
                name: name,
                minute: minute,
                id: Date.now()
            };

            currentMatchGoalScorers.scorers.push(scorer);
            document.getElementById('goalScorerName').value = '';
            document.getElementById('goalScorerMinute').value = '';
            renderGoalScorersList();
            showToast(` ${name} added as goal scorer`, 'success');
        }

        function renderGoalScorersList() {
            document.getElementById('goalScorersList').innerHTML = currentMatchGoalScorers.scorers
                .map((scorer, i) => `
                    <div style="background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); padding: 12px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong>${scorer.name}</strong> (${scorer.team === 'teamA' ? 'Team A' : 'Team B'}) - Minute ${scorer.minute}'
                        </div>
                        <button onclick="removeGoalScorer(${i})" style="background: #ff4444; border: 1px solid #ff8888; color: white; padding: 5px 10px; border-radius: 5px; cursor: pointer;">Remove</button>
                    </div>
                `)
                .join('');
        }

        function removeGoalScorer(index) {
            currentMatchGoalScorers.scorers.splice(index, 1);
            renderGoalScorersList();
        }

        function saveGoalScorers() {
            const matchId = currentMatchGoalScorers.matchId;
            if (!matchId) {
                showToast('Please select a match', 'error');
                return;
            }

            db.collection('matches').doc(matchId).update({
                goalScorers: currentMatchGoalScorers.scorers
            }).then(() => {
                showToast(' Goal scorers saved successfully!', 'success');
                setTimeout(() => closeGoalScorersModal(), 1500);
            }).catch(err => showToast('Error saving goal scorers: ' + err.message, 'error'));
        }

        // ===== WATCH FEE MANAGEMENT =====
        function openWatchFeeModal() {
            document.getElementById('watchFeeModal').classList.add('active');
        }

        function closeWatchFeeModal() {
            document.getElementById('watchFeeModal').classList.remove('active');
        }

        function switchWatchFeeTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.watch-fee-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.watch-fee-tab').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
        }

        // ===== TAB SWITCHING =====
        let currentTab = 'today';
        let currentSubTab = 'single';

        function switchTab(btn, tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            currentTab = tab;

            // Filter matches based on selected tab
            renderMatches();
        }

        function switchSubTab(btn, subTab) {
            document.querySelectorAll('.sub-tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            currentSubTab = subTab;

            // Re-render matches with new sub-tab filter
            renderMatches();
        }

        function filterMatches() {
            renderMatches();
        }

        function toggleFilterMenu() {
            showToast('Filter options: Date Range  Live Status  Competition Type', 'info', 5000);
        }

        // ===== PLAYERS MODAL =====
        let currentPlayersMatch = null;

        function openPlayersModal(matchId) {
            const match = sampleMatches.find(m => m.id === matchId);
            if (!match) {
                showToast('Match not found', 'error');
                return;
            }

            currentPlayersMatch = match;
            populatePlayersModal(match);
            document.getElementById('playersModalOverlay').classList.add('active');
        }

        function closePlayersModal() {
            document.getElementById('playersModalOverlay').classList.remove('active');
            currentPlayersMatch = null;
        }

        function populatePlayersModal(match) {
            // Set title
            document.getElementById('playersModalTitle').textContent = `${match.teamA?.name || 'Team A'} vs ${match.teamB?.name || 'Team B'} - Players`;
            document.getElementById('playersTeamAName').textContent = match.teamA?.name || 'Team A';
            document.getElementById('playersTeamBName').textContent = match.teamB?.name || 'Team B';

            // === TEAM A INFO ===
            // Host info
            const hostPlaceholder = 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2280%22 height=%2280%22%3E%3Crect fill=%22%23333%22 width=%2280%22 height=%2280%22 rx=%228%22/%3E%3Ctext x=%2240%22 y=%2245%22 font-size=%2224%22 fill=%22%23999%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22%3EHost%3C/text%3E%3C/svg%3E';
            const teamAHostImg = match.teamA?.hostImage || match.teamA?.avatar || hostPlaceholder;
            const teamAHostName = match.teamA?.hostName || match.teamA?.owner || 'Host Name';
            const teamAOwner = match.teamA?.owner || 'Club Owner';

            document.getElementById('teamAHostImg').src = teamAHostImg;
            document.getElementById('teamAHostImg').onerror = function () { this.src = hostPlaceholder; };
            document.getElementById('teamAHostName').textContent = teamAHostName;
            document.getElementById('teamAOwner').textContent = teamAOwner;

            // Captain info
            const teamACaptain = match.teamA?.captainName || 'Captain Name';
            document.getElementById('teamACaptain').textContent = teamACaptain;

            // Populate Team A Players
            populateTeamPlayers('teamA', match.teamA);

            // === TEAM B INFO ===
            // Host info
            const teamBHostImg = match.teamB?.hostImage || match.teamB?.avatar || hostPlaceholder;
            const teamBHostName = match.teamB?.hostName || match.teamB?.owner || 'Host Name';
            const teamBOwner = match.teamB?.owner || 'Club Owner';

            document.getElementById('teamBHostImg').src = teamBHostImg;
            document.getElementById('teamBHostImg').onerror = function () { this.src = hostPlaceholder; };
            document.getElementById('teamBHostName').textContent = teamBHostName;
            document.getElementById('teamBOwner').textContent = teamBOwner;

            // Captain info
            const teamBCaptain = match.teamB?.captainName || 'Captain Name';
            document.getElementById('teamBCaptain').textContent = teamBCaptain;

            // Populate Team B Players
            populateTeamPlayers('teamB', match.teamB);
        }

        // Helper function to populate team players list
        function populateTeamPlayers(teamId, teamData) {
            const playersContainer = document.getElementById(`${teamId}PlayersList`);
            if (!playersContainer) return;

            // Check if team has players array
            if (teamData?.players && Array.isArray(teamData.players) && teamData.players.length > 0) {
                playersContainer.innerHTML = teamData.players.map((player, index) => `
                    <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: rgba(255, 215, 0, 0.05); border-left: 3px solid var(--accent-gold); border-radius: 8px;">
                        <div style="flex-shrink: 0;">
                            <div style="width: 50px; height: 50px; border-radius: 50%; background: rgba(255, 215, 0, 0.2); display: flex; align-items: center; justify-content: center; font-size: 1.5em;"></div>
                        </div>
                        <div style="flex: 1;">
                            <div style="color: var(--text-white); font-weight: 600; font-size: 0.95em;">${player.name || 'Unknown Player'}</div>
                            <div style="display: flex; gap: 15px; margin-top: 4px;">
                                <span style="color: var(--accent-gold); font-size: 0.8em; font-weight: 500;"> ${player.role || 'Player'}</span>
                                <span style="color: var(--text-gray); font-size: 0.8em;">Jersey #${player.number || 'N/A'}</span>
                            </div>
                        </div>
                    </div>
                `).join('');
            } else {
                playersContainer.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-gray); background: rgba(255, 215, 0, 0.05); border-radius: 8px;">No players added yet</div>';
            }
        }

        // Create upcoming match card HTML
        function createUpcomingMatchCardHTML(match) {
            const teamALogo = getTeamLogo(match.teamA);
            const teamBLogo = getTeamLogo(match.teamB);

            return `
                <div class="upcoming-match-card">
                    <div class="upcoming-logo-section">
                        <div class="upcoming-team-logo">${teamALogo}</div>
                    </div>
                    <div class="upcoming-info-section">
                        <div class="upcoming-teams">${match.teamA?.name || 'Team A'} vs ${match.teamB?.name || 'Team B'}</div>
                        <div class="upcoming-date"> ${formatDateWithDay(match.matchDate)}</div>
                        <div style="display: flex; align-items: center; gap: 4px;">
                            <div class="upcoming-datetime"> ${match.matchTime || '--:--'}</div>
                            <button class="upcoming-players-btn" onclick="openPlayersModal('${match.id}')"> Players</button>
                        </div>
                    </div>
                    <div class="upcoming-logo-section">
                        <div class="upcoming-team-logo">${teamBLogo}</div>
                    </div>
                </div>
            `;
        }

        // ===== FULL STATS MODAL =====
        let currentStatsMatch = null;

        function openStatsModal(matchId) {
            const match = sampleMatches.find(m => m.id === matchId);
            if (!match) {
                showToast('Match not found', 'error');
                return;
            }

            currentStatsMatch = match;
            populateStatsModal(match);
            document.getElementById('statsModalOverlay').classList.add('active');
        }

        function closeStatsModal() {
            document.getElementById('statsModalOverlay').classList.remove('active');
            currentStatsMatch = null;
        }

        function populateStatsModal(match) {
            // Match Overview
            document.getElementById('statsMatchTitle').textContent = `${match.teamA?.name || 'Team A'} vs ${match.teamB?.name || 'Team B'}`;
            document.getElementById('statsTeamA').textContent = match.teamA?.name || 'Team A';
            document.getElementById('statsTeamB').textContent = match.teamB?.name || 'Team B';
            document.getElementById('statsOwnerA').textContent = match.teamA?.owner || 'Host';
            document.getElementById('statsOwnerB').textContent = match.teamB?.owner || 'Host';
            document.getElementById('statsTime').textContent = match.matchTime || '--:--';
            document.getElementById('statsDate').textContent = formatDateWithDay(match.matchDate);
            document.getElementById('statsStatus').textContent = getMatchStatus(match.matchDate, match.status);

            // Scores
            const scoreA = match.finalScore?.teamA || match.currentScore?.teamA || 0;
            const scoreB = match.finalScore?.teamB || match.currentScore?.teamB || 0;
            document.getElementById('statsScoreA').textContent = scoreA;
            document.getElementById('statsScoreB').textContent = scoreB;

            // Statistics
            const cornersA = match.finalStats?.corners?.teamA || 0;
            const cornersB = match.finalStats?.corners?.teamB || 0;
            const possessionA = match.finalStats?.possession?.teamA || 50;
            const possessionB = match.finalStats?.possession?.teamB || 50;
            const shotsA = match.finalStats?.shots?.teamA || 0;
            const shotsB = match.finalStats?.shots?.teamB || 0;

            document.getElementById('statsCornersA').textContent = cornersA;
            document.getElementById('statsCornersB').textContent = cornersB;
            document.getElementById('statsPossessionA').innerHTML = `${possessionA}<span style="font-size: 0.8em;">%</span>`;
            document.getElementById('statsPossessionB').innerHTML = `${possessionB}<span style="font-size: 0.8em;">%</span>`;
            document.getElementById('statsShotsA').textContent = shotsA;
            document.getElementById('statsShotsB').textContent = shotsB;

            // Cards
            const yellowA = match.finalStats?.yellowCards?.teamA || 0;
            const yellowB = match.finalStats?.yellowCards?.teamB || 0;
            const redA = match.finalStats?.redCards?.teamA || 0;
            const redB = match.finalStats?.redCards?.teamB || 0;

            document.getElementById('statsYellowA').textContent = yellowA;
            document.getElementById('statsYellowB').textContent = yellowB;
            document.getElementById('statsRedA').textContent = redA;
            document.getElementById('statsRedB').textContent = redB;

            // Goal Scorers
            if (match.goalScorers && match.goalScorers.length > 0) {
                document.getElementById('goalScorersSection').style.display = 'block';
                document.getElementById('goalScorersList').innerHTML = match.goalScorers.map(scorer => `
                    <div class="goal-scorer-item">
                        <span> ${scorer.name}</span>
                        <span style="color: var(--text-gray);">${scorer.team === 'teamA' ? match.teamA?.name : match.teamB?.name}  ${scorer.minute}'</span>
                    </div>
                `).join('');
            } else {
                document.getElementById('goalScorersSection').style.display = 'none';
            }

            // Predictions
            if (match.predictions && Object.keys(match.predictions).length > 0) {
                document.getElementById('predictionsSection').style.display = 'block';
                const predHtml = [];

                if (match.predictions.scores && match.predictions.scores.length > 0) {
                    predHtml.push(`<div style="color: var(--accent-gold); font-weight: 600; margin-bottom: 10px;">Exact Score Predictions:</div>`);
                    match.predictions.scores.forEach(p => {
                        predHtml.push(`<div class="prediction-badge"> ${p.teamAScore} - ${p.teamBScore}</div>`);
                    });
                }

                if (match.predictions.teams && match.predictions.teams.length > 0) {
                    predHtml.push(`<div style="color: var(--accent-gold); font-weight: 600; margin-top: 15px; margin-bottom: 10px;">Team to Score:</div>`);
                    match.predictions.teams.forEach(p => {
                        const teamName = p.team === 'teamA' ? match.teamA?.name : match.teamB?.name;
                        predHtml.push(`<div class="prediction-badge"> ${teamName} Will Score</div>`);
                    });
                }

                if (match.predictions.goals && match.predictions.goals.length > 0) {
                    predHtml.push(`<div style="color: var(--accent-gold); font-weight: 600; margin-top: 15px; margin-bottom: 10px;">Total Goals:</div>`);
                    match.predictions.goals.forEach(p => {
                        predHtml.push(`<div class="prediction-badge"> ${p.totalGoals} Goals</div>`);
                    });
                }

                document.getElementById('predictionsList').innerHTML = predHtml.join('');
            } else {
                document.getElementById('predictionsSection').style.display = 'none';
            }

            // Livestream Button (for live matches only)
            if (match.matchDate === getTodayDate() || match.status === 'live') {
                document.getElementById('livestreamSection').style.display = 'block';
                document.getElementById('livestreamBtn').textContent = ` WATCH LIVE`;
            } else {
                document.getElementById('livestreamSection').style.display = 'none';
            }
        }

        function openLivestream() {
            if (!currentStatsMatch) {
                showToast('No match selected', 'error');
                return;
            }
            // Open livestream - you can replace this with actual livestream URL
            const livestreamUrl = currentStatsMatch.livestreamUrl || `https://www.youtube.com/watch?v=${currentStatsMatch.id}`;
            window.open(livestreamUrl, '_blank');
            showToast('Opening livestream...', 'info');
        }

        // Normalize match data from Firebase
        function normalizeMatchData(match) {
            // Ensure required nested objects exist
            if (!match.teamA) match.teamA = { name: 'Team A' };
            if (!match.teamB) match.teamB = { name: 'Team B' };

            // Ensure team names exist
            if (!match.teamA.name) match.teamA.name = 'Team A';
            if (!match.teamB.name) match.teamB.name = 'Team B';

            // Add default logos if missing
            if (!match.teamA.logo) match.teamA.logo = match.teamA.name[0].toUpperCase();
            if (!match.teamB.logo) match.teamB.logo = match.teamB.name[0].toUpperCase();

            // Add default owners if missing
            if (!match.teamA.owner) match.teamA.owner = 'Host';
            if (!match.teamB.owner) match.teamB.owner = 'Host';

            // Ensure score objects exist
            if (!match.currentScore) match.currentScore = { teamA: 0, teamB: 0 };
            if (!match.finalScore) match.finalScore = { teamA: 0, teamB: 0 };
            if (!match.finalStats) match.finalStats = {
                yellowCards: { teamA: 0, teamB: 0 },
                redCards: { teamA: 0, teamB: 0 },
                corners: { teamA: 0, teamB: 0 },
                possession: { teamA: 50, teamB: 50 },
                shots: { teamA: 0, teamB: 0 }
            };

            return match;
        }

        // ===== LOAD MATCHES FROM FIREBASE =====
        function loadMatchesFromFirebase() {
            db.collection('matches').get().then(snapshot => {
                sampleMatches = [];
                snapshot.forEach(doc => {
                    let match = doc.data();
                    match.id = doc.id;
                    match = normalizeMatchData(match);
                    sampleMatches.push(match);
                });

                sampleMatches.sort((a, b) => new Date(a.matchDate) - new Date(b.matchDate));
                renderMiniCards();
                renderMatches();
            }).catch(err => console.error('Error loading matches:', err));
        }

        // Get today's date
        function getTodayDate() {
            const today = new Date();
            return today.toISOString().split('T')[0];
        }

        // Format date with day of week
        function formatDateWithDay(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString + 'T00:00:00');
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const dayName = days[date.getDay()];
            const options = { month: 'short', day: 'numeric', year: 'numeric' };
            const formattedDate = date.toLocaleDateString('en-US', options);
            return `${dayName}, ${formattedDate}`;
        }

        // Get match status based on date and status field
        function getMatchStatus(matchDate, matchStatus) {
            const today = getTodayDate();
            // Use match.status if available
            if (matchStatus === 'live') return 'LIVE ';
            if (matchStatus === 'finished') return 'FINISHED ';
            // Otherwise use date-based logic
            if (matchDate === today) return 'LIVE ';
            if (matchDate < today) return 'FINISHED ';
            return 'UPCOMING';
        }

        // Generate team logo from team name (if no logo URL provided)
        function getTeamLogo(team) {
            if (!team) return '';
            // If it's already a URL, return it
            if (typeof team.logo === 'string' && (team.logo.startsWith('http') || team.logo.startsWith('data:'))) {
                return `<img src="${team.logo}" style="width:100%; height:100%; object-fit: cover; border-radius: 4px;" onerror="this.parentElement.textContent=''">`;
            }
            // If it's emoji or text, return as is
            if (team.logo) return team.logo;
            // Generate from team name first letter
            const firstLetter = (team.name || 'T')[0].toUpperCase();
            return firstLetter;
        }

        // Get team avatar/image (for mini cards)
        function getTeamAvatar(team) {
            const placeholderSvg = 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2260%22 height=%2260%22%3E%3Crect fill=%22%23444%22 width=%2260%22 height=%2260%22 rx=%228%22/%3E%3Ctext x=%2230%22 y=%2235%22 font-size=%2220%22 fill=%22%23ffd700%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22 font-weight=%22bold%22%3E%s%3C/text%3E%3C/svg%3E';

            if (!team) {
                // Return generic team placeholder
                return 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2260%22 height=%2260%22%3E%3Crect fill=%22%23444%22 width=%2260%22 height=%2260%22 rx=%228%22/%3E%3Ctext x=%2230%22 y=%2235%22 font-size=%2220%22 fill=%22%23999%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22%3E%3C/text%3E%3C/svg%3E';
            }

            if (typeof team.avatar === 'string' && team.avatar.startsWith('http')) {
                return team.avatar;
            }

            // Return SVG with team initials
            const initials = (team.name || 'Team').split(' ').map(w => w[0]).join('').substring(0, 2).toUpperCase();
            return `data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2260%22 height=%2260%22%3E%3Crect fill=%22%23444%22 width=%2260%22 height=%2260%22 rx=%228%22/%3E%3Ctext x=%2230%22 y=%2235%22 font-size=%2220%22 fill=%22%23ffd700%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22 font-weight=%22bold%22%3E${initials}%3C/text%3E%3C/svg%3E`;
        }

        // Render mini cards with real data from Firebase
        function renderMiniCards() {
            const miniCardsContainer = document.querySelector('.mini-cards-container');
            if (!miniCardsContainer) return;

            const today = getTodayDate();
            const todayMatches = sampleMatches.filter(m => m.matchDate === today).slice(0, 5);

            if (todayMatches.length === 0) {
                miniCardsContainer.innerHTML = '<div style="padding: 20px; color: var(--text-gray);">No matches today</div>';
                return;
            }

            miniCardsContainer.innerHTML = todayMatches.map((match, index) => {
                const scoreA = match.currentScore?.teamA || 0;
                const scoreB = match.currentScore?.teamB || 0;
                const yellowA = match.finalStats?.yellowCards?.teamA || 0;
                const yellowB = match.finalStats?.yellowCards?.teamB || 0;
                const redA = match.finalStats?.redCards?.teamA || 0;
                const redB = match.finalStats?.redCards?.teamB || 0;

                return `
                    <div class="mini-match-card" style="animation-delay: ${index * 0.1}s">
                        <div class="mini-match-content">
                            <div style="font-size: 0.8em; color: var(--text-gray); margin-bottom: 8px;">${match.matchTime || '--:--'}</div>
                            <div class="mini-teams">${match.teamA?.name || 'Team A'} vs ${match.teamB?.name || 'Team B'}</div>
                            <div style="font-size: 1.2em; color: var(--accent-gold); font-weight: 700; margin: 8px 0;">${scoreA} - ${scoreB}</div>
                            <div style="font-size: 0.75em; color: var(--text-gray);">
                                ${yellowA > 0 ? '' : ''} ${redA > 0 ? '' : ''}
                                ${yellowB > 0 ? '' : ''} ${redB > 0 ? '' : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Render main matches with cards
        let matchDisplayOffset = 0;
        let matchRotationInterval = null;

        function renderMatches() {
            const matchesContainer = document.getElementById('matchesContainer');
            if (!matchesContainer) return;

            if (!sampleMatches || sampleMatches.length === 0) {
                matchesContainer.innerHTML = '<div style="padding: 40px; text-align: center; color: var(--text-gray);">No matches loaded</div>';
                return;
            }

            const today = getTodayDate();
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const tomorrowDate = tomorrow.toISOString().split('T')[0];

            // Get search term
            const searchTerm = document.getElementById('searchInput')?.value?.toLowerCase() || '';

            // Filter matches by tab
            let filteredMatches = sampleMatches.filter(match => {
                if (currentTab === 'today') return match.matchDate === today;
                if (currentTab === 'tomorrow') return match.matchDate === tomorrowDate;
                if (currentTab === 'upcoming') return match.matchDate > tomorrowDate;
                if (currentTab === 'live') return match.matchDate === today || match.status === 'live';
                if (currentTab === 'finished') return match.matchDate < today || match.status === 'finished';
                return true;
            });

            // Filter by sub-tab (single vs tournament)
            filteredMatches = filteredMatches.filter(match => {
                if (currentSubTab === 'single') return !match.type || !match.type.includes('Tournament');
                if (currentSubTab === 'tournament') return match.type && match.type.includes('Tournament');
                return true;
            });

            // If search active, filter across ALL matches regardless of tab
            if (searchTerm) {
                filteredMatches = sampleMatches.filter(match => {
                    return (match.teamA?.name || '').toLowerCase().includes(searchTerm) ||
                        (match.teamB?.name || '').toLowerCase().includes(searchTerm) ||
                        (match.competition || '').toLowerCase().includes(searchTerm);
                });
            }

            if (filteredMatches.length === 0) {
                matchesContainer.innerHTML = '<div style="padding: 40px; text-align: center; color: var(--text-gray);">No matches found for this filter</div>';
                return;
            }

            // Get current batch (5 matches at a time)
            const offset = searchTerm ? 0 : matchDisplayOffset; // Don't rotate when searching
            const displayedMatches = filteredMatches.slice(offset, offset + 5);
            const hasMore = filteredMatches.length > offset + 5;

            // Use compact upcoming cards for "upcoming" tab
            if (currentTab === 'upcoming') {
                matchesContainer.style.display = 'flex';
                matchesContainer.style.flexWrap = 'wrap';
                matchesContainer.style.gap = '15px';
                matchesContainer.style.overflowX = 'visible';
                let html = displayedMatches.map(match =>
                    createUpcomingMatchCardHTML(match)
                ).join('');

                if (hasMore && !searchTerm) {
                    html += `<div style="flex: 1; min-width: 280px; display: flex; align-items: center; justify-content: center; padding: 15px; background: rgba(255, 215, 0, 0.05); border: 2px dashed rgba(255, 215, 0, 0.3); border-radius: 12px; color: var(--accent-gold); font-weight: 600; cursor: pointer;" onclick="showNextMatchBatch()">See More </div>`;
                }
                matchesContainer.innerHTML = html;
            } else {
                matchesContainer.style.display = 'flex';
                matchesContainer.style.flexWrap = 'nowrap';
                matchesContainer.style.overflowX = 'auto';
                matchesContainer.style.gap = '15px';
                let html = displayedMatches.map((match, index) =>
                    createMatchCardHTML(match, index)
                ).join('');

                if (hasMore && !searchTerm) {
                    html += `<div style="min-width: 300px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; padding: 25px; background: rgba(255, 215, 0, 0.05); border: 2px dashed rgba(255, 215, 0, 0.3); border-radius: 20px; color: var(--accent-gold); font-weight: 600; text-align: center; cursor: pointer;" onclick="showNextMatchBatch()">See More<br/></div>`;
                }
                matchesContainer.innerHTML = html;
            }

            // Start auto-rotation if not searching (10 minutes = 600000ms)
            if (!searchTerm) {
                clearInterval(matchRotationInterval);
                matchRotationInterval = setInterval(() => {
                    matchDisplayOffset += 5;
                    renderMatches();
                }, 600000);
            } else {
                clearInterval(matchRotationInterval);
            }
        }

        function showNextMatchBatch() {
            matchDisplayOffset += 5;
            renderMatches();
        }

        // ===== HIGHLIGHTS MODAL =====
        let highlightsCurrentCategory = 'all';
        let sampleHighlights = [
            { id: 1, title: 'Amazing Goal - Team A', category: 'goals', videoUrl: 'https://youtu.be/dQw4w9WgXcQ', team: 'Team A', date: '2025-12-01' },
            { id: 2, title: 'Skills Showcase', category: 'skills', videoUrl: 'https://youtu.be/dQw4w9WgXcQ', team: 'Team B', date: '2025-12-01' },
            { id: 3, title: 'Incredible Save', category: 'saves', videoUrl: 'https://youtu.be/dQw4w9WgXcQ', team: 'Team A', date: '2025-11-30' },
            { id: 4, title: 'Best Moment - Winning Goal', category: 'best', videoUrl: 'https://youtu.be/dQw4w9WgXcQ', team: 'Team C', date: '2025-11-30' },
            { id: 5, title: 'Hat-trick Performance', category: 'goals', videoUrl: 'https://youtu.be/dQw4w9WgXcQ', team: 'Team A', date: '2025-11-29' },
            { id: 6, title: 'Dribbling Skills', category: 'skills', videoUrl: 'https://youtu.be/dQw4w9WgXcQ', team: 'Team D', date: '2025-11-29' },
            { id: 7, title: 'Penalty Save', category: 'saves', videoUrl: 'https://youtu.be/dQw4w9WgXcQ', team: 'Team B', date: '2025-11-28' },
            { id: 8, title: 'Match Highlights - Final', category: 'best', videoUrl: 'https://youtu.be/dQw4w9WgXcQ', team: 'Team E', date: '2025-11-28' },
        ];

        function openHighlightsModal() {
            document.getElementById('highlightsModalOverlay').classList.add('active');
            highlightsCurrentCategory = 'all';
            renderHighlights();
        }

        function closeHighlightsModal() {
            document.getElementById('highlightsModalOverlay').classList.remove('active');
        }

        // ===== CLOUDINARY CONFIG =====
        const CLOUDINARY_CLOUD_NAME = 'dzhdgxjhl';
        const CLOUDINARY_UPLOAD_PRESET = 'posepreset';
        const CLOUDINARY_API_URL = `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/auto/upload`;

        // ===== SHARE LINK FEATURE =====
        function sharePlayerLink(playerId) {
            const shareLink = `${window.location.origin}/share.html?playerId=${playerId}`;
            const modal = document.getElementById('shareLinkOverlay');
            const input = modal.querySelector('.share-link-input');
            input.value = shareLink;
            modal.classList.add('active');
            input.focus();
            input.select();
        }

        function closeShareLinkModal() {
            document.getElementById('shareLinkOverlay').classList.remove('active');
        }

        function copyShareLink() {
            const input = document.querySelector('.share-link-input');
            input.select();
            document.execCommand('copy');
            showToast('Link copied to clipboard! ', 'success');
        }

        // Handle shared player links (when someone clicks shared link)
        function handleSharedPlayerLink() {
            const path = window.location.pathname;
            const playerIdMatch = path.match(/\/player\/([^\/]+)/);

            if (playerIdMatch) {
                const playerId = playerIdMatch[1];
                // Load and display player card without redirecting
                displaySharedPlayerCard(playerId);
            }
        }

        function displaySharedPlayerCard(playerId) {
            const db = firebase.firestore();

            db.collection('players').doc(playerId).get().then(doc => {
                if (!doc.exists) {
                    showToast('Player not found', 'error');
                    return;
                }

                const playerData = doc.data();
                // Open the player details modal with the shared player's info
                window.currentViewingPlayerId = playerId;
                viewPlayerDetails(playerId);
            }).catch(err => {
                console.error('Error loading shared player:', err);
                showToast('Error loading player', 'error');
            });
        }

        // Run on page load to check for shared player links
        window.addEventListener('load', () => {
            handleSharedPlayerLink();
        });

        // Also check on hash/URL change
        window.addEventListener('popstate', () => {
            handleSharedPlayerLink();
        });

        // ===== PLAYERS RATING MODAL =====
        let playerRegistrationData = {};
        let currentUserId = null;

        function openPlayersRatingModal() {
            document.getElementById('playersRatingOverlay').classList.add('active');
            checkPlayerRegistrationStatus();
            loadRegisteredPlayers();
        }

        function closePlayersRatingModal() {
            document.getElementById('playersRatingOverlay').classList.remove('active');
        }

        function checkPlayerRegistrationStatus() {
            const db = firebase.firestore();
            const userId = auth.currentUser?.uid;

            if (!userId) {
                showToast('Please log in first', 'warning');
                return;
            }

            currentUserId = userId;

            db.collection('players').doc(userId).get().then(doc => {
                if (doc.exists) {
                    playerRegistrationData = doc.data();
                    updatePlayersRatingSidebarStatus(true);
                } else {
                    playerRegistrationData = { id: userId };
                    updatePlayersRatingSidebarStatus(false);
                }
            }).catch(err => {
                console.error('Error checking registration:', err);
            });
        }

        function loadRegisteredPlayers() {
            const db = firebase.firestore();
            const container = document.getElementById('registeredPlayersContainer');

            db.collection('players').get().then(snapshot => {
                if (snapshot.empty) {
                    container.innerHTML = '<div style="padding: 40px; text-align: center; color: var(--text-gray);">No registered players yet</div>';
                    return;
                }

                let html = '';
                let cardIndex = 0;

                snapshot.forEach(doc => {
                    const player = doc.data();
                    const delay = cardIndex * 0.1;
                    cardIndex++;

                    // Fetch rating data (both old auth-based and new device-based)
                    let totalPoints = 0;
                    let ratingCount = 0;

                    // Get old ratings (auth-based)
                    db.collection('players').doc(doc.id).collection('ratings').get().then(ratingSnapshot => {
                        ratingSnapshot.forEach(ratingDoc => {
                            const rating = ratingDoc.data().rating || 0;
                            totalPoints += rating * 0.1; // Each star = 0.1 points
                            ratingCount++;
                        });

                        // Also get new device-based ratings
                        db.collection('players').doc(doc.id).collection('deviceRatings').get().then(deviceSnapshot => {
                            deviceSnapshot.forEach(deviceRatingDoc => {
                                const rating = deviceRatingDoc.data().rating || 0;
                                totalPoints += rating * 0.1; // Each star = 0.1 points
                                ratingCount++;
                            });

                            // Update the card with rating info
                            const ratingElement = document.querySelector(`[data-player-id="${doc.id}"] .player-card-rating-badge`);
                            if (ratingElement) {
                                ratingElement.innerHTML = `<span class="player-card-rating-number">${totalPoints.toFixed(1)}</span><span class="player-card-rating-count">(${ratingCount})</span>`;
                            }
                        });
                    });

                    html += `
                        <div class="player-card" style="animation-delay: ${delay}s;" data-player-id="${doc.id}">
                            <div class="player-card-picture-section">
                                ${player.playerPicture
                            ? `<img src="${player.playerPicture}" alt="${player.realName}" class="player-card-picture">`
                            : `<div class="player-card-default-icon"><i class="fas fa-user"></i></div>`
                        }
                            </div>
                            <div class="player-card-content">
                                <div class="player-card-info-top">
                                    <div class="player-card-name-section">
                                        <div class="player-card-name">${player.realName || 'Unknown'}</div>
                                        <div class="player-card-club">${player.favoriteClub || 'N/A'}</div>
                                    </div>
                                    <div class="player-card-rating-badge">
                                        <span class="player-card-rating-number">0.0</span>
                                        <span class="player-card-rating-count">(0)</span>
                                    </div>
                                </div>
                                <div class="player-card-stats-mini">
                                    <div class="player-card-stat-mini">
                                        <span>Score:</span>
                                        <span class="player-card-stat-value-mini">${player.teamScore || '-'}</span>
                                    </div>
                                    <div class="player-card-stat-mini">
                                        <span>Win:</span>
                                        <span class="player-card-stat-value-mini">${player.winRate || '-'}</span>
                                    </div>
                                </div>
                                <div class="player-card-footer">
                                    <button class="player-card-view-btn" onclick="viewPlayerDetails('${doc.id}')">
                                        <i class="fas fa-eye"></i> View Details
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            }).catch(err => {
                console.error('Error loading players:', err);
                container.innerHTML = '<div style="padding: 40px; text-align: center; color: var(--text-gray);">Error loading players</div>';
            });
        }

        function viewPlayerDetails(playerId) {
            const db = firebase.firestore();
            db.collection('players').doc(playerId).get().then(doc => {
                if (doc.exists) {
                    const player = doc.data();
                    openPlayerDetailsModal(playerId, player);
                }
            }).catch(err => console.error('Error loading player details:', err));
        }

        function openPlayerDetailsModal(playerId, playerData) {
            window.currentViewingPlayerId = playerId;
            window.currentViewingPlayer = playerData;

            // Load rating if exists
            const db = firebase.firestore();
            db.collection('players').doc(playerId).collection('ratings').get().then(snapshot => {
                let totalRating = 0;
                if (!snapshot.empty) {
                    snapshot.forEach(doc => {
                        totalRating += doc.data().rating || 0;
                    });
                    totalRating = Math.round((totalRating / snapshot.size) * 10) / 10;
                }
                window.currentPlayerAverageRating = totalRating || 0;
                populatePlayerDetailsModal(playerId, playerData);
            }).catch(err => {
                window.currentPlayerAverageRating = 0;
                populatePlayerDetailsModal(playerId, playerData);
            });

            document.getElementById('playerDetailsOverlay').classList.add('active');
        }

        function populatePlayerDetailsModal(playerId, player) {
            const cardContent = document.getElementById('playerIdCardContent');
            const avgRating = window.currentPlayerAverageRating || 0;

            cardContent.innerHTML = `
                <div class="player-id-card">
                    <!-- LEFT SIDE: Profile Picture & Club/Team Images -->
                    <div class="player-id-left">
                        <div class="player-id-picture-container">
                            ${player.playerPicture
                    ? `<img src="${player.playerPicture}" alt="${player.realName}" class="player-id-picture">`
                    : `<i class="fas fa-user player-id-default-icon"></i>`
                }
                        </div>
                        <!-- Club & Team Images Below Profile -->
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            ${player.clubImage ? `
                                <div style="text-align: center;">
                                    <img src="${player.clubImage}" alt="Club" style="width: 60px; height: 60px; border-radius: 8px; border: 2px solid var(--accent-gold); object-fit: cover;">
                                    <div style="font-size: 0.7em; color: var(--text-gray); margin-top: 3px;">Club</div>
                                </div>
                            ` : ''}
                            ${player.teamImage ? `
                                <div style="text-align: center;">
                                    <img src="${player.teamImage}" alt="Team" style="width: 60px; height: 60px; border-radius: 8px; border: 2px solid var(--accent-gold); object-fit: cover;">
                                    <div style="font-size: 0.7em; color: var(--text-gray); margin-top: 3px;">Team</div>
                                </div>
                            ` : ''}
                        </div>
                    </div>

                    <!-- RIGHT SIDE: Player Info -->
                    <div class="player-id-right">
                        <div>
                            <h2 class="player-id-name">${player.realName || 'Unknown'}</h2>
                            <p class="player-id-club">${player.favoriteClub || 'No Club'}</p>

                            <!-- Stats Grid -->
                            <div class="player-id-stats">
                                <div class="player-id-stat-block">
                                    <div class="player-id-stat-label">Team Score</div>
                                    <div class="player-id-stat-value">${player.teamScore || '-'}</div>
                                </div>
                                <div class="player-id-stat-block">
                                    <div class="player-id-stat-label">Time Strength</div>
                                    <div class="player-id-stat-value">${player.timeStrength || '-'}</div>
                                </div>
                                <div class="player-id-stat-block">
                                    <div class="player-id-stat-label">Win Rate</div>
                                    <div class="player-id-stat-value">${player.winRate || '-'}</div>
                                </div>
                                <div class="player-id-stat-block">
                                    <div class="player-id-stat-label">Loss Rate</div>
                                    <div class="player-id-stat-value">${player.lossRate || '-'}</div>
                                </div>
                            </div>

                            <!-- Best Players -->
                            ${player.bestPlayers ? `
                                <div class="player-id-best-players">
                                    <div class="player-id-best-players-label">Best Players</div>
                                    <div class="player-id-best-players-value">${player.bestPlayers}</div>
                                </div>
                            ` : ''}
                        </div>

                        <!-- Buttons -->
                        <div class="player-id-buttons">
                            ${window.currentViewingPlayerId === auth.currentUser?.uid ? `
                                <button class="player-id-btn" onclick="openPlayerEditFromDetails('${playerId}')">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="player-id-btn" onclick="openCardMessaging('${playerId}')">
                                    <i class="fas fa-inbox"></i> Messages
                                </button>
                                <button class="player-id-btn" onclick="sharePlayerLink('${playerId}')">
                                    <i class="fas fa-share-alt"></i> Share
                                </button>
                            ` : `
                                <button class="player-id-btn" onclick="openCardMessaging('${playerId}')">
                                    <i class="fas fa-comments"></i> Message
                                </button>
                                <button class="player-id-btn" onclick="sharePlayerLink('${playerId}')">
                                    <i class="fas fa-share-alt"></i> Share
                                </button>
                            `}
                            <button class="player-id-btn" onclick="openPlayerRatingPopup('${playerId}')">
                                <i class="fas fa-star"></i> Rate Player
                            </button>
                            <button class="player-id-btn" onclick="openPlayerAdvancedAnalysis('${playerId}')">
                                <i class="fas fa-chart-bar"></i> See More
                            </button>
                        </div>
                    </div>

                    <!-- RATING CIRCLE (Top Right) -->
                    <div class="player-id-rating-corner">
                        <div class="player-id-rating-label">RATING</div>
                        <div class="player-id-rating-number">${avgRating}</div>
                    </div>
                </div>
            `;
        }

        function closePlayerDetailsModal() {
            document.getElementById('playerDetailsOverlay').classList.remove('active');
        }

        // ===== CARD MESSAGING SYSTEM =====
        let currentCardMessagingPlayerId = null;
        let cardMediaRecorder = null;
        let cardAudioChunks = [];
        let cardIsRecording = false;
        let currentReplyToSenderId = null;
        let currentReplyToSenderUsername = null;

        function openCardMessaging(playerId) {
            if (!auth.currentUser) {
                showToast('Please log in', 'warning');
                return;
            }

            currentCardMessagingPlayerId = playerId;
            const db = firebase.firestore();
            const userId = auth.currentUser.uid;
            const isOwner = userId === playerId;

            // Get player name and set title
            db.collection('players').doc(playerId).get().then(doc => {
                if (doc.exists) {
                    const playerName = doc.data().realName || 'Player';
                    if (isOwner) {
                        document.getElementById('cardMessagingTitle').textContent = ` Messages to ${playerName}`;
                    } else {
                        document.getElementById('cardMessagingTitle').textContent = ` Message to ${playerName}`;
                    }
                }
            }).catch(err => console.error('Error loading player name:', err));

            // Show/hide input area based on ownership
            const inputArea = document.querySelector('.card-messaging-input-area');
            if (isOwner) {
                inputArea.style.display = 'none';
            } else {
                inputArea.style.display = 'block';
            }

            loadCardMessages(playerId);
            document.getElementById('cardMessagingOverlay').classList.add('active');
        }

        function closeCardMessaging() {
            document.getElementById('cardMessagingOverlay').classList.remove('active');
            currentCardMessagingPlayerId = null;
            cardAudioChunks = [];
        }

        function loadCardMessages(playerId) {
            const db = firebase.firestore();
            const userId = auth.currentUser.uid;
            const messagesContainer = document.getElementById('cardMessagesList');

            // Get all messages for this player card
            db.collection('players').doc(playerId).collection('cardMessages')
                .orderBy('timestamp', 'asc')
                .onSnapshot(snapshot => {
                    messagesContainer.innerHTML = '';

                    if (snapshot.empty) {
                        messagesContainer.innerHTML = '<div style="text-align: center; color: var(--text-gray); padding: 20px;">No messages yet</div>';
                        return;
                    }

                    snapshot.forEach(doc => {
                        const msg = doc.data();
                        const isOwner = userId === playerId;
                        const isSender = msg.senderId === userId;

                        const msgEl = document.createElement('div');
                        msgEl.className = 'card-message-item';
                        msgEl.setAttribute('data-message-id', doc.id);

                        // Make received messages clickable
                        if (!isSender) {
                            msgEl.style.cursor = 'pointer';
                            msgEl.onclick = (e) => {
                                if (!e.target.closest('.message-action-btn')) {
                                    openReplyModal(msg.senderId, msg.senderUsername, msg.type, msg.text || '', msg.audioUrl || '', doc.id);
                                }
                            };
                        }

                        let messageHTML = `
                            <div class="card-message-sender">
                                <span>${msg.senderUsername || 'Unknown'}</span>
                                <span class="card-message-time">${new Date(msg.timestamp?.toDate?.() || msg.timestamp).toLocaleString()}</span>
                            </div>
                            <div class="message-actions">
                                <button class="message-action-btn" title="Copy" onclick="copyMessageToClipboard('${doc.id}', '${(msg.text || '').replace(/'/g, "\\'")}')"></button>
                                <button class="message-action-btn" title="Reply" onclick="openReplyModal('${msg.senderId}', '${(msg.senderUsername || 'Unknown').replace(/'/g, "\\'")}', '${msg.type}', '${(msg.text || '').replace(/'/g, "\\'")}', '${msg.audioUrl || ''}', '${doc.id}')"></button>
                                ${isSender ? `<button class="message-action-btn" title="Delete" onclick="deleteMessage('${doc.id}')"></button>` : ''}
                            </div>
                        `;

                        if (msg.type === 'text') {
                            messageHTML += `<div class="card-message-text">${msg.text || ''}</div>`;
                        } else if (msg.type === 'voice') {
                            messageHTML += `
                                <div class="card-message-voice">
                                    <i class="fas fa-volume-up"></i>
                                    <audio controls style="width: 100%; max-width: 300px; margin-top: 5px;">
                                        <source src="${msg.audioUrl || ''}" type="audio/wav">
                                        Your browser does not support audio playback.
                                    </audio>
                                </div>
                            `;
                        }

                        msgEl.innerHTML = messageHTML;
                        messagesContainer.appendChild(msgEl);
                    });

                    // Scroll to bottom
                    setTimeout(() => {
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    }, 100);
                }, error => {
                    console.error('Error loading messages:', error);
                    messagesContainer.innerHTML = `<div style="text-align: center; color: #ff6b6b; padding: 20px;">Error loading messages</div>`;
                });
        }

        async function sendCardMessage() {
            const messageText = document.getElementById('cardMessageInput').value.trim();

            if (!messageText) {
                showToast('Please type a message', 'warning');
                return;
            }

            if (!currentCardMessagingPlayerId) {
                showToast('No recipient selected', 'error');
                return;
            }

            const db = firebase.firestore();
            const userId = auth.currentUser.uid;
            const playerId = currentCardMessagingPlayerId;

            try {
                // Get sender's username
                const senderDoc = await db.collection('players').doc(userId).get();
                const senderUsername = senderDoc.exists ? senderDoc.data().realName : 'Unknown User';

                // Check if this is a reply or original message
                if (currentReplyToSenderId) {
                    // REPLY: Save message in BOTH locations
                    // 1. Save in card owner's collection (playerId)
                    await db.collection('players').doc(playerId).collection('cardMessages').add({
                        senderId: userId,
                        senderUsername: senderUsername,
                        replyTo: currentReplyToSenderId,
                        replyToUsername: currentReplyToSenderUsername,
                        type: 'text',
                        text: messageText,
                        timestamp: firebase.firestore.Timestamp.now()
                    });

                    // 2. Save in original sender's collection (currentReplyToSenderId)
                    await db.collection('players').doc(currentReplyToSenderId).collection('cardMessages').add({
                        senderId: userId,
                        senderUsername: senderUsername,
                        replyTo: currentReplyToSenderId,
                        replyToUsername: currentReplyToSenderUsername,
                        type: 'text',
                        text: messageText,
                        isReplyFromOwner: true,
                        timestamp: firebase.firestore.Timestamp.now()
                    });

                    showToast('Reply sent! ', 'success');
                    clearReplyContext();
                } else {
                    // ORIGINAL MESSAGE: Save to card owner's collection
                    await db.collection('players').doc(playerId).collection('cardMessages').add({
                        senderId: userId,
                        senderUsername: senderUsername,
                        type: 'text',
                        text: messageText,
                        timestamp: firebase.firestore.Timestamp.now()
                    });

                    showToast('Message sent! ', 'success');
                }

                document.getElementById('cardMessageInput').value = '';
            } catch (err) {
                console.error('Error sending message:', err);
                showToast('Error sending message', 'error');
            }
        }

        async function toggleCardVoiceRecord() {
            if (!cardIsRecording) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    cardMediaRecorder = new MediaRecorder(stream);
                    cardAudioChunks = [];

                    cardMediaRecorder.ondataavailable = (event) => {
                        cardAudioChunks.push(event.data);
                    };

                    cardMediaRecorder.onstop = async () => {
                        const audioBlob = new Blob(cardAudioChunks, { type: 'audio/wav' });
                        await uploadCardVoiceMessage(audioBlob);
                    };

                    cardMediaRecorder.start();
                    cardIsRecording = true;
                    const btn = document.getElementById('cardVoiceRecordBtn');
                    btn.classList.add('recording');
                    document.getElementById('cardVoiceRecordText').textContent = 'Recording...';
                    showToast('Recording voice note...', 'info');
                } catch (err) {
                    console.error('Microphone error:', err);
                    showToast('Microphone access denied', 'error');
                }
            } else {
                cardMediaRecorder.stop();
                cardIsRecording = false;
                const btn = document.getElementById('cardVoiceRecordBtn');
                btn.classList.remove('recording');
                document.getElementById('cardVoiceRecordText').textContent = 'Voice';
                showToast('Uploading voice note...', 'info');
            }
        }

        async function uploadCardVoiceMessage(audioBlob) {
            const db = firebase.firestore();
            const userId = auth.currentUser.uid;
            const playerId = currentCardMessagingPlayerId;

            try {
                // Upload to Cloudinary
                const formData = new FormData();
                formData.append('file', audioBlob);
                formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
                formData.append('resource_type', 'auto');

                const cloudinaryResponse = await fetch(CLOUDINARY_API_URL, {
                    method: 'POST',
                    body: formData
                });

                if (!cloudinaryResponse.ok) {
                    throw new Error('Upload failed');
                }

                const result = await cloudinaryResponse.json();

                // Get sender's username
                const senderDoc = await db.collection('players').doc(userId).get();
                const senderUsername = senderDoc.exists ? senderDoc.data().realName : 'Unknown User';

                // Check if this is a reply or original message
                if (currentReplyToSenderId) {
                    // VOICE REPLY: Save in BOTH locations
                    // 1. Save in card owner's collection (playerId)
                    await db.collection('players').doc(playerId).collection('cardMessages').add({
                        senderId: userId,
                        senderUsername: senderUsername,
                        replyTo: currentReplyToSenderId,
                        replyToUsername: currentReplyToSenderUsername,
                        type: 'voice',
                        audioUrl: result.secure_url,
                        timestamp: firebase.firestore.Timestamp.now()
                    });

                    // 2. Save in original sender's collection (currentReplyToSenderId)
                    await db.collection('players').doc(currentReplyToSenderId).collection('cardMessages').add({
                        senderId: userId,
                        senderUsername: senderUsername,
                        replyTo: currentReplyToSenderId,
                        replyToUsername: currentReplyToSenderUsername,
                        type: 'voice',
                        audioUrl: result.secure_url,
                        isReplyFromOwner: true,
                        timestamp: firebase.firestore.Timestamp.now()
                    });

                    showToast('Voice reply sent! ', 'success');
                    clearReplyContext();
                } else {
                    // ORIGINAL VOICE MESSAGE: Save to card owner's collection
                    await db.collection('players').doc(playerId).collection('cardMessages').add({
                        senderId: userId,
                        senderUsername: senderUsername,
                        type: 'voice',
                        audioUrl: result.secure_url,
                        timestamp: firebase.firestore.Timestamp.now()
                    });

                    showToast('Voice note sent! ', 'success');
                }
            } catch (err) {
                console.error('Error uploading voice note:', err);
                showToast('Error uploading voice note', 'error');
            }
        }

        // ===== REPLY MODAL SYSTEM =====
        let replyMediaRecorder = null;
        let replyAudioChunks = [];
        let replyIsRecording = false;
        let replyHasVoice = false;
        let currentReplyData = {
            senderId: null,
            senderUsername: null,
            messageType: null,
            messageText: null,
            audioUrl: null,
            messageId: null
        };

        function openReplyModal(senderId, senderUsername, messageType, messageText, audioUrl, messageId) {
            currentReplyData = {
                senderId: senderId,
                senderUsername: senderUsername,
                messageType: messageType,
                messageText: messageText,
                audioUrl: audioUrl,
                messageId: messageId
            };

            // Set sender name
            document.getElementById('replySenderName').textContent = `From: ${senderUsername}`;

            // Clear conversation thread
            const thread = document.getElementById('replyConversationThread');
            thread.innerHTML = '';

            // Load conversation for this message
            loadReplyConversation(senderId, senderUsername, messageType, messageText, audioUrl);

            // Reset input
            document.getElementById('replyMessageInput').value = '';
            replyAudioChunks = [];
            replyHasVoice = false;
            replyIsRecording = false;
            document.getElementById('replyVoiceBtn').classList.remove('recording');
            document.getElementById('replyVoiceBtnText').textContent = 'Voice';
            document.getElementById('replyVoiceIndicator').classList.remove('active');

            // Open modal
            document.getElementById('replyModalOverlay').classList.add('active');
        }

        function loadReplyConversation(senderId, senderUsername, messageType, messageText, audioUrl) {
            const thread = document.getElementById('replyConversationThread');
            const db = firebase.firestore();
            const userId = auth.currentUser.uid;
            const playerId = currentCardMessagingPlayerId;

            // Show original message first
            let originalMsg = document.createElement('div');
            originalMsg.style.cssText = 'margin-bottom: 15px; padding: 12px; background: rgba(255,215,0,0.1); border-left: 3px solid var(--accent-gold); border-radius: 6px;';

            let originalContent = '';
            if (messageType === 'text') {
                originalContent = `<div style="color: var(--text-white);">${messageText}</div>`;
            } else if (messageType === 'voice') {
                originalContent = `
                    <div style="color: var(--text-gray); margin-bottom: 8px;"> Voice Message</div>
                    <audio controls style="width: 100%; height: 30px;">
                        <source src="${audioUrl}" type="audio/wav">
                    </audio>
                `;
            }

            originalMsg.innerHTML = `
                <div style="color: var(--text-gray); font-size: 0.8em; margin-bottom: 5px;"> ${senderUsername}</div>
                ${originalContent}
            `;
            thread.appendChild(originalMsg);

            // Load all messages in conversation between these two users
            db.collection('players').doc(playerId).collection('cardMessages')
                .orderBy('timestamp', 'asc')
                .onSnapshot(snapshot => {
                    // Clear and rebuild thread (keep original message)
                    const originalElement = thread.querySelector('div:first-child');
                    thread.innerHTML = '';
                    thread.appendChild(originalElement);

                    // Load all messages
                    snapshot.forEach(doc => {
                        const msg = doc.data();
                        // Only show messages between these two users
                        if ((msg.senderId === senderId && msg.senderUsername === senderUsername) ||
                            (msg.senderId === userId)) {
                            displayConversationMessage(thread, msg, userId, senderId);
                        }
                    });

                    // Auto scroll to bottom
                    thread.scrollTop = thread.scrollHeight;
                });
        }

        function displayConversationMessage(thread, msg, userId, senderId) {
            const isCurrentUser = msg.senderId === userId;
            let msgDiv = document.createElement('div');

            if (isCurrentUser) {
                // Current user's message (RIGHT side - green)
                msgDiv.style.cssText = 'margin-top: 12px; margin-left: auto; margin-right: 0; padding: 12px; background: rgba(0,255,136,0.15); border-left: none; border-right: 3px solid var(--accent-green); border-radius: 6px; max-width: 70%; text-align: right;';
                msgDiv.innerHTML = `<div style="color: var(--accent-green); font-size: 0.8em; margin-bottom: 5px;"> You</div>`;
            } else {
                // Other user's message (LEFT side - gold)
                msgDiv.style.cssText = 'margin-top: 12px; margin-left: 0; margin-right: auto; padding: 12px; background: rgba(255,215,0,0.12); border-left: 3px solid var(--accent-gold); border-right: none; border-radius: 6px; max-width: 70%;';
                msgDiv.innerHTML = `<div style="color: var(--text-gray); font-size: 0.8em; margin-bottom: 5px;"> ${msg.senderUsername}</div>`;
            }

            // Show quoted reply if exists
            if (msg.replyTo) {
                msgDiv.innerHTML += `
                    <div style="margin-bottom: 8px; padding: 8px; background: rgba(255,215,0,0.08); border-left: 2px solid rgba(255,215,0,0.5); border-radius: 4px; font-size: 0.85em; color: var(--text-gray);">
                         Replying to ${msg.replyToUsername}
                    </div>
                `;
            }

            if (msg.type === 'text') {
                msgDiv.innerHTML += `<div style="color: var(--text-white);">${msg.text}</div>`;
            } else if (msg.type === 'voice') {
                msgDiv.innerHTML += `
                    <div style="color: var(--text-gray); margin-bottom: 8px;"> Voice</div>
                    <audio controls style="width: 100%; height: 28px;">
                        <source src="${msg.audioUrl}" type="audio/wav">
                    </audio>
                `;
            }

            // Add reply button for received messages
            if (!isCurrentUser && msg.type === 'text') {
                msgDiv.innerHTML += `
                    <button onclick="quoteReply('${msg.text.replace(/'/g, "\\'")}', '${msg.senderUsername.replace(/'/g, "\\'")}', '${msg.senderId}')" 
                            style="margin-top: 8px; padding: 6px 12px; background: rgba(255,215,0,0.15); border: 1px solid rgba(255,215,0,0.3); color: var(--accent-gold); border-radius: 6px; cursor: pointer; font-size: 0.8em; transition: all 0.3s ease;"
                            onmouseover="this.style.background='rgba(255,215,0,0.25)'; this.style.borderColor='var(--accent-gold)';"
                            onmouseout="this.style.background='rgba(255,215,0,0.15)'; this.style.borderColor='rgba(255,215,0,0.3)';">
                         Quote Reply
                    </button>
                `;
            }

            thread.appendChild(msgDiv);
        }

        function quoteReply(messageText, senderName, senderId) {
            const input = document.getElementById('replyMessageInput');
            const quotedText = `> ${senderName}: ${messageText}\n\n`;
            input.value = quotedText + input.value;
            input.focus();
            showToast('Quote added! ', 'success');
        }

        // ===== MESSAGE ACTIONS =====
        function copyMessageToClipboard(messageId, messageText) {
            if (!messageText) {
                showToast('No text to copy', 'warning');
                return;
            }
            navigator.clipboard.writeText(messageText).then(() => {
                showToast('Message copied! ', 'success');
            }).catch(err => {
                console.error('Copy failed:', err);
                showToast('Failed to copy message', 'error');
            });
        }

        function deleteMessage(messageId) {
            if (!confirm('Delete this message?')) {
                return;
            }

            const db = firebase.firestore();
            const playerId = currentCardMessagingPlayerId;
            const userId = auth.currentUser.uid;

            db.collection('players').doc(playerId).collection('cardMessages').doc(messageId).delete()
                .then(() => {
                    showToast('Message deleted ', 'success');
                })
                .catch(err => {
                    console.error('Delete error:', err);
                    showToast('Failed to delete message', 'error');
                });
        }

        function closeReplyModal() {
            document.getElementById('replyModalOverlay').classList.remove('active');

            if (replyIsRecording) {
                replyMediaRecorder?.stop();
                replyIsRecording = false;
            }

            replyAudioChunks = [];
            replyHasVoice = false;
            currentReplyData = {
                senderId: null,
                senderUsername: null,
                messageType: null,
                messageText: null,
                audioUrl: null,
                messageId: null
            };
        }

        async function toggleReplyVoiceRecord() {
            if (!replyIsRecording) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    replyMediaRecorder = new MediaRecorder(stream);
                    replyAudioChunks = [];

                    replyMediaRecorder.ondataavailable = (event) => {
                        replyAudioChunks.push(event.data);
                    };

                    replyMediaRecorder.onstop = () => {
                        replyHasVoice = true;
                        showToast('Voice note recorded! ', 'success');
                    };

                    replyMediaRecorder.start();
                    replyIsRecording = true;
                    document.getElementById('replyVoiceBtn').classList.add('recording');
                    document.getElementById('replyVoiceBtnText').textContent = 'Stop';
                    document.getElementById('replyVoiceIndicator').classList.add('active');
                    showToast('Recording...', 'info');
                } catch (err) {
                    console.error('Microphone error:', err);
                    showToast('Microphone access denied', 'error');
                }
            } else {
                replyMediaRecorder.stop();
                replyIsRecording = false;
                document.getElementById('replyVoiceBtn').classList.remove('recording');
                document.getElementById('replyVoiceBtnText').textContent = 'Voice';
                document.getElementById('replyVoiceIndicator').classList.remove('active');
            }
        }

        async function sendReplyMessage() {
            const messageText = document.getElementById('replyMessageInput').value.trim();

            if (!messageText && !replyHasVoice) {
                showToast('Type a message or record voice', 'warning');
                return;
            }

            const db = firebase.firestore();
            const userId = auth.currentUser.uid;
            const playerId = currentCardMessagingPlayerId;

            try {
                const senderDoc = await db.collection('players').doc(userId).get();
                const senderUsername = senderDoc.exists ? senderDoc.data().realName : 'Unknown User';

                // Handle voice
                if (replyHasVoice && replyAudioChunks.length > 0) {
                    const audioBlob = new Blob(replyAudioChunks, { type: 'audio/wav' });
                    const formData = new FormData();
                    formData.append('file', audioBlob);
                    formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);

                    const response = await fetch(CLOUDINARY_API_URL, { method: 'POST', body: formData });
                    const result = await response.json();

                    if (result.secure_url) {
                        // Save voice to both collections
                        await db.collection('players').doc(playerId).collection('cardMessages').add({
                            senderId: userId,
                            senderUsername: senderUsername,
                            type: 'voice',
                            audioUrl: result.secure_url,
                            timestamp: firebase.firestore.Timestamp.now()
                        });

                        await db.collection('players').doc(currentReplyData.senderId).collection('cardMessages').add({
                            senderId: userId,
                            senderUsername: senderUsername,
                            type: 'voice',
                            audioUrl: result.secure_url,
                            timestamp: firebase.firestore.Timestamp.now()
                        });

                        // Display in conversation
                        displayReplyMessage(senderUsername, 'voice', result.secure_url);
                    }
                }

                // Handle text
                if (messageText) {
                    await db.collection('players').doc(playerId).collection('cardMessages').add({
                        senderId: userId,
                        senderUsername: senderUsername,
                        type: 'text',
                        text: messageText,
                        timestamp: firebase.firestore.Timestamp.now()
                    });

                    await db.collection('players').doc(currentReplyData.senderId).collection('cardMessages').add({
                        senderId: userId,
                        senderUsername: senderUsername,
                        type: 'text',
                        text: messageText,
                        timestamp: firebase.firestore.Timestamp.now()
                    });

                    // Display in conversation
                    displayReplyMessage(senderUsername, 'text', messageText);
                }

                // Clear and show success
                document.getElementById('replyMessageInput').value = '';
                replyAudioChunks = [];
                replyHasVoice = false;
                document.getElementById('replyVoiceBtn').classList.remove('recording');
                document.getElementById('replyVoiceBtnText').textContent = 'Voice';
                document.getElementById('replyVoiceIndicator').classList.remove('active');

                showToast('Message sent! ', 'success');
                loadCardMessages(playerId);

            } catch (err) {
                console.error('Error sending reply:', err);
                showToast('Error: ' + err.message, 'error');
            }
        }

        function displayReplyMessage(username, type, content) {
            const thread = document.getElementById('replyConversationThread');
            let replyMsg = document.createElement('div');
            replyMsg.style.cssText = 'margin-top: 15px; padding: 12px; background: rgba(0,255,136,0.1); border-left: 3px solid var(--accent-green); border-radius: 6px;';

            let content_html = '';
            if (type === 'text') {
                content_html = `<div style="color: var(--text-white);">${content}</div>`;
            } else if (type === 'voice') {
                content_html = `
                    <div style="color: var(--text-gray); margin-bottom: 8px;"> Your Voice</div>
                    <audio controls style="width: 100%; height: 30px;">
                        <source src="${content}" type="audio/wav">
                    </audio>
                `;
            }

            replyMsg.innerHTML = `
                <div style="color: var(--accent-green); font-size: 0.8em; margin-bottom: 5px;"> You</div>
                ${content_html}
            `;

            thread.appendChild(replyMsg);
            thread.scrollTop = thread.scrollHeight;
        }

        // ===== EMOJI & STICKER FUNCTIONS =====
        function toggleEmojiPicker() {
            const picker = document.getElementById('emojiPicker');
            const sticker = document.getElementById('stickerPicker');
            sticker.classList.remove('active');

            if (!picker.classList.contains('active')) {
                picker.classList.add('active');
                initializeEmojiPicker();
            } else {
                picker.classList.remove('active');
            }
        }

        function toggleStickerPicker() {
            const picker = document.getElementById('stickerPicker');
            const emoji = document.getElementById('emojiPicker');
            emoji.classList.remove('active');

            picker.classList.toggle('active');
            if (picker.classList.contains('active')) {
                initializeStickerPicker();
            }
        }

        function initializeEmojiPicker() {
            const picker = document.getElementById('emojiPicker');
            const emojis = [
                '',
                '',
                '',
                '',
                '',
                '',
                '',
                ''
            ];

            let html = '';
            emojis.forEach(group => {
                group.split('').forEach(emoji => {
                    html += `<span onclick="insertEmoji('${emoji}')" style="font-size: 1.8em; cursor: pointer; padding: 8px; display: inline-block; border-radius: 6px; transition: all 0.2s; background: rgba(255,215,0,0.1);" onmouseover="this.style.background='rgba(255,215,0,0.2)'; this.style.transform='scale(1.2)'" onmouseout="this.style.transform='scale(1)'">${emoji}</span>`;
                });
            });

            picker.innerHTML = html;
        }

        function initializeStickerPicker() {
            const picker = document.getElementById('stickerPicker');
            const stickers = [
                '', '', '', '', '', '',
                '', '', '', '', '', '',
                '', '', '', '', '', '',
                '', '', '', '', '', ''
            ];

            let html = '';
            stickers.forEach(sticker => {
                html += `<div class="sticker-item" onclick="insertEmoji('${sticker}')">${sticker}</div>`;
            });

            picker.innerHTML = html;
        }

        function insertEmoji(emoji) {
            const input = document.getElementById('replyMessageInput');
            input.value += emoji;
            input.focus();
        }

        function openPlayerAdvancedAnalysis(playerId) {
            const db = firebase.firestore();
            const isOwner = playerId === auth.currentUser?.uid;

            db.collection('players').doc(playerId).get().then(doc => {
                if (doc.exists) {
                    const player = doc.data();
                    showAdvancedAnalysisModal(playerId, player, isOwner);
                }
            }).catch(err => console.error('Error loading player analysis:', err));
        }

        function showAdvancedAnalysisModal(playerId, playerData, isOwner) {
            const existingModal = document.getElementById('advancedAnalysisModal');
            if (existingModal) existingModal.remove();

            const modal = document.createElement('div');
            modal.id = 'advancedAnalysisModal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.95);
                z-index: 9600;
                display: flex;
                justify-content: center;
                align-items: center;
                overflow-y: auto;
                padding: 20px;
            `;

            const records = playerData.records || [];
            const advancedStats = playerData.advancedStats || {};

            modal.innerHTML = `
                <div style="
                    background: var(--primary-dark);
                    border: 3px solid rgba(255, 215, 0, 0.5);
                    border-radius: 20px;
                    max-width: 800px;
                    width: 100%;
                    max-height: 90vh;
                    overflow-y: auto;
                    padding: 30px;
                    box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
                ">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h2 style="color: var(--accent-gold); margin: 0; font-size: 1.5em;">${playerData.realName} - Advanced Analysis</h2>
                        <button onclick="closeAdvancedAnalysisModal()" style="
                            font-size: 2em;
                            cursor: pointer;
                            color: var(--text-gray);
                            background: none;
                            border: none;
                            transition: all 0.3s ease;
                        " onmouseover="this.style.color='var(--accent-gold)'" onmouseout="this.style.color='var(--text-gray)'"></button>
                    </div>

                    <!-- Advanced Stats Section -->
                    <div style="background: rgba(255, 215, 0, 0.08); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: var(--accent-gold); margin-top: 0;"> Advanced Statistics</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div style="background: rgba(255, 215, 0, 0.1); padding: 12px; border-radius: 8px;">
                                <div style="color: var(--text-gray); font-size: 0.9em; margin-bottom: 5px;">Assists</div>
                                <div style="color: var(--accent-gold); font-size: 1.5em; font-weight: 900;">${advancedStats.assists || '-'}</div>
                            </div>
                            <div style="background: rgba(255, 215, 0, 0.1); padding: 12px; border-radius: 8px;">
                                <div style="color: var(--text-gray); font-size: 0.9em; margin-bottom: 5px;">Goals</div>
                                <div style="color: var(--accent-gold); font-size: 1.5em; font-weight: 900;">${advancedStats.goals || '-'}</div>
                            </div>
                            <div style="background: rgba(255, 215, 0, 0.1); padding: 12px; border-radius: 8px;">
                                <div style="color: var(--text-gray); font-size: 0.9em; margin-bottom: 5px;">Avg Rating per Match</div>
                                <div style="color: var(--accent-gold); font-size: 1.5em; font-weight: 900;">${advancedStats.avgRating || '-'}</div>
                            </div>
                            <div style="background: rgba(255, 215, 0, 0.1); padding: 12px; border-radius: 8px;">
                                <div style="color: var(--text-gray); font-size: 0.9em; margin-bottom: 5px;">Matches Played</div>
                                <div style="color: var(--accent-gold); font-size: 1.5em; font-weight: 900;">${advancedStats.matchesPlayed || '-'}</div>
                            </div>
                        </div>
                        ${isOwner ? `
                            <button onclick="openEditAdvancedAnalysis('${playerId}')" style="
                                margin-top: 15px;
                                padding: 10px 20px;
                                background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
                                border: none;
                                color: var(--primary-dark);
                                border-radius: 8px;
                                font-weight: 700;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                                <i class="fas fa-edit"></i> Edit Statistics
                            </button>
                        ` : ''}
                    </div>

                    <!-- Records Section -->
                    <div style="background: rgba(0, 255, 136, 0.08); border-radius: 12px; padding: 20px;">
                        <h3 style="color: var(--accent-green); margin-top: 0;"> Match Records & Highlights</h3>
                        ${records.length > 0 ? `
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                                ${records.map((record, idx) => `
                                    <div style="background: rgba(0, 255, 136, 0.1); border-radius: 8px; overflow: hidden; border: 1px solid rgba(0, 255, 136, 0.3); transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(0, 255, 136, 0.2)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                                        <!-- Picture Thumbnail -->
                                        ${record.pictureUrl ? `
                                            <div style="width: 100%; height: 150px; overflow: hidden; background: rgba(0, 0, 0, 0.5);">
                                                <img src="${record.pictureUrl}" alt="${record.title}" style="width: 100%; height: 100%; object-fit: cover;">
                                            </div>
                                        ` : record.videoUrl ? `
                                            <div style="width: 100%; height: 150px; background: linear-gradient(135deg, rgba(0, 255, 136, 0.2), rgba(255, 215, 0, 0.1)); display: flex; align-items: center; justify-content: center; color: var(--accent-green); font-size: 3em;"></div>
                                        ` : `
                                            <div style="width: 100%; height: 150px; background: rgba(0, 255, 136, 0.1); display: flex; align-items: center; justify-content: center; color: var(--accent-green); font-size: 2em;"></div>
                                        `}
                                        
                                        <!-- Record Info -->
                                        <div style="padding: 12px; position: relative;">
                                            <!-- Delete Button -->
                                            ${isOwner ? `
                                                <button onclick="deleteMatchRecord('${playerId}', '${record.id}')" style="
                                                    position: absolute;
                                                    top: 8px;
                                                    right: 8px;
                                                    width: 28px;
                                                    height: 28px;
                                                    background: rgba(255, 75, 75, 0.8);
                                                    border: none;
                                                    color: white;
                                                    border-radius: 50%;
                                                    cursor: pointer;
                                                    font-size: 0.9em;
                                                    display: flex;
                                                    align-items: center;
                                                    justify-content: center;
                                                    transition: all 0.3s ease;
                                                    font-weight: 700;
                                                    z-index: 10;
                                                " onmouseover="this.style.background='rgba(255, 50, 50, 1)'; this.style.transform='scale(1.1)'" onmouseout="this.style.background='rgba(255, 75, 75, 0.8)'; this.style.transform='scale(1)'">
                                                    
                                                </button>
                                            ` : ''}
                                            
                                            <div style="color: var(--accent-gold); font-weight: 700; font-size: 0.95em; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding-right: ${isOwner ? '30px' : '0'};">${record.title || 'Match Record'}</div>
                                            <div style="color: var(--text-gray); font-size: 0.8em; line-height: 1.3; margin-bottom: 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">${record.description || 'No description'}</div>
                                            <div style="font-size: 0.75em; color: var(--text-gray);">
                                                ${record.date ? ` ${record.date}` : ''}
                                                ${record.category ? `  ${record.category}` : ''}
                                            </div>
                                            ${record.videoUrl ? `
                                                <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(0, 255, 136, 0.2); display: flex; gap: 6px;">
                                                    <button onclick="openHighlightFromRecord('${record.videoUrl}', '${record.title}')" style="
                                                        flex: 1;
                                                        padding: 6px;
                                                        background: rgba(0, 255, 136, 0.2);
                                                        border: 1px solid rgba(0, 255, 136, 0.4);
                                                        color: var(--accent-green);
                                                        border-radius: 4px;
                                                        cursor: pointer;
                                                        font-size: 0.8em;
                                                        font-weight: 600;
                                                    "> Watch Video</button>
                                                </div>
                                            ` : ''}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <div style="color: var(--text-gray); text-align: center; padding: 30px; font-size: 0.95em;">No records added yet. Start by adding your first match moment!</div>
                        `}
                        ${isOwner ? `
                            <button onclick="openAddRecordForm('${playerId}')" style="
                                width: 100%;
                                margin-top: 15px;
                                padding: 12px 20px;
                                background: linear-gradient(135deg, rgba(0, 255, 136, 0.2), rgba(255, 215, 0, 0.1));
                                border: 2px solid rgba(0, 255, 136, 0.3);
                                color: var(--accent-green);
                                border-radius: 8px;
                                font-weight: 700;
                                cursor: pointer;
                                transition: all 0.3s ease;
                                font-size: 0.95em;
                            " onmouseover="this.style.background='rgba(0, 255, 136, 0.3)'; this.style.transform='translateY(-2px)'" onmouseout="this.style.background='rgba(0, 255, 136, 0.2)'; this.style.transform='translateY(0)'">
                                <i class="fas fa-plus"></i> Add New Record
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function closeAdvancedAnalysisModal() {
            const modal = document.getElementById('advancedAnalysisModal');
            if (modal) modal.remove();
        }

        function openEditAdvancedAnalysis(playerId) {
            closeAdvancedAnalysisModal();

            const form = document.createElement('div');
            form.innerHTML = `
                <div style="
                    background: var(--primary-dark);
                    border: 3px solid rgba(255, 215, 0, 0.5);
                    border-radius: 15px;
                    padding: 30px;
                    max-width: 500px;
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    z-index: 9800;
                    box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
                    max-height: 85vh;
                    overflow-y: auto;
                ">
                    <h3 style="color: var(--accent-gold); margin-top: 0; margin-bottom: 25px;"> Edit Advanced Statistics</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="color: var(--text-gray); font-size: 0.9em; font-weight: 600; display: block; margin-bottom: 8px;"> Goals Scored</label>
                        <input type="number" id="editGoals" placeholder="0" min="0" style="
                            width: 100%;
                            padding: 12px;
                            background: rgba(255, 215, 0, 0.08);
                            border: 2px solid rgba(255, 215, 0, 0.3);
                            color: var(--text-white);
                            border-radius: 8px;
                            box-sizing: border-box;
                            font-size: 1em;
                        ">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="color: var(--text-gray); font-size: 0.9em; font-weight: 600; display: block; margin-bottom: 8px;"> Assists</label>
                        <input type="number" id="editAssists" placeholder="0" min="0" style="
                            width: 100%;
                            padding: 12px;
                            background: rgba(255, 215, 0, 0.08);
                            border: 2px solid rgba(255, 215, 0, 0.3);
                            color: var(--text-white);
                            border-radius: 8px;
                            box-sizing: border-box;
                            font-size: 1em;
                        ">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="color: var(--text-gray); font-size: 0.9em; font-weight: 600; display: block; margin-bottom: 8px;"> Matches Played</label>
                        <input type="number" id="editMatchesPlayed" placeholder="0" min="0" style="
                            width: 100%;
                            padding: 12px;
                            background: rgba(255, 215, 0, 0.08);
                            border: 2px solid rgba(255, 215, 0, 0.3);
                            color: var(--text-white);
                            border-radius: 8px;
                            box-sizing: border-box;
                            font-size: 1em;
                        ">
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <label style="color: var(--text-gray); font-size: 0.9em; font-weight: 600; display: block; margin-bottom: 8px;"> Average Rating per Match</label>
                        <input type="number" id="editAvgRating" placeholder="0.0" min="0" max="10" step="0.1" style="
                            width: 100%;
                            padding: 12px;
                            background: rgba(255, 215, 0, 0.08);
                            border: 2px solid rgba(255, 215, 0, 0.3);
                            color: var(--text-white);
                            border-radius: 8px;
                            box-sizing: border-box;
                            font-size: 1em;
                        ">
                    </div>
                    
                    <div style="display: flex; gap: 12px; margin-top: 25px;">
                        <button onclick="saveAdvancedStats('${playerId}')" style="
                            flex: 1;
                            padding: 14px;
                            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
                            border: none;
                            color: var(--primary-dark);
                            border-radius: 8px;
                            font-weight: 700;
                            cursor: pointer;
                            transition: all 0.3s ease;
                            font-size: 0.95em;
                        " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 20px rgba(255, 215, 0, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                             Save Statistics
                        </button>
                        <button onclick="closeEditStatsForm()" style="
                            flex: 1;
                            padding: 14px;
                            background: rgba(255, 215, 0, 0.1);
                            border: 2px solid rgba(255, 215, 0, 0.3);
                            color: var(--accent-gold);
                            border-radius: 8px;
                            font-weight: 700;
                            cursor: pointer;
                            transition: all 0.3s ease;
                            font-size: 0.95em;
                        ">
                             Cancel
                        </button>
                    </div>
                </div>
                <div onclick="closeEditStatsForm()" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: transparent;
                    z-index: 9750;
                "></div>
            `;

            document.body.appendChild(form);

            // Load current stats
            const db = firebase.firestore();
            db.collection('players').doc(playerId).get().then(doc => {
                if (doc.exists) {
                    const advancedStats = doc.data().advancedStats || {};
                    document.getElementById('editGoals').value = advancedStats.goals || '';
                    document.getElementById('editAssists').value = advancedStats.assists || '';
                    document.getElementById('editMatchesPlayed').value = advancedStats.matchesPlayed || '';
                    document.getElementById('editAvgRating').value = advancedStats.avgRating || '';
                }
            });
        }

        function closeEditStatsForm() {
            const forms = document.querySelectorAll('[style*="position: fixed"]');
            forms.forEach(f => {
                if (f.style.zIndex === '9800' || f.style.zIndex === '9750') {
                    f.remove();
                }
            });
        }

        async function saveAdvancedStats(playerId) {
            const goals = document.getElementById('editGoals')?.value || '';
            const assists = document.getElementById('editAssists')?.value || '';
            const matchesPlayed = document.getElementById('editMatchesPlayed')?.value || '';
            const avgRating = document.getElementById('editAvgRating')?.value || '';

            if (!goals && !assists && !matchesPlayed && !avgRating) {
                showToast('Please fill in at least one field', 'warning');
                return;
            }

            try {
                showToast('Saving statistics...', 'info');

                const db = firebase.firestore();
                const playerDoc = await db.collection('players').doc(playerId).get();

                const advancedStats = playerDoc.data().advancedStats || {};

                // Update fields
                if (goals) advancedStats.goals = parseInt(goals) || 0;
                if (assists) advancedStats.assists = parseInt(assists) || 0;
                if (matchesPlayed) advancedStats.matchesPlayed = parseInt(matchesPlayed) || 0;
                if (avgRating) advancedStats.avgRating = parseFloat(avgRating) || 0;

                // Save to Firebase
                await db.collection('players').doc(playerId).update({ advancedStats });

                showToast('Statistics updated successfully! ', 'success');
                closeEditStatsForm();

                // Reopen advanced analysis to show updated stats
                setTimeout(() => {
                    openPlayerAdvancedAnalysis(playerId);
                }, 500);
            } catch (err) {
                console.error('Error saving stats:', err);
                showToast('Error saving statistics: ' + err.message, 'error');
            }
        }

        function openAddRecordForm(playerId) {
            const modal = document.getElementById('advancedAnalysisModal');
            if (!modal) return;

            const form = document.createElement('div');
            form.innerHTML = `
                <div style="
                    background: var(--primary-dark);
                    border: 3px solid rgba(255, 215, 0, 0.5);
                    border-radius: 15px;
                    padding: 25px;
                    max-width: 550px;
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    z-index: 9700;
                    box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
                    max-height: 85vh;
                    overflow-y: auto;
                ">
                    <h3 style="color: var(--accent-gold); margin-top: 0; margin-bottom: 20px;">Add Match Record</h3>
                    
                    <input type="text" placeholder="Record Title (e.g., First Goal, Hat-trick)" id="recordTitle" style="
                        width: 100%;
                        padding: 10px;
                        margin: 10px 0;
                        background: rgba(255, 215, 0, 0.08);
                        border: 1px solid rgba(255, 215, 0, 0.3);
                        color: var(--text-white);
                        border-radius: 6px;
                        box-sizing: border-box;
                    ">
                    
                    <textarea placeholder="Record Description" id="recordDescription" style="
                        width: 100%;
                        padding: 10px;
                        margin: 10px 0;
                        background: rgba(255, 215, 0, 0.08);
                        border: 1px solid rgba(255, 215, 0, 0.3);
                        color: var(--text-white);
                        border-radius: 6px;
                        box-sizing: border-box;
                        resize: vertical;
                        min-height: 80px;
                    "></textarea>
                    
                    <input type="date" id="recordDate" style="
                        width: 100%;
                        padding: 10px;
                        margin: 10px 0;
                        background: rgba(255, 215, 0, 0.08);
                        border: 1px solid rgba(255, 215, 0, 0.3);
                        color: var(--text-white);
                        border-radius: 6px;
                        box-sizing: border-box;
                    ">
                    
                    <!-- Picture Upload Section -->
                    <div style="
                        margin: 15px 0;
                        padding: 15px;
                        background: rgba(255, 215, 0, 0.08);
                        border: 2px dashed rgba(255, 215, 0, 0.3);
                        border-radius: 8px;
                        text-align: center;
                    ">
                        <div style="color: var(--text-gray); font-size: 0.9em; margin-bottom: 10px;"> Upload Match Photo</div>
                        <input type="file" id="recordPictureInput" accept="image/*" style="
                            display: none;
                        ">
                        <button onclick="document.getElementById('recordPictureInput').click()" style="
                            padding: 8px 15px;
                            background: rgba(255, 215, 0, 0.15);
                            border: 1px solid rgba(255, 215, 0, 0.3);
                            color: var(--accent-gold);
                            border-radius: 6px;
                            font-weight: 600;
                            cursor: pointer;
                            font-size: 0.85em;
                        ">Choose Image</button>
                        <div id="recordPicturePreview" style="
                            margin-top: 10px;
                            max-width: 100%;
                            max-height: 150px;
                        "></div>
                    </div>
                    
                    <!-- Highlight Video Section -->
                    <div style="
                        margin: 15px 0;
                        padding: 15px;
                        background: rgba(0, 255, 136, 0.08);
                        border: 1px solid rgba(0, 255, 136, 0.3);
                        border-radius: 8px;
                    ">
                        <div style="color: var(--accent-green); font-weight: 600; font-size: 0.9em; margin-bottom: 10px;"> Add Highlight Video</div>
                        <input type="text" placeholder="YouTube Video URL (https://youtu.be/...)" id="recordVideoUrl" style="
                            width: 100%;
                            padding: 10px;
                            margin: 5px 0;
                            background: rgba(255, 215, 0, 0.08);
                            border: 1px solid rgba(255, 215, 0, 0.3);
                            color: var(--text-white);
                            border-radius: 6px;
                            box-sizing: border-box;
                        ">
                        <select id="recordCategory" style="
                            width: 100%;
                            padding: 10px;
                            margin: 5px 0;
                            background: rgba(255, 215, 0, 0.08);
                            border: 1px solid rgba(255, 215, 0, 0.3);
                            color: var(--text-white);
                            border-radius: 6px;
                            box-sizing: border-box;
                        ">
                            <option value="goals" style="color: #000;"> Goals</option>
                            <option value="skills" style="color: #000;"> Skills</option>
                            <option value="saves" style="color: #000;"> Saves</option>
                            <option value="best" style="color: #000;"> Best Moments</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button onclick="savePlayerRecord('${playerId}')" style="
                            flex: 1;
                            padding: 12px;
                            background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
                            border: none;
                            color: var(--primary-dark);
                            border-radius: 6px;
                            font-weight: 700;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        " onmouseover="this.transform='scale(1.05)'" onmouseout="this.transform='scale(1)'">Save Record</button>
                        <button onclick="closeRecordForm()" style="
                            flex: 1;
                            padding: 12px;
                            background: rgba(255, 215, 0, 0.1);
                            border: 2px solid rgba(255, 215, 0, 0.3);
                            color: var(--accent-gold);
                            border-radius: 6px;
                            font-weight: 700;
                            cursor: pointer;
                        ">Cancel</button>
                    </div>
                </div>
                <div onclick="closeRecordForm()" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: transparent;
                    z-index: 9650;
                "></div>
            `;
            document.body.appendChild(form);

            // Add picture preview handler
            document.getElementById('recordPictureInput').addEventListener('change', function (e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (event) {
                        const preview = document.getElementById('recordPicturePreview');
                        preview.innerHTML = `<img src="${event.target.result}" style="max-width: 100%; max-height: 150px; border-radius: 6px; border: 2px solid rgba(255, 215, 0, 0.3);">`;
                        preview.setAttribute('data-file', 'loaded');
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        function closeRecordForm() {
            const forms = document.querySelectorAll('[style*="position: fixed"]');
            forms.forEach(f => {
                if (f.style.zIndex === '9700') f.remove();
                if (f.style.zIndex === '9650') f.remove();
            });
        }

        async function savePlayerRecord(playerId) {
            const title = document.getElementById('recordTitle')?.value || '';
            const description = document.getElementById('recordDescription')?.value || '';
            const date = document.getElementById('recordDate')?.value || '';
            const pictureInput = document.getElementById('recordPictureInput');
            const videoUrl = document.getElementById('recordVideoUrl')?.value || '';
            const category = document.getElementById('recordCategory')?.value || 'best';

            if (!title || !description) {
                showToast('Please fill in all fields', 'warning');
                return;
            }

            showToast('Saving record...', 'info');

            try {
                const db = firebase.firestore();
                const playerDoc = await db.collection('players').doc(playerId).get();
                const records = playerDoc.data()?.records || [];

                // Create new record object
                const newRecord = {
                    id: Date.now().toString(),
                    title,
                    description,
                    date,
                    timestamp: new Date(),
                    category
                };

                // Upload picture to Cloudinary if selected
                if (pictureInput.files && pictureInput.files[0]) {
                    showToast('Uploading photo...', 'info');
                    const formData = new FormData();
                    formData.append('file', pictureInput.files[0]);
                    formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);

                    const cloudinaryResponse = await fetch(CLOUDINARY_API_URL, {
                        method: 'POST',
                        body: formData
                    });

                    if (cloudinaryResponse.ok) {
                        const result = await cloudinaryResponse.json();
                        newRecord.pictureUrl = result.secure_url;
                    }
                }

                // Add video highlight if provided
                if (videoUrl) {
                    newRecord.videoUrl = videoUrl;
                    // Also add to highlights collection in Firebase
                    const highlightId = Date.now().toString();
                    await db.collection('highlights').doc(highlightId).set({
                        title: title,
                        category: category,
                        videoUrl: videoUrl,
                        playerId: playerId,
                        date: date,
                        timestamp: new Date(),
                        likes: 0,
                        shares: 0
                    });
                    newRecord.highlightId = highlightId;
                }

                // Save record to Firebase
                records.push(newRecord);
                await db.collection('players').doc(playerId).update({ records });

                showToast('Record saved successfully! ', 'success');
                closeRecordForm();
                openPlayerAdvancedAnalysis(playerId);
            } catch (err) {
                console.error('Error saving record:', err);
                showToast('Error saving record: ' + err.message, 'error');
            }
        }

        function openHighlightFromRecord(videoUrl, title) {
            const highlight = {
                id: Date.now(),
                title: title,
                videoUrl: videoUrl,
                category: 'best'
            };
            openHighlightViewer(highlight);
        }

        async function deleteMatchRecord(playerId, recordId) {
            // Confirm deletion
            if (!confirm('Are you sure you want to delete this match record? This action cannot be undone.')) {
                return;
            }

            try {
                showToast('Deleting record...', 'info');

                const db = firebase.firestore();
                const playerDoc = await db.collection('players').doc(playerId).get();
                let records = playerDoc.data()?.records || [];

                // Find and remove the record
                records = records.filter(r => r.id !== recordId);

                // Update Firebase
                await db.collection('players').doc(playerId).update({ records });

                showToast('Match record deleted successfully! ', 'success');

                // Refresh the advanced analysis modal
                setTimeout(() => {
                    openPlayerAdvancedAnalysis(playerId);
                }, 500);
            } catch (err) {
                console.error('Error deleting record:', err);
                showToast('Error deleting record: ' + err.message, 'error');
            }
        }

        // ===== MESSAGING SYSTEM =====


        // ===== RATING SYSTEM =====

        function openPlayerEditFromDetails(playerId) {
            closePlayerDetailsModal();
            const db = firebase.firestore();
            db.collection('players').doc(playerId).get().then(doc => {
                if (doc.exists) {
                    playerRegistrationData = doc.data();
                    currentUserId = playerId;
                    openPlayerEditModal();
                }
            }).catch(err => console.error('Error loading player for edit:', err));
        }

        function openPlayerRatingPopup(playerId) {
            const existingPopup = document.getElementById('playerRatingPopup');
            if (existingPopup) existingPopup.remove();

            const popup = document.createElement('div');
            popup.id = 'playerRatingPopup';
            popup.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: var(--primary-dark);
                border: 3px solid rgba(255, 215, 0, 0.5);
                border-radius: 15px;
                padding: 30px;
                width: 90%;
                max-width: 400px;
                z-index: 10000;
                box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
                text-align: center;
            `;

            let starRating = 0;

            popup.innerHTML = `
                <h3 style="color: var(--accent-gold); margin-bottom: 20px; font-size: 1.3em;">Rate this Player</h3>
                <div style="font-size: 3em; margin: 20px 0; cursor: pointer;" id="starContainer">
                    <i class="fas fa-star" data-rating="1" style="color: var(--text-gray); margin: 0 5px; cursor: pointer; transition: color 0.2s;"></i>
                    <i class="fas fa-star" data-rating="2" style="color: var(--text-gray); margin: 0 5px; cursor: pointer; transition: color 0.2s;"></i>
                    <i class="fas fa-star" data-rating="3" style="color: var(--text-gray); margin: 0 5px; cursor: pointer; transition: color 0.2s;"></i>
                    <i class="fas fa-star" data-rating="4" style="color: var(--text-gray); margin: 0 5px; cursor: pointer; transition: color 0.2s;"></i>
                    <i class="fas fa-star" data-rating="5" style="color: var(--text-gray); margin: 0 5px; cursor: pointer; transition: color 0.2s;"></i>
                </div>
                <p style="color: var(--text-gray); margin: 15px 0;">You rated: <span id="ratingDisplay" style="color: var(--accent-gold); font-weight: 700; font-size: 1.2em;">0</span> </p>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="submitPlayerRating('${playerId}', starRating)" style="
                        flex: 1;
                        padding: 12px;
                        background: linear-gradient(135deg, var(--accent-gold), #ffed4e);
                        border: none;
                        color: var(--primary-dark);
                        border-radius: 8px;
                        font-weight: 700;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                        Submit Rating
                    </button>
                    <button onclick="closePlayerRatingPopup()" style="
                        flex: 1;
                        padding: 12px;
                        background: rgba(255, 215, 0, 0.1);
                        border: 2px solid rgba(255, 215, 0, 0.3);
                        color: var(--accent-gold);
                        border-radius: 8px;
                        font-weight: 700;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.background='rgba(255, 215, 0, 0.2)'" onmouseout="this.style.background='rgba(255, 215, 0, 0.1)'">
                        Cancel
                    </button>
                </div>
            `;

            document.body.appendChild(popup);

            // Star rating interaction
            const stars = document.querySelectorAll('#starContainer i');
            stars.forEach(star => {
                star.addEventListener('mouseover', function () {
                    const rating = parseInt(this.dataset.rating);
                    stars.forEach((s, i) => {
                        s.style.color = i < rating ? 'var(--accent-gold)' : 'var(--text-gray)';
                    });
                });

                star.addEventListener('click', function () {
                    starRating = parseInt(this.dataset.rating);
                    document.getElementById('ratingDisplay').textContent = starRating;
                    stars.forEach((s, i) => {
                        s.style.color = i < starRating ? 'var(--accent-gold)' : 'var(--text-gray)';
                    });
                });
            });

            document.getElementById('starContainer').addEventListener('mouseleave', function () {
                stars.forEach((s, i) => {
                    s.style.color = i < starRating ? 'var(--accent-gold)' : 'var(--text-gray)';
                });
            });

            // Make submitPlayerRating function accessible
            window.submitPlayerRatingWithId = function (id, rating) {
                submitPlayerRating(id, starRating);
            };

            // Update button onclick
            popup.querySelector('button').onclick = () => submitPlayerRating(playerId, starRating);
        }

        function closePlayerRatingPopup() {
            const popup = document.getElementById('playerRatingPopup');
            if (popup) popup.remove();
        }

        // Generate or retrieve device ID for anonymous ratings
        function getDeviceId() {
            let deviceId = localStorage.getItem('dlsDraftDeviceId');
            if (!deviceId) {
                deviceId = 'device_' + Math.random().toString(36).substr(2, 9) + '_' + Date.now();
                localStorage.setItem('dlsDraftDeviceId', deviceId);
            }
            return deviceId;
        }

        function submitPlayerRating(playerId, rating) {
            if (rating === 0) {
                showToast('Please select a rating', 'warning');
                return;
            }

            const db = firebase.firestore();
            const isAuthenticated = auth.currentUser !== null;
            const deviceId = getDeviceId();

            // For authenticated users: use their UID
            // For anonymous users: use device ID
            const ratingId = isAuthenticated
                ? auth.currentUser.uid + '-' + new Date().getTime()
                : deviceId + '-' + new Date().getTime();

            // Check if user already gave a 5-star rating from this device/account
            const ratingQuery = isAuthenticated
                ? db.collection('players').doc(playerId).collection('ratings').where('userId', '==', auth.currentUser.uid).where('rating', '==', 5)
                : db.collection('players').doc(playerId).collection('ratings').where('deviceId', '==', deviceId).where('rating', '==', 5);

            ratingQuery.get().then(snapshot => {
                if (rating === 5 && snapshot.docs.length > 0) {
                    showToast('You already gave this player a 5-star rating!', 'warning');
                    return;
                }

                const ratingData = {
                    rating: rating,
                    timestamp: new Date().toISOString(),
                    ratedAt: firebase.firestore.FieldValue.serverTimestamp()
                };

                if (isAuthenticated) {
                    ratingData.userId = auth.currentUser.uid;
                    ratingData.userName = auth.currentUser.displayName || auth.currentUser.email || 'Anonymous';
                } else {
                    ratingData.deviceId = deviceId;
                    ratingData.isAnonymous = true;
                }

                db.collection('players').doc(playerId).collection('ratings').doc(ratingId).set(ratingData).then(() => {
                    showToast(`Rating submitted! ${rating}`, 'success');
                    closePlayerRatingPopup();
                    // Refresh the modal
                    viewPlayerDetails(playerId);
                }).catch(err => {
                    console.error('Error submitting rating:', err);
                    showToast('Error submitting rating', 'error');
                });
            }).catch(err => {
                console.error('Error checking existing ratings:', err);
                showToast('Error checking ratings', 'error');
            });
        }

        function updatePlayersRatingSidebarStatus(isRegistered) {
            const sidebar = document.getElementById('playersRatingSidebar');
            if (isRegistered) {
                sidebar.innerHTML = `
                    <button class="edit-card-btn" onclick="openPlayerEditModal()">
                        <i class="fas fa-edit"></i> Edit Card
                    </button>
                    <button class="delete-card-btn" onclick="deletePlayerCard()">
                        <i class="fas fa-trash"></i> Delete Card
                    </button>
                `;
            } else {
                sidebar.innerHTML = `
                    <button class="register-btn" onclick="openPlayerRegistrationModal()">
                        <i class="fas fa-user-plus"></i> Register Yourself
                    </button>
                `;
            }
        }

        function openPlayerEditModal() {
            // Load current player data into form
            populateEditFormWithCurrentData();
            document.getElementById('registrationModalOverlay').classList.add('active');
            // Change button text to indicate edit mode
            const submitBtn = document.querySelector('.form-button');
            if (submitBtn) {
                submitBtn.innerHTML = '<i class="fas fa-save"></i> Update Profile';
                submitBtn.setAttribute('onclick', 'updatePlayerRegistration()');
            }
        }

        function populateEditFormWithCurrentData() {
            // Real Name
            const realNameInput = document.querySelector('input[placeholder="Enter your full real name"]');
            if (realNameInput) realNameInput.value = playerRegistrationData.realName || '';

            // Team Score
            const teamScoreInput = document.querySelector('input[placeholder="e.g., 85"]');
            if (teamScoreInput) teamScoreInput.value = playerRegistrationData.teamScore || '';

            // Time Strength
            const timeStrengthInput = document.querySelector('input[placeholder="e.g., Excellent"]');
            if (timeStrengthInput) timeStrengthInput.value = playerRegistrationData.timeStrength || '';

            // Best Players
            const bestPlayersInput = document.querySelector('input[placeholder="Name your best players (comma separated)"]');
            if (bestPlayersInput) bestPlayersInput.value = playerRegistrationData.bestPlayers || '';

            // Favorite Club
            const favoriteClubInput = document.querySelector('input[placeholder="Your favorite club/cup"]');
            if (favoriteClubInput) favoriteClubInput.value = playerRegistrationData.favoriteClub || '';

            // Win Rate
            const winRateInput = document.querySelector('input[placeholder="e.g., 75%"]');
            if (winRateInput) winRateInput.value = playerRegistrationData.winRate || '';

            // Loss Rate
            const lossRateInput = document.querySelector('input[placeholder="e.g., 25%"]');
            if (lossRateInput) lossRateInput.value = playerRegistrationData.lossRate || '';

            // Update file labels to show current uploads
            if (playerRegistrationData.squadFirst11) {
                document.getElementById('squadFileLabel').textContent = ' Squad image uploaded';
                document.getElementById('squadFileLabel').style.color = 'var(--accent-green)';
            }
            if (playerRegistrationData.substitutions) {
                document.getElementById('substitutionsFileLabel').textContent = ' Substitutions uploaded';
                document.getElementById('substitutionsFileLabel').style.color = 'var(--accent-green)';
            }
            if (playerRegistrationData.playerPicture) {
                document.getElementById('playerPictureFileLabel').textContent = ' Your photo uploaded';
                document.getElementById('playerPictureFileLabel').style.color = 'var(--accent-green)';
            }
            if (playerRegistrationData.dlsLogo) {
                document.getElementById('dlsLogoFileLabel').textContent = ' Team logo uploaded';
                document.getElementById('dlsLogoFileLabel').style.color = 'var(--accent-green)';
            }
            if (playerRegistrationData.clubImage) {
                document.getElementById('clubImageFileLabel').textContent = ' Club image uploaded';
                document.getElementById('clubImageFileLabel').style.color = 'var(--accent-green)';
            }
            if (playerRegistrationData.teamImage) {
                document.getElementById('teamImageFileLabel').textContent = ' Team image uploaded';
                document.getElementById('teamImageFileLabel').style.color = 'var(--accent-green)';
            }
        }

        function updatePlayerRegistration() {
            // Validate required fields
            const requiredFields = ['realName', 'teamScore', 'timeStrength', 'favoriteClub', 'winRate', 'lossRate', 'playerPicture', 'dlsLogo'];
            let missingFields = [];

            requiredFields.forEach(field => {
                if (!playerRegistrationData[field]) {
                    missingFields.push(field);
                }
            });

            if (missingFields.length > 0) {
                showToast('Please fill all required fields', 'warning');
                return;
            }

            const db = firebase.firestore();

            db.collection('players').doc(currentUserId).update(playerRegistrationData).then(() => {
                showToast('Player profile updated successfully!', 'success');
                closePlayerRegistrationModal();
                // Reset form to register mode
                const submitBtn = document.querySelector('.form-button');
                if (submitBtn) {
                    submitBtn.innerHTML = '<i class="fas fa-check"></i> Complete Registration';
                    submitBtn.setAttribute('onclick', 'submitPlayerRegistration()');
                }
            }).catch(err => {
                console.error('Error updating player:', err);
                showToast('Error updating player profile', 'error');
            });
        }

        function deletePlayerCard() {
            if (!confirm('Are you sure you want to delete your player card?')) return;

            const db = firebase.firestore();

            db.collection('players').doc(currentUserId).delete().then(() => {
                showToast('Player card deleted successfully', 'success');
                updatePlayersRatingSidebarStatus(false);
                playerRegistrationData = {};
            }).catch(err => {
                console.error('Error deleting card:', err);
                showToast('Error deleting card', 'error');
            });
        }

        function openPlayerRegistrationModal() {
            document.getElementById('registrationModalOverlay').classList.add('active');
        }

        function closePlayerRegistrationModal() {
            document.getElementById('registrationModalOverlay').classList.remove('active');
            // Reset form and button to default state
            document.getElementById('registrationForm')?.reset?.();
            const submitBtn = document.querySelector('.form-button');
            if (submitBtn) {
                submitBtn.innerHTML = '<i class="fas fa-check"></i> Complete Registration';
                submitBtn.setAttribute('onclick', 'submitPlayerRegistration()');
            }
            // Reset file labels
            const fileLabels = {
                'squadFileLabel': ' Click to upload squad image',
                'substitutionsFileLabel': ' Click to upload substitutions',
                'playerPictureFileLabel': ' Click to upload your photo',
                'dlsLogoFileLabel': ' Click to upload team logo',
                'clubImageFileLabel': ' Click to upload club image',
                'teamImageFileLabel': ' Click to upload team image'
            };
            Object.entries(fileLabels).forEach(([id, text]) => {
                const el = document.getElementById(id);
                if (el) {
                    el.textContent = text;
                    el.style.color = 'var(--text-gray)';
                }
            });
        }

        function uploadPlayerFile(inputId, dataKey) {
            const file = document.getElementById(inputId).files[0];
            if (!file) {
                showToast('Please select a file', 'warning');
                return;
            }

            const labelElement = document.getElementById(inputId + 'Label');
            labelElement.textContent = ' Uploading...';
            labelElement.style.color = 'var(--text-gray)';

            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
            formData.append('tags', `players_rating,${currentUserId || 'guest'}`);
            formData.append('folder', 'players_rating');

            fetch(CLOUDINARY_API_URL, {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    if (data.secure_url) {
                        playerRegistrationData[dataKey] = data.secure_url;
                        labelElement.textContent = ' ' + file.name;
                        labelElement.style.color = 'var(--accent-green)';
                        showToast('Image uploaded successfully', 'success');
                    } else {
                        throw new Error('No URL returned from Cloudinary');
                    }
                })
                .catch(error => {
                    console.error('Upload error:', error);
                    labelElement.textContent = ' Upload failed - try again';
                    labelElement.style.color = '#ff6b6b';
                    showToast('Failed to upload image', 'error');
                });
        }

        function submitPlayerRegistration() {
            // Validate required fields
            const requiredFields = ['realName', 'teamScore', 'timeStrength', 'favoriteClub', 'winRate', 'lossRate', 'playerPicture', 'dlsLogo'];
            let missingFields = [];

            requiredFields.forEach(field => {
                if (!playerRegistrationData[field]) {
                    missingFields.push(field);
                }
            });

            if (missingFields.length > 0) {
                showToast('Please fill all required fields', 'warning');
                return;
            }

            const db = firebase.firestore();

            db.collection('players').doc(currentUserId).set(playerRegistrationData).then(() => {
                showToast('Player registered successfully!', 'success');
                closePlayerRegistrationModal();
                updatePlayersRatingSidebarStatus(true);
            }).catch(err => {
                console.error('Error registering player:', err);
                showToast('Error registering player', 'error');
            });
        }

        function filterHighlights(btn, category) {
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            highlightsCurrentCategory = category;
            renderHighlights();
        }

        function renderHighlights() {
            const container = document.getElementById('highlightsContainer');
            const searchTerm = document.getElementById('highlightsSearchInput')?.value?.toLowerCase() || '';

            let filteredHighlights = sampleHighlights;

            // Filter by category
            if (highlightsCurrentCategory !== 'all') {
                filteredHighlights = filteredHighlights.filter(h => h.category === highlightsCurrentCategory);
            }

            // Filter by search
            if (searchTerm) {
                filteredHighlights = filteredHighlights.filter(h =>
                    h.title.toLowerCase().includes(searchTerm) ||
                    h.team.toLowerCase().includes(searchTerm)
                );
            }

            if (filteredHighlights.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; padding: 40px; text-align: center; color: var(--text-gray);">No highlights found</div>';
                return;
            }

            // Render highlights
            let html = '';
            filteredHighlights.forEach((highlight, index) => {
                // Add mini banner every 5 highlights
                if (index > 0 && index % 5 === 0) {
                    html += `<div class="full-match-mini-banner" style="grid-column: 1/-1;"> Advertisement</div>`;
                }
                html += createHighlightCardHTML(highlight);
            });

            container.innerHTML = html;
        }

        function createHighlightCardHTML(highlight) {
            const categoryEmoji = {
                'goals': '',
                'skills': '',
                'saves': '',
                'best': ''
            };

            return `
                <div class="highlight-card" onclick="watchHighlight('${highlight.videoUrl}', ${highlight.id})">
                    <div class="highlight-thumbnail">
                        ${categoryEmoji[highlight.category]}
                        <div class="highlight-play-btn"></div>
                    </div>
                    <div class="highlight-info">
                        <div class="highlight-title">${highlight.title}</div>
                        <div class="highlight-meta">
                            <span>${highlight.team}</span>
                            <span>${highlight.date}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function watchHighlight(videoUrl, highlightId) {
            // Find the highlight
            const highlight = sampleHighlights.find(h => h.id == highlightId);
            if (!highlight) return;

            // Set current highlight and open viewer
            window.currentViewingHighlight = highlight;
            window.currentViewingHighlight.videoUrl = videoUrl;
            openHighlightViewer(highlight);
        }

        function openHighlightViewer(highlight) {
            document.getElementById('highlightViewerOverlay').classList.add('active');
            populateHighlightViewer(highlight);
        }

        function closeHighlightViewer() {
            document.getElementById('highlightViewerOverlay').classList.remove('active');
        }

        function populateHighlightViewer(highlight) {
            document.getElementById('viewerVideoIframe').src = `https://www.youtube.com/embed/${highlight.videoUrl.split('youtu.be/')[1] || 'dQw4w9WgXcQ'}`;
            document.getElementById('viewerHighlightTitle').textContent = highlight.title;
            document.getElementById('viewerTeamName').textContent = highlight.team;
            document.getElementById('viewerHighlightDate').textContent = highlight.date;

            // Store owner's DLS account for gift payments
            window.currentViewingHighlight.ownerDLSAccount = highlight.ownerDLSAccount || 'DLS40992';

            // Load likes, reactions, and comments from Firebase
            loadHighlightEngagement(highlight.id);
        }

        function loadHighlightEngagement(highlightId) {
            if (!highlightId) return;

            // Load likes
            db.collection('highlights').doc(highlightId.toString()).collection('likes').get()
                .then(snapshot => {
                    const likeCount = snapshot.size;
                    document.getElementById('viewerLikeCount').textContent = likeCount;

                    // Check if current user has liked
                    if (auth.currentUser) {
                        const userLike = snapshot.docs.find(doc => doc.id === auth.currentUser.uid);
                        const btn = document.getElementById('likeBtn');
                        if (userLike) {
                            btn.classList.add('liked');
                            btn.style.background = 'rgba(255, 215, 0, 0.25)';
                            btn.style.color = 'var(--accent-gold)';
                        } else {
                            btn.classList.remove('liked');
                            btn.style.background = 'rgba(255, 215, 0, 0.1)';
                            btn.style.color = 'var(--text-white)';
                        }
                    }
                })
                .catch(err => console.error('Error loading likes:', err));

            // Load reactions
            db.collection('highlights').doc(highlightId.toString()).collection('reactions').get()
                .then(snapshot => {
                    const emojiCounts = {};
                    snapshot.forEach(doc => {
                        const emoji = doc.data().emoji;
                        emojiCounts[emoji] = (emojiCounts[emoji] || 0) + 1;
                    });

                    const reactionsDiv = document.getElementById('emojiReactions');
                    reactionsDiv.innerHTML = '';

                    Object.entries(emojiCounts).forEach(([emoji, count]) => {
                        const span = document.createElement('span');
                        span.style.cssText = 'display: inline-block; margin-right: 8px; padding: 5px 10px; background: rgba(255, 215, 0, 0.1); border-radius: 15px; font-size: 0.9em;';
                        span.textContent = `${emoji} ${count}`;
                        reactionsDiv.appendChild(span);
                    });
                })
                .catch(err => console.error('Error loading reactions:', err));

            // Load comments
            db.collection('highlights').doc(highlightId.toString()).collection('comments')
                .orderBy('createdAt', 'asc')
                .get()
                .then(snapshot => {
                    const commentsDiv = document.getElementById('commentsSection');
                    commentsDiv.innerHTML = '';

                    if (snapshot.empty) {
                        commentsDiv.innerHTML = '<div style="padding: 10px; color: var(--text-gray); text-align: center;">No comments yet</div>';
                    } else {
                        snapshot.forEach(doc => {
                            const commentData = doc.data();
                            const commentDiv = document.createElement('div');
                            commentDiv.className = 'comment-item';
                            commentDiv.innerHTML = `<strong>${commentData.userName}</strong><br>${commentData.text}`;
                            commentsDiv.appendChild(commentDiv);
                        });
                    }
                })
                .catch(err => {
                    console.error('Error loading comments:', err);
                    document.getElementById('commentsSection').innerHTML = '<div style="padding: 10px; color: var(--text-gray); text-align: center;">No comments yet</div>';
                });
        }

        function likeHighlight() {
            const btn = document.getElementById('likeBtn');
            const count = document.getElementById('viewerLikeCount');
            const highlightId = window.currentViewingHighlight?.id;

            if (!highlightId || !auth.currentUser) {
                showToast('Please sign in to like highlights', 'error');
                return;
            }

            const userId = auth.currentUser.uid;
            const isLiked = btn.classList.contains('liked');

            // Toggle local UI
            if (isLiked) {
                btn.classList.remove('liked');
                btn.style.background = 'rgba(255, 215, 0, 0.1)';
                btn.style.color = 'var(--text-white)';
                count.textContent = parseInt(count.textContent) - 1;

                // Remove like from Firebase
                db.collection('highlights').doc(highlightId.toString()).collection('likes').doc(userId).delete()
                    .catch(err => console.error('Error removing like:', err));
            } else {
                btn.classList.add('liked');
                btn.style.background = 'rgba(255, 215, 0, 0.25)';
                btn.style.color = 'var(--accent-gold)';
                count.textContent = parseInt(count.textContent) + 1;

                // Save like to Firebase
                db.collection('highlights').doc(highlightId.toString()).collection('likes').doc(userId).set({
                    userId: userId,
                    timestamp: new Date().toISOString(),
                    likedAt: firebase.firestore.FieldValue.serverTimestamp()
                }).catch(err => console.error('Error saving like:', err));
            }
        }

        function showEmojiPicker() {
            const picker = document.getElementById('emojiPicker');
            picker.style.display = picker.style.display === 'none' ? 'block' : 'none';
        }

        function addEmojiReaction(emoji) {
            const highlightId = window.currentViewingHighlight?.id;

            if (!highlightId || !auth.currentUser) {
                showToast('Please sign in to react', 'error');
                return;
            }

            const userId = auth.currentUser.uid;
            const reactions = document.getElementById('emojiReactions');
            const existingEmoji = Array.from(reactions.children).find(e => e.textContent.includes(emoji));

            if (existingEmoji) {
                const count = parseInt(existingEmoji.textContent.split(' ')[1]) + 1;
                existingEmoji.textContent = `${emoji} ${count}`;
            } else {
                const span = document.createElement('span');
                span.style.cssText = 'display: inline-block; margin-right: 8px; padding: 5px 10px; background: rgba(255, 215, 0, 0.1); border-radius: 15px; font-size: 0.9em;';
                span.textContent = `${emoji} 1`;
                reactions.appendChild(span);
            }

            // Save reaction to Firebase
            const reactionRef = db.collection('highlights').doc(highlightId.toString()).collection('reactions');
            const reactionId = `${userId}-${emoji}`;

            reactionRef.doc(reactionId).set({
                userId: userId,
                emoji: emoji,
                timestamp: new Date().toISOString(),
                reactedAt: firebase.firestore.FieldValue.serverTimestamp()
            }).catch(err => console.error('Error saving reaction:', err));

            document.getElementById('emojiPicker').style.display = 'none';
        }

        function openGiftPopup() {
            document.getElementById('giftPopupOverlay').classList.add('active');
        }

        function closeGiftPopup() {
            document.getElementById('giftPopupOverlay').classList.remove('active');
        }

        function selectGift(giftName, giftCost) {
            const giftPrice = giftCost * 20; // Convert coins to naira

            // Check if user has sufficient balance
            if (walletData.balance < giftPrice) {
                showToast(`Insufficient balance! Need ${giftPrice} but you have ${walletData.balance}`, 'error');
                return;
            }

            // Confirm gift purchase
            if (!confirm(`Send "${giftName}" for ${giftPrice}?\n\nYour balance: ${walletData.balance}`)) {
                return;
            }

            // Get gift recipient's DLS account (highlight owner)
            const recipientDLSAccount = window.currentViewingHighlight?.ownerDLSAccount || 'DLS40992';

            // Deduct from sender's balance
            const newBalance = walletData.balance - giftPrice;
            walletData.balance = newBalance;

            // Save updated balance to Firebase
            saveWalletDataToFirebase();

            // Create transaction record for sender (cost)
            const giftTransaction = {
                id: 'GIFT-' + Math.random().toString(36).substr(2, 9).toUpperCase(),
                type: 'gift_sent',
                amount: giftPrice,
                giftName: giftName,
                giftCoins: giftCost,
                recipientDLS: recipientDLSAccount,
                status: 'completed',
                timestamp: new Date().toISOString(),
                date: new Date().toLocaleDateString()
            };

            // Add transaction to history
            walletData.transactions = walletData.transactions || [];
            walletData.transactions.unshift(giftTransaction);
            saveWalletDataToFirebase();

            // Create credit transaction for recipient (auto-deposit to their DLS account)
            const creditTransaction = {
                id: 'GIFT-CREDIT-' + Math.random().toString(36).substr(2, 9).toUpperCase(),
                type: 'gift_received',
                amount: giftPrice,
                giftName: giftName,
                giftCoins: giftCost,
                senderUID: auth.currentUser?.uid || 'unknown',
                status: 'auto_credited',
                timestamp: new Date().toISOString(),
                date: new Date().toLocaleDateString()
            };

            // Save credit transaction to recipient's DLS account in Firebase
            db.collection('dls_accounts').doc(recipientDLSAccount).get().then(doc => {
                if (doc.exists) {
                    const recipientData = doc.data();
                    const recipientTransactions = recipientData.transactions || [];
                    recipientTransactions.unshift(creditTransaction);
                    const newRecipientBalance = (recipientData.balance || 0) + giftPrice;

                    db.collection('dls_accounts').doc(recipientDLSAccount).update({
                        balance: newRecipientBalance,
                        transactions: recipientTransactions,
                        lastUpdated: new Date().toISOString()
                    }).then(() => {
                        console.log(` Gift credited to ${recipientDLSAccount}`);
                    }).catch(err => console.error('Error crediting gift:', err));
                } else {
                    // Create new DLS account if doesn't exist
                    db.collection('dls_accounts').doc(recipientDLSAccount).set({
                        dlsAccount: recipientDLSAccount,
                        balance: giftPrice,
                        transactions: [creditTransaction],
                        createdAt: new Date().toISOString(),
                        lastUpdated: new Date().toISOString()
                    }).catch(err => console.error('Error creating DLS account:', err));
                }
            }).catch(err => console.error('Error processing gift:', err));

            // Show success message
            showToast(` ${giftName} sent!\nBalance: ${newBalance} | Sent to: ${recipientDLSAccount}`, 'success');

            // Update wallet display
            if (document.getElementById('displayBalance')) {
                document.getElementById('displayBalance').textContent = '' + newBalance.toLocaleString();
            }

            closeGiftPopup();
        }

        function addComment() {
            const input = document.getElementById('commentInput');
            const comment = input.value.trim();
            if (!comment) return;

            const highlightId = window.currentViewingHighlight?.id;

            if (!highlightId || !auth.currentUser) {
                showToast('Please sign in to comment', 'error');
                return;
            }

            const userId = auth.currentUser.uid;
            const userName = userData.name || 'Anonymous';
            const commentId = 'CMT-' + Math.random().toString(36).substr(2, 9).toUpperCase();

            // Save comment to Firebase
            db.collection('highlights').doc(highlightId.toString()).collection('comments').doc(commentId).set({
                commentId: commentId,
                userId: userId,
                userName: userName,
                text: comment,
                timestamp: new Date().toISOString(),
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                // Display comment locally
                const section = document.getElementById('commentsSection');
                const commentDiv = document.createElement('div');
                commentDiv.className = 'comment-item';
                commentDiv.innerHTML = `<strong>${userName}</strong><br>${comment}`;
                section.appendChild(commentDiv);
                input.value = '';
                section.scrollTop = section.scrollHeight;
                showToast('Comment posted!', 'success');
            }).catch(err => {
                console.error('Error saving comment:', err);
                showToast('Failed to post comment', 'error');
            });
        }

        // ===== FULL MATCHES MODAL =====
        let fullMatchesCurrentTab = 'today';
        let fullMatchesCurrentSubTab = 'single';

        function openFullMatchesModal() {
            document.getElementById('fullMatchesModalOverlay').classList.add('active');
            renderFullMatches();
        }

        function closeFullMatchesModal() {
            document.getElementById('fullMatchesModalOverlay').classList.remove('active');
        }

        function switchFullMatchesTab(btn, tab) {
            // Update active tab
            document.querySelectorAll('#fullMatchesTabs .tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            fullMatchesCurrentTab = tab;
            renderFullMatches();
        }

        function switchFullMatchesSubTab(btn, subTab) {
            // Update active sub-tab
            document.querySelectorAll('.full-matches-controls .sub-tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            fullMatchesCurrentSubTab = subTab;
            renderFullMatches();
        }

        function filterFullMatches() {
            renderFullMatches();
        }

        function renderFullMatches() {
            const container = document.getElementById('fullMatchesContainer');
            const today = getTodayDate();
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const tomorrowDate = tomorrow.toISOString().split('T')[0];

            if (!sampleMatches || sampleMatches.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; padding: 40px; text-align: center; color: var(--text-gray);">No matches loaded</div>';
                return;
            }

            // Get search term
            const searchTerm = document.getElementById('fullMatchesSearchInput')?.value?.toLowerCase() || '';

            // Filter by tab
            let filteredMatches = sampleMatches.filter(match => {
                if (fullMatchesCurrentTab === 'today') return match.matchDate === today;
                if (fullMatchesCurrentTab === 'tomorrow') return match.matchDate === tomorrowDate;
                if (fullMatchesCurrentTab === 'upcoming') return match.matchDate > tomorrowDate;
                if (fullMatchesCurrentTab === 'live') return match.matchDate === today || match.status === 'live';
                if (fullMatchesCurrentTab === 'finished') return match.matchDate < today || match.status === 'finished';
                return true;
            });

            // Filter by sub-tab (if not searching)
            if (!searchTerm) {
                filteredMatches = filteredMatches.filter(match => {
                    if (fullMatchesCurrentSubTab === 'single') return !match.type || !match.type.includes('Tournament');
                    if (fullMatchesCurrentSubTab === 'tournament') return match.type && match.type.includes('Tournament');
                    return true;
                });
            }

            // Apply search filter across ALL matches
            if (searchTerm) {
                filteredMatches = sampleMatches.filter(match => {
                    return (match.teamA?.name || '').toLowerCase().includes(searchTerm) ||
                        (match.teamB?.name || '').toLowerCase().includes(searchTerm) ||
                        (match.competition || '').toLowerCase().includes(searchTerm);
                });
            }

            if (filteredMatches.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; padding: 40px; text-align: center; color: var(--text-gray);">No matches found</div>';
                return;
            }

            // Render matches in grid with mini banners every 5 matches
            let html = '';
            filteredMatches.forEach((match, index) => {
                // Add mini banner every 5 matches
                if (index > 0 && index % 5 === 0) {
                    html += `<div class="full-match-mini-banner" style="grid-column: 1/-1;"> Advertisement</div>`;
                }
                html += createFullMatchCardHTML(match);
            });

            container.innerHTML = html;
        }

        function createFullMatchCardHTML(match) {
            const scoreA = match.finalScore?.teamA || match.currentScore?.teamA || 0;
            const scoreB = match.finalScore?.teamB || match.currentScore?.teamB || 0;
            const hasLivestream = match.livestreamUrl || (match.matchDate === getTodayDate() && match.status === 'live');

            return `
                <div class="full-match-card">
                    <div class="full-match-card-header">
                        <span class="competition-type">${match.competition || 'Match'}</span>
                        <span class="match-time">${getMatchStatus(match.matchDate, match.status)}</span>
                    </div>
                    <div style="text-align: center; font-size: 0.85em; color: var(--accent-gold); margin-bottom: 10px;">
                        ${formatDateWithDay(match.matchDate)}
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <div style="flex: 1; text-align: center;">
                            <div style="font-weight: 700; color: var(--text-white); font-size: 0.95em;">${match.teamA?.name || 'Team A'}</div>
                            <div style="font-size: 0.8em; color: var(--text-gray);">${match.teamA?.owner || 'Host'}</div>
                        </div>
                        <div class="full-match-card-score">${scoreA} - ${scoreB}</div>
                        <div style="flex: 1; text-align: center;">
                            <div style="font-weight: 700; color: var(--text-white); font-size: 0.95em;">${match.teamB?.name || 'Team B'}</div>
                            <div style="font-size: 0.8em; color: var(--text-gray);">${match.teamB?.owner || 'Host'}</div>
                        </div>
                    </div>
                    <div style="text-align: center; font-size: 0.85em; color: var(--text-gray);">
                         ${match.matchTime || '--:--'}
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 12px;">
                        <button onclick="openStatsModal('${match.id}')" style="flex: 1; padding: 10px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); color: var(--accent-gold); border-radius: 8px; cursor: pointer; font-weight: 600;"> View Details</button>
                        ${hasLivestream ? `<button onclick="watchLiveMatch('${match.id}')" style="flex: 1; padding: 10px; background: rgba(255, 0, 0, 0.15); border: 1px solid rgba(255, 0, 0, 0.3); color: #ff6b6b; border-radius: 8px; cursor: pointer; font-weight: 600;"> Live</button>` : ''}
                    </div>
                </div>
            `;
        }

        // Watch live for specific match
        function watchLiveMatch(matchId) {
            const match = sampleMatches.find(m => m.id === matchId);
            if (!match) {
                showToast('Match not found', 'error');
                return;
            }
            const livestreamUrl = match.livestreamUrl || `https://www.youtube.com/watch?v=${matchId}`;
            window.open(livestreamUrl, '_blank');
            showToast('Opening livestream...', 'info');
        }

        // Create match card HTML
        function createMatchCardHTML(match, index) {
            const scoreA = match.finalScore?.teamA || match.currentScore?.teamA || 0;
            const scoreB = match.finalScore?.teamB || match.currentScore?.teamB || 0;
            const yellowA = match.finalStats?.yellowCards?.teamA || 0;
            const yellowB = match.finalStats?.yellowCards?.teamB || 0;
            const redA = match.finalStats?.redCards?.teamA || 0;
            const redB = match.finalStats?.redCards?.teamB || 0;
            const cornersA = match.finalStats?.corners?.teamA || 0;
            const cornersB = match.finalStats?.corners?.teamB || 0;
            const possessionA = match.finalStats?.possession?.teamA || 50;
            const possessionB = match.finalStats?.possession?.teamB || 50;
            const shotsA = match.finalStats?.shots?.teamA || 0;
            const shotsB = match.finalStats?.shots?.teamB || 0;
            const cardId = `match-card-${match.id}`;
            const statsId = `stats-${match.id}`;

            return `
                <div class="match-card" id="${cardId}" style="animation-delay: ${index * 0.1}s">
                    <div class="match-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <div>
                            <span class="competition-type">${match.competition || 'Match'}</span>
                            <span class="match-time" style="margin-left: 10px;">${getMatchStatus(match.matchDate, match.status)}</span>
                         </div>
                        <button class="match-toggle-btn" onclick="toggleMatchStats('${statsId}')" style="border: none; background: none; cursor: pointer; font-size: 1.5em; padding: 0 5px; color: var(--accent-gold); transition: transform 0.3s ease;"></button>
                    </div>
                    <div style="text-align: center; margin-bottom: 12px; font-size: 0.9em; color: var(--text-gray);">
                          ${match.matchTime || '--:--'}
                    </div>
                    <div style="text-align: center; margin-bottom: 12px; font-size: 0.85em; color: var(--accent-gold); font-weight: 500;">
                          ${formatDateWithDay(match.matchDate)}
                    </div>
                    <div class="teams-section">
                        <div class="team">
                            <div class="team-logo">${getTeamLogo(match.teamA)}</div>
                            <div class="team-name">${match.teamA?.name || 'Team A'}</div>
                            <div class="team-info">${match.teamA?.owner || 'Host'}</div>
                        </div>
                        <div class="vs-divider" style="font-size: 1.8em;">${scoreA} - ${scoreB}</div>
                        <div class="team">
                            <div class="team-logo">${getTeamLogo(match.teamB)}</div>
                            <div class="team-name">${match.teamB?.name || 'Team B'}</div>
                            <div class="team-info">${match.teamB?.owner || 'Host'}</div>
                        </div>
                    </div>
                    
                    <div id="${statsId}" class="match-stats-container" style="display: block; transition: all 0.3s ease; overflow: hidden; max-height: 500px; opacity: 1;">
                        ${createStatsHTML(cornersA, cornersB, possessionA, possessionB, shotsA, shotsB)}
                        ${createCardsHTML(yellowA, yellowB, redA, redB)}
                    </div>
                    
                    <div class="match-footer">
                         <button class="live-badge available" onclick="openStatsModal('${match.id}')" style="border: none; background: none; cursor: pointer; padding: 0;"> View Stats</button>
                      </div>
                </div>
            `;
        }

        // Toggle match stats visibility
        function toggleMatchStats(statsId) {
            const statsDiv = document.getElementById(statsId);
            const matchId = statsId.replace('stats-', '');
            const btn = document.querySelector(`button[onclick="toggleMatchStats('${statsId}')"]`);

            const isHidden = statsDiv.style.display === 'none' || statsDiv.style.maxHeight === '0px';

            if (isHidden) {
                // Show
                statsDiv.style.display = 'block';
                statsDiv.style.opacity = '1';
                statsDiv.style.maxHeight = '500px';
                if (btn) btn.style.transform = 'rotate(180deg)';
            } else {
                // Hide
                statsDiv.style.maxHeight = '0';
                statsDiv.style.opacity = '0';
                statsDiv.style.overflow = 'hidden';
                setTimeout(() => {
                    if (statsDiv.style.maxHeight === '0px') statsDiv.style.display = 'none';
                }, 300);
                if (btn) btn.style.transform = 'rotate(0deg)';
            }
        }

        // Create statistics HTML
        function createStatsHTML(cornersA, cornersB, possessionA, possessionB, shotsA, shotsB) {
            return `
                <div style="background: rgba(255, 215, 0, 0.05); border: 1px solid rgba(255, 215, 0, 0.1); border-radius: 8px; padding: 10px; margin: 12px 0; font-size: 0.8em;">
                    <div style="margin-bottom: 8px; text-align: center; color: var(--text-gray); font-weight: 600;"> Match Statistics</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; color: var(--text-white);">
                        <span>${cornersA}</span>
                        <span style="color: var(--accent-gold);"><i class="fas fa-flag-checkered"></i> Corners</span>
                        <span>${cornersB}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; color: var(--text-white);">
                        <span>${possessionA}%</span>
                        <span style="color: var(--accent-gold);"><i class="fas fa-futbol"></i> Possession</span>
                        <span>${possessionB}%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; color: var(--text-white);">
                        <span>${shotsA}</span>
                        <span style="color: var(--accent-gold);"><i class="fas fa-crosshairs"></i> Shots</span>
                        <span>${shotsB}</span>
                    </div>
                </div>
            `;
        }

        // Create cards HTML
        function createCardsHTML(yellowA, yellowB, redA, redB) {
            return `
                <div style="text-align: center; padding: 10px; background: rgba(255, 215, 0, 0.05); border-radius: 8px; margin: 12px 0;">
                    <div style="font-size: 0.8em; color: var(--accent-gold); margin-bottom: 8px; font-weight: 600;"><i class="fas fa-exclamation-circle"></i> Cards</div>
                    <div style="display: flex; justify-content: space-around;">
                        <div style="display: flex; gap: 4px; align-items: center; flex-direction: column;">
                            <div style="display: flex; gap: 2px; font-size: 1.2em;">
                                ${yellowA > 0 ? `<i class="fas fa-square" style="color: #ffeb3b;"></i>`.repeat(Math.min(yellowA, 2)) : ''}
                                ${redA > 0 ? `<i class="fas fa-square" style="color: #ff5252;"></i>`.repeat(Math.min(redA, 2)) : ''}
                            </div>
                            <div style="font-size: 0.7em; color: var(--text-gray);"><i class="fas fa-square" style="color: #ffeb3b;"></i> ${yellowA} <i class="fas fa-square" style="color: #ff5252;"></i> ${redA}</div>
                        </div>
                        <div style="display: flex; gap: 4px; align-items: center; flex-direction: column;">
                            <div style="display: flex; gap: 2px; font-size: 1.2em;">
                                ${yellowB > 0 ? `<i class="fas fa-square" style="color: #ffeb3b;"></i>`.repeat(Math.min(yellowB, 2)) : ''}
                                ${redB > 0 ? `<i class="fas fa-square" style="color: #ff5252;"></i>`.repeat(Math.min(redB, 2)) : ''}
                            </div>
                            <div style="font-size: 0.7em; color: var(--text-gray);"><i class="fas fa-square" style="color: #ffeb3b;"></i> ${yellowB} <i class="fas fa-square" style="color: #ff5252;"></i> ${redB}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Initialize page - Load all data from Firebase
        loadNewsFromFirebase();
        loadSponsorsFromFirebase();
        loadMatchesFromFirebase();
    </script>

    <!-- FULL STATS MODAL -->
    <div class="stats-modal-overlay" id="statsModalOverlay">
        <div class="stats-modal">
            <div class="stats-modal-header">
                <h2 class="stats-modal-title" id="statsMatchTitle">Match Stats</h2>
                <button class="stats-modal-close" onclick="closeStatsModal()"></button>
            </div>
            <div class="stats-modal-content">
                <!-- Teams & Score -->
                <div class="stats-section">
                    <div class="stats-section-title"> Match Overview</div>
                    <div
                        style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center; margin-bottom: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.5em; font-weight: 700; color: var(--accent-gold); margin-bottom: 8px;"
                                id="statsTeamA">Team A</div>
                            <div style="color: var(--text-gray); font-size: 0.9em;" id="statsOwnerA">Host</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 3em; font-weight: 900; color: var(--accent-gold);">
                                <span id="statsScoreA">0</span> - <span id="statsScoreB">0</span>
                            </div>
                            <div style="color: var(--text-gray); margin-top: 8px;" id="statsStatus">UPCOMING</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5em; font-weight: 700; color: var(--accent-gold); margin-bottom: 8px;"
                                id="statsTeamB">Team B</div>
                            <div style="color: var(--text-gray); font-size: 0.9em;" id="statsOwnerB">Host</div>
                        </div>
                    </div>
                    <div style="color: var(--text-gray); text-align: center; font-size: 0.95em;">
                         <span id="statsTime">--:--</span> |  <span id="statsDate">N/A</span>
                    </div>
                </div>

                <!-- Match Statistics -->
                <div class="stats-section">
                    <div class="stats-section-title"><i class="fas fa-chart-bar"></i> Match Statistics</div>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-box-label"><i class="fas fa-flag-checkered"></i> Corners</div>
                            <div style="display: flex; justify-content: space-around; align-items: center;">
                                <span class="stat-box-value" id="statsCornersA">0</span>
                                <span style="color: var(--text-gray);">-</span>
                                <span class="stat-box-value" id="statsCornersB">0</span>
                            </div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-box-label"><i class="fas fa-futbol"></i> Possession</div>
                            <div style="display: flex; justify-content: space-around; align-items: center;">
                                <span class="stat-box-value" id="statsPossessionA">50<span
                                        style="font-size: 0.8em;">%</span></span>
                                <span style="color: var(--text-gray);">-</span>
                                <span class="stat-box-value" id="statsPossessionB">50<span
                                        style="font-size: 0.8em;">%</span></span>
                            </div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-box-label"><i class="fas fa-crosshairs"></i> Shots</div>
                            <div style="display: flex; justify-content: space-around; align-items: center;">
                                <span class="stat-box-value" id="statsShotsA">0</span>
                                <span style="color: var(--text-gray);">-</span>
                                <span class="stat-box-value" id="statsShotsB">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Yellow & Red Cards -->
                <div class="stats-section">
                    <div class="stats-section-title"><i class="fas fa-exclamation-circle"></i> Cards</div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="text-align: center;">
                            <div style="color: var(--text-gray); margin-bottom: 10px;">Team A</div>
                            <div style="font-size: 1.2em;">
                                <i class="fas fa-square" style="color: #ffeb3b;"></i> <span id="statsYellowA">0</span>
                                <i class="fas fa-square" style="color: #ff5252; margin-left: 10px;"></i> <span
                                    id="statsRedA">0</span>
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <div style="color: var(--text-gray); margin-bottom: 10px;">Team B</div>
                            <div style="font-size: 1.2em;">
                                <i class="fas fa-square" style="color: #ffeb3b;"></i> <span id="statsYellowB">0</span>
                                <i class="fas fa-square" style="color: #ff5252; margin-left: 10px;"></i> <span
                                    id="statsRedB">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Goal Scorers -->
                <div class="stats-section" id="goalScorersSection" style="display: none;">
                    <div class="stats-section-title"> Goal Scorers</div>
                    <div id="goalScorersList" class="goal-scorers-list"></div>
                </div>

                <!-- Predictions -->
                <div class="stats-section" id="predictionsSection" style="display: none;">
                    <div class="stats-section-title"> Predictions</div>
                    <div id="predictionsList" class="prediction-list"></div>
                </div>

                <!-- Livestream Button -->
                <div class="stats-section" id="livestreamSection" style="display: none; text-align: center;">
                    <button class="livestream-btn" id="livestreamBtn" onclick="openLivestream()">
                         WATCH LIVE
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- PLAYERS MODAL -->
    <div class="players-modal-overlay" id="playersModalOverlay">
        <div class="players-modal">
            <div class="players-modal-header">
                <h2 class="players-modal-title" id="playersModalTitle">Match Players</h2>
                <button class="players-modal-close" onclick="closePlayersModal()"></button>
            </div>
            <div class="players-modal-content">
                <!-- Team A Info -->
                <div class="team-players-section">
                    <div class="team-players-title"> Team A - <span id="playersTeamAName">Team A</span></div>

                    <!-- Team Leadership -->
                    <div
                        style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 20px; margin-bottom: 30px;">
                        <!-- Host/Coach Info -->
                        <div
                            style="text-align: center; padding: 15px; background: rgba(255, 215, 0, 0.1); border-radius: 12px;">
                            <div
                                style="font-size: 0.85em; color: var(--accent-gold); margin-bottom: 10px; font-weight: 600;">
                                 HOST/COACH</div>
                            <img id="teamAHostImg"
                                src="data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2280%22 height=%2280%22%3E%3Crect fill=%22%23333%22 width=%2280%22 height=%2280%22 rx=%228%22/%3E%3Ctext x=%2240%22 y=%2245%22 font-size=%2224%22 fill=%22%23999%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22%3EHost%3C/text%3E%3C/svg%3E"
                                style="width: 80px; height: 80px; border-radius: 8px; object-fit: cover; margin: 0 auto 10px; display: block;">
                            <div id="teamAHostName"
                                style="color: var(--text-white); font-weight: 600; margin-bottom: 3px; font-size: 0.9em;">
                                Host Name</div>
                            <div style="font-size: 0.75em; color: var(--text-gray);">Coach</div>
                        </div>
                        <!-- Club Owner Info -->
                        <div
                            style="text-align: center; padding: 15px; background: rgba(0, 255, 136, 0.1); border-radius: 12px;">
                            <div
                                style="font-size: 0.85em; color: var(--accent-green); margin-bottom: 10px; font-weight: 600;">
                                 CLUB OWNER</div>
                            <div
                                style="width: 80px; height: 80px; border-radius: 8px; background: rgba(0, 255, 136, 0.2); margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 2.5em;">
                                </div>
                            <div id="teamAOwner"
                                style="color: var(--text-white); font-weight: 600; margin-bottom: 3px; font-size: 0.9em;">
                                Club Owner</div>
                            <div style="font-size: 0.75em; color: var(--text-gray);">Owner</div>
                        </div>
                        <!-- Captain Info -->
                        <div
                            style="text-align: center; padding: 15px; background: rgba(255, 215, 0, 0.1); border-radius: 12px;">
                            <div
                                style="font-size: 0.85em; color: var(--accent-gold); margin-bottom: 10px; font-weight: 600;">
                                 CAPTAIN</div>
                            <div
                                style="width: 80px; height: 80px; border-radius: 8px; background: rgba(255, 215, 0, 0.2); margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 2.5em;">
                                </div>
                            <div id="teamACaptain"
                                style="color: var(--text-white); font-weight: 600; margin-bottom: 3px; font-size: 0.9em;">
                                Captain Name</div>
                            <div style="font-size: 0.75em; color: var(--text-gray);">Captain</div>
                        </div>
                    </div>

                    <!-- Players List -->
                    <div style="margin-top: 20px;">
                        <div
                            style="color: var(--accent-gold); font-size: 1.1em; font-weight: 700; margin-bottom: 15px;">
                             Squad Players</div>
                        <div id="teamAPlayersList" style="display: grid; gap: 10px;">
                            <!-- Players will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Team B Info -->
                <div class="team-players-section">
                    <div class="team-players-title"> Team B - <span id="playersTeamBName">Team B</span></div>

                    <!-- Team Leadership -->
                    <div
                        style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 20px; margin-bottom: 30px;">
                        <!-- Host/Coach Info -->
                        <div
                            style="text-align: center; padding: 15px; background: rgba(255, 215, 0, 0.1); border-radius: 12px;">
                            <div
                                style="font-size: 0.85em; color: var(--accent-gold); margin-bottom: 10px; font-weight: 600;">
                                 HOST/COACH</div>
                            <img id="teamBHostImg"
                                src="data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2280%22 height=%2280%22%3E%3Crect fill=%22%23333%22 width=%2280%22 height=%2280%22 rx=%228%22/%3E%3Ctext x=%2240%22 y=%2245%22 font-size=%2224%22 fill=%22%23999%22 text-anchor=%22middle%22 dominant-baseline=%22middle%22%3EHost%3C/text%3E%3C/svg%3E"
                                style="width: 80px; height: 80px; border-radius: 8px; object-fit: cover; margin: 0 auto 10px; display: block;">
                            <div id="teamBHostName"
                                style="color: var(--text-white); font-weight: 600; margin-bottom: 3px; font-size: 0.9em;">
                                Host Name</div>
                            <div style="font-size: 0.75em; color: var(--text-gray);">Coach</div>
                        </div>
                        <!-- Club Owner Info -->
                        <div
                            style="text-align: center; padding: 15px; background: rgba(0, 255, 136, 0.1); border-radius: 12px;">
                            <div
                                style="font-size: 0.85em; color: var(--accent-green); margin-bottom: 10px; font-weight: 600;">
                                 CLUB OWNER</div>
                            <div
                                style="width: 80px; height: 80px; border-radius: 8px; background: rgba(0, 255, 136, 0.2); margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 2.5em;">
                                </div>
                            <div id="teamBOwner"
                                style="color: var(--text-white); font-weight: 600; margin-bottom: 3px; font-size: 0.9em;">
                                Club Owner</div>
                            <div style="font-size: 0.75em; color: var(--text-gray);">Owner</div>
                        </div>
                        <!-- Captain Info -->
                        <div
                            style="text-align: center; padding: 15px; background: rgba(255, 215, 0, 0.1); border-radius: 12px;">
                            <div
                                style="font-size: 0.85em; color: var(--accent-gold); margin-bottom: 10px; font-weight: 600;">
                                 CAPTAIN</div>
                            <div
                                style="width: 80px; height: 80px; border-radius: 8px; background: rgba(255, 215, 0, 0.2); margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-size: 2.5em;">
                                </div>
                            <div id="teamBCaptain"
                                style="color: var(--text-white); font-weight: 600; margin-bottom: 3px; font-size: 0.9em;">
                                Captain Name</div>
                            <div style="font-size: 0.75em; color: var(--text-gray);">Captain</div>
                        </div>
                    </div>

                    <!-- Players List -->
                    <div style="margin-top: 20px;">
                        <div
                            style="color: var(--accent-gold); font-size: 1.1em; font-weight: 700; margin-bottom: 15px;">
                             Squad Players</div>
                        <div id="teamBPlayersList" style="display: grid; gap: 10px;">
                            <!-- Players will be rendered here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- HIGHLIGHT VIEWER MODAL -->
    <div class="highlight-viewer-overlay" id="highlightViewerOverlay">
        <div class="highlight-viewer-modal">
            <!-- Close Button -->
            <button class="highlight-viewer-close" onclick="closeHighlightViewer()"></button>

            <!-- Video Container -->
            <div class="highlight-viewer-video">
                <iframe id="viewerVideoIframe" style="width: 100%; height: 100%; border: none;"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen></iframe>
            </div>

            <!-- Video Info & Controls -->
            <div class="highlight-viewer-content">
                <div class="highlight-viewer-info">
                    <!-- Video Title & Meta -->
                    <div>
                        <h3 id="viewerHighlightTitle"
                            style="color: var(--accent-gold); margin: 0 0 8px 0; font-size: 1.3em;">Highlight Title</h3>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span style="color: var(--text-gray); font-size: 0.9em;">By <span id="viewerTeamName"
                                        style="color: var(--text-white); font-weight: 600;">Team</span></span>
                                <div style="color: var(--text-gray); font-size: 0.85em; margin-top: 4px;"> <span
                                        id="viewerHighlightDate">2025-12-01</span></div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 0.75em; color: var(--text-gray); margin-bottom: 4px;">Likes</div>
                                <div style="font-size: 1.5em; color: var(--accent-gold); font-weight: 700;"
                                    id="viewerLikeCount">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="highlight-viewer-actions">
                        <button id="likeBtn" onclick="likeHighlight()"
                            style="flex: 1; padding: 12px; background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); color: var(--text-white); border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s; font-size: 0.95em;">
                            Like</button>
                        <button onclick="showEmojiPicker()"
                            style="flex: 1; padding: 12px; background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.3); color: var(--accent-green); border-radius: 8px; cursor: pointer; font-weight: 600; margin-left: 8px; font-size: 0.95em;">
                            React</button>
                        <button onclick="openGiftPopup()"
                            style="flex: 1; padding: 12px; background: rgba(255, 100, 100, 0.1); border: 1px solid rgba(255, 100, 100, 0.3); color: #ff6464; border-radius: 8px; cursor: pointer; font-weight: 600; margin-left: 8px; font-size: 0.95em;">
                            Gift</button>
                    </div>

                    <!-- Emoji Picker (Hidden) -->
                    <div id="emojiPicker"
                        style="display: none; margin-top: 12px; padding: 12px; background: rgba(255, 215, 0, 0.05); border-radius: 8px; border: 1px solid rgba(255, 215, 0, 0.2);">
                        <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
                            <button onclick="addEmojiReaction('')"
                                style="padding: 8px 12px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s;"></button>
                            <button onclick="addEmojiReaction('')"
                                style="padding: 8px 12px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s;"></button>
                            <button onclick="addEmojiReaction('')"
                                style="padding: 8px 12px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s;"></button>
                            <button onclick="addEmojiReaction('')"
                                style="padding: 8px 12px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s;"></button>
                            <button onclick="addEmojiReaction('')"
                                style="padding: 8px 12px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s;"></button>
                            <button onclick="addEmojiReaction('')"
                                style="padding: 8px 12px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s;"></button>
                            <button onclick="addEmojiReaction('')"
                                style="padding: 8px 12px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s;"></button>
                            <button onclick="addEmojiReaction('')"
                                style="padding: 8px 12px; background: rgba(255, 215, 0, 0.15); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s;"></button>
                        </div>
                    </div>

                    <!-- Emoji Reactions Display -->
                    <div id="emojiReactions"
                        style="margin-top: 12px; padding: 10px; background: rgba(255, 215, 0, 0.05); border-radius: 8px; min-height: 30px;">
                    </div>
                </div>

                <!-- Comments Section (Sidebar) -->
                <div class="highlight-viewer-comments">
                    <h4 style="color: var(--accent-gold); margin: 0 0 15px 0; font-size: 1em;"> Comments</h4>
                    <div id="commentsSection" style="margin-bottom: 15px; max-height: 350px; overflow-y: auto;">
                        <!-- Comments will appear here -->
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 8px; margin-top: auto;">
                        <input type="text" id="commentInput" placeholder="Add a comment..."
                            style="width: 100%; padding: 10px; background: rgba(255, 215, 0, 0.05); border: 1px solid rgba(255, 215, 0, 0.2); border-radius: 8px; color: var(--text-white); font-family: inherit; font-size: 0.9em;">
                        <button onclick="addComment()"
                            style="width: 100%; padding: 10px; background: rgba(255, 215, 0, 0.2); border: 1px solid rgba(255, 215, 0, 0.3); color: var(--accent-gold); border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s;">Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GIFT POPUP -->
    <div class="gift-popup-overlay" id="giftPopupOverlay" onclick="closeGiftPopup()">
        <div class="gift-popup" onclick="event.stopPropagation()">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="color: var(--accent-gold); margin: 0;">Send a Gift </h3>
                <button onclick="closeGiftPopup()"
                    style="background: none; border: none; color: var(--text-gray); font-size: 1.5em; cursor: pointer;"></button>
            </div>
            <div class="gifts-grid">
                <!-- Football Related Gifts -->
                <div class="gift-item" onclick="selectGift('Football', 1)"><div>Football</div><small>1 coin =
                        20</small></div>
                <div class="gift-item" onclick="selectGift('Goal', 2)"><div>Goal</div><small>2 coins = 40</small>
                </div>
                <div class="gift-item" onclick="selectGift('Trophy', 5)"><div>Trophy</div><small>5 coins =
                        100</small></div>
                <div class="gift-item" onclick="selectGift('Jersey', 3)"><div>Jersey</div><small>3 coins = 60</small>
                </div>

                <!-- TikTok Trending Gifts -->
                <div class="gift-item" onclick="selectGift('Rose', 1)"><div>Rose</div><small>1 coin = 20</small>
                </div>
                <div class="gift-item" onclick="selectGift('Fire', 3)"><div>Fire</div><small>3 coins = 60</small>
                </div>
                <div class="gift-item" onclick="selectGift('Diamond', 10)"><div>Diamond</div><small>10 coins =
                        200</small></div>
                <div class="gift-item" onclick="selectGift('Crown', 25)"><div>Crown</div><small>25 coins =
                        500</small></div>

                <!-- Premium Gifts -->
                <div class="gift-item" onclick="selectGift('Rocket', 15)"><div>Rocket</div><small>15 coins =
                        300</small></div>
                <div class="gift-item" onclick="selectGift('Love', 5)"><div>Love</div><small>5 coins = 100</small>
                </div>
                <div class="gift-item" onclick="selectGift('Star', 8)"><div>Star</div><small>8 coins = 160</small>
                </div>
                <div class="gift-item" onclick="selectGift('Clap', 2)"><div>Clap</div><small>2 coins = 40</small>
                </div>
            </div>
        </div>
    </div>

    <!-- HIGHLIGHTS MODAL -->
    <div class="highlights-modal-overlay" id="highlightsModalOverlay">
        <div class="highlights-modal">
            <!-- Modal Header -->
            <div class="highlights-modal-header">
                <h2 style="color: var(--accent-gold); font-size: 2em; margin: 0;">Highlights</h2>
                <button class="highlights-modal-close" onclick="closeHighlightsModal()"></button>
            </div>

            <!-- Banner at Top -->
            <div class="highlights-banner">
                <div class="banner-container" style="height: 200px; margin-bottom: 20px;">
                    <div class="banner-scroll">
                        <img src="https://images.unsplash.com/photo-1461896836934-ffe607ba8211?w=1200&q=80"
                            alt="Highlights" class="banner-item">
                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=1200&q=80" alt="Goals"
                            class="banner-item">
                        <img src="https://images.unsplash.com/photo-1517694712202-14dd9538aa97?w=1200&q=80" alt="Skills"
                            class="banner-item">
                    </div>
                </div>
            </div>

            <!-- Filters & Search -->
            <div class="highlights-controls">
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                    <div class="highlights-categories">
                        <button class="category-btn active" onclick="filterHighlights(this, 'all')">All</button>
                        <button class="category-btn" onclick="filterHighlights(this, 'goals')"> Goals</button>
                        <button class="category-btn" onclick="filterHighlights(this, 'skills')"> Skills</button>
                        <button class="category-btn" onclick="filterHighlights(this, 'saves')"> Saves</button>
                        <button class="category-btn" onclick="filterHighlights(this, 'best')"> Best Moments</button>
                    </div>
                    <input type="text" class="search-input" id="highlightsSearchInput"
                        placeholder="Search highlights..." onkeyup="renderHighlights()">
                </div>
            </div>

            <!-- Highlights Grid -->
            <div class="highlights-container" id="highlightsContainer">
                <!-- Highlights will be loaded here -->
            </div>
        </div>
    </div>

    <!-- FULL MATCHES MODAL -->
    <div class="full-matches-modal-overlay" id="fullMatchesModalOverlay">
        <div class="full-matches-modal">
            <!-- Modal Header -->
            <div class="full-matches-modal-header">
                <h2 style="color: var(--accent-gold); font-size: 2em; margin: 0;">All Matches</h2>
                <button class="full-matches-modal-close" onclick="closeFullMatchesModal()"></button>
            </div>

            <!-- Banner at Top -->
            <div class="full-matches-banner">
                <div class="banner-container" style="height: 200px; margin-bottom: 20px;">
                    <div class="banner-scroll">
                        <img src="https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=1200&q=80" alt="DLS"
                            class="banner-item">
                        <img src="https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=1200&q=80"
                            alt="Football" class="banner-item">
                        <img src="https://images.unsplash.com/photo-1579952363873-27f3bade9f55?w=1200&q=80" alt="Player"
                            class="banner-item">
                    </div>
                </div>
            </div>

            <!-- Tabs & Controls -->
            <div class="full-matches-controls">
                <!-- Main Tabs -->
                <div class="tabs-container" id="fullMatchesTabs">
                    <button class="tab active" onclick="switchFullMatchesTab(this, 'today')">Today's Games</button>
                    <button class="tab" onclick="switchFullMatchesTab(this, 'tomorrow')">Tomorrow</button>
                    <button class="tab" onclick="switchFullMatchesTab(this, 'upcoming')">Upcoming</button>
                    <button class="tab" onclick="switchFullMatchesTab(this, 'live')">Live Games</button>
                    <button class="tab" onclick="switchFullMatchesTab(this, 'finished')">Finished</button>
                </div>

                <!-- Sub-Tabs & Search -->
                <div style="display: flex; gap: 15px; margin-top: 15px; flex-wrap: wrap; align-items: center;">
                    <div class="sub-tabs-container">
                        <button class="sub-tab active" onclick="switchFullMatchesSubTab(this, 'single')">Single
                            Matches</button>
                        <button class="sub-tab" onclick="switchFullMatchesSubTab(this, 'tournament')">Tournament
                            Matches</button>
                    </div>
                    <input type="text" class="search-input" id="fullMatchesSearchInput" placeholder="Search matches..."
                        onkeyup="filterFullMatches()">
                </div>
            </div>

            <!-- Matches Grid -->
            <div class="full-matches-container" id="fullMatchesContainer">
                <!-- Matches will be loaded here -->
            </div>

            <!-- Loading indicator -->
            <div id="fullMatchesLoading"
                style="text-align: center; padding: 40px; color: var(--text-gray); display: none;">
                <i class="fas fa-spinner fa-spin" style="font-size: 2em; margin-bottom: 10px;"></i>
                <p>Loading more matches...</p>
            </div>
        </div>
    </div>

    <!-- PLAYERS RATING MODAL -->
    <div class="players-rating-overlay" id="playersRatingOverlay">
        <div class="players-rating-modal">
            <div class="players-rating-header">
                <h2 class="players-rating-title">Players Rating</h2>
                <button class="players-rating-close" onclick="closePlayersRatingModal()"></button>
            </div>
            <div class="players-rating-content">
                <div class="players-rating-top">
                    <input type="text" placeholder=" Search players..." id="playersSearchInput"
                        class="players-rating-search-input">
                    <div class="players-rating-buttons" id="playersRatingSidebar">
                    </div>
                </div>
                <div id="registeredPlayersContainer" class="registered-players-container">
                </div>
            </div>
        </div>
    </div>

    <!-- PLAYER REGISTRATION MODAL -->
    <div class="registration-modal-overlay" id="registrationModalOverlay">
        <div class="registration-modal">
            <div class="registration-header">
                <h2 class="registration-title">Register Player Profile</h2>
                <button class="registration-close" onclick="closePlayerRegistrationModal()"></button>
            </div>
            <form id="registrationForm">
                <div class="registration-content">
                    <!-- Basic Information -->
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user"></i> Real Name</label>
                        <input type="text" class="form-input" placeholder="Enter your full real name"
                            oninput="playerRegistrationData.realName = this.value">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-star"></i> Team Score</label>
                            <input type="number" class="form-input" placeholder="e.g., 85"
                                oninput="playerRegistrationData.teamScore = this.value">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-tachometer-alt"></i> Time Strength Rating</label>
                            <input type="text" class="form-input" placeholder="e.g., Excellent"
                                oninput="playerRegistrationData.timeStrength = this.value">
                        </div>
                    </div>

                    <!-- Squad Information -->
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-futbol"></i> Upload Squad First 11</label>
                        <div class="form-upload" onclick="document.getElementById('squadFile').click()">
                            <input type="file" id="squadFile" accept="image/*">
                            <div class="upload-text" id="squadFileLabel"> Click to upload squad image</div>
                        </div>
                        <script>
                            document.getElementById('squadFile').addEventListener('change', function () {
                                uploadPlayerFile('squadFile', 'squadFirst11');
                            });
                        </script>
                    </div>

                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-users"></i> Upload Substitutions</label>
                        <div class="form-upload" onclick="document.getElementById('substitutionsFile').click()">
                            <input type="file" id="substitutionsFile" accept="image/*">
                            <div class="upload-text" id="substitutionsFileLabel"> Click to upload substitutions</div>
                        </div>
                        <script>
                            document.getElementById('substitutionsFile').addEventListener('change', function () {
                                uploadPlayerFile('substitutionsFile', 'substitutions');
                            });
                        </script>
                    </div>

                    <!-- Best Players & Club -->
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-crown"></i> Best Players Name</label>
                        <input type="text" class="form-input" placeholder="Name your best players (comma separated)"
                            oninput="playerRegistrationData.bestPlayers = this.value">
                    </div>

                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-trophy"></i> Favorite Cup/Club</label>
                        <input type="text" class="form-input" placeholder="Your favorite club/cup"
                            oninput="playerRegistrationData.favoriteClub = this.value">
                    </div>

                    <!-- Win/Loss Rating -->
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-check-circle"></i> Win Rating</label>
                            <input type="text" class="form-input" placeholder="e.g., 75%"
                                oninput="playerRegistrationData.winRate = this.value">
                        </div>
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-times-circle"></i> Loss Rating</label>
                            <input type="text" class="form-input" placeholder="e.g., 25%"
                                oninput="playerRegistrationData.lossRate = this.value">
                        </div>
                    </div>

                    <!-- Profile Picture -->
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-image"></i> Upload Your Picture</label>
                        <div class="form-upload" onclick="document.getElementById('playerPictureFile').click()">
                            <input type="file" id="playerPictureFile" accept="image/*">
                            <div class="upload-text" id="playerPictureFileLabel"> Click to upload your photo</div>
                        </div>
                        <script>
                            document.getElementById('playerPictureFile').addEventListener('change', function () {
                                uploadPlayerFile('playerPictureFile', 'playerPicture');
                            });
                        </script>
                    </div>

                    <!-- DLS Team Logo -->
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-shield-alt"></i> DLS Team Logo</label>
                        <div class="form-upload" onclick="document.getElementById('dlsLogoFile').click()">
                            <input type="file" id="dlsLogoFile" accept="image/*">
                            <div class="upload-text" id="dlsLogoFileLabel"> Click to upload team logo</div>
                        </div>
                        <script>
                            document.getElementById('dlsLogoFile').addEventListener('change', function () {
                                uploadPlayerFile('dlsLogoFile', 'dlsLogo');
                            });
                        </script>
                    </div>

                    <!-- Club Image -->
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-futbol"></i> Club Logo/Image</label>
                        <div class="form-upload" onclick="document.getElementById('clubImageFile').click()">
                            <input type="file" id="clubImageFile" accept="image/*">
                            <div class="upload-text" id="clubImageFileLabel"> Click to upload club image</div>
                        </div>
                        <script>
                            document.getElementById('clubImageFile').addEventListener('change', function () {
                                uploadPlayerFile('clubImageFile', 'clubImage');
                            });
                        </script>
                    </div>

                    <!-- Team Image -->
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-users"></i> Team Banner/Image</label>
                        <div class="form-upload" onclick="document.getElementById('teamImageFile').click()">
                            <input type="file" id="teamImageFile" accept="image/*">
                            <div class="upload-text" id="teamImageFileLabel"> Click to upload team image</div>
                        </div>
                        <script>
                            document.getElementById('teamImageFile').addEventListener('change', function () {
                                uploadPlayerFile('teamImageFile', 'teamImage');
                            });
                        </script>
                    </div>

                    <!-- Submit Button -->
                    <button type="button" class="form-button" onclick="submitPlayerRegistration()">
                        <i class="fas fa-check"></i> Complete Registration
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- PLAYER DETAILS MODAL -->
    <div class="player-details-overlay" id="playerDetailsOverlay">
        <div class="player-details-modal">
            <div class="player-details-header">
                <h2 class="player-details-title">Player Profile</h2>
                <button class="player-details-close" onclick="closePlayerDetailsModal()"></button>
            </div>
            <div id="playerIdCardContent">
                <!-- ID Card content inserted here dynamically -->
            </div>
        </div>
    </div>

    <!-- CARD MESSAGING MODAL -->
    <div class="card-messaging-overlay" id="cardMessagingOverlay">
        <div class="card-messaging-modal">
            <div class="card-messaging-header">
                <h2 class="card-messaging-title" id="cardMessagingTitle">Send Message</h2>
                <button class="card-messaging-close" onclick="closeCardMessaging()"></button>
            </div>
            <div class="card-messages-list" id="cardMessagesList">
                <!-- Messages will be displayed here -->
            </div>
            <div class="card-messaging-input-area">
                <textarea class="card-messaging-input" id="cardMessageInput"
                    placeholder="Type your message..."></textarea>
                <div class="card-messaging-buttons">
                    <button class="card-messaging-btn card-messaging-voice-btn" id="cardVoiceRecordBtn"
                        onclick="toggleCardVoiceRecord()">
                        <i class="fas fa-microphone"></i> <span id="cardVoiceRecordText">Voice</span>
                    </button>
                    <button class="card-messaging-btn card-messaging-send-btn" onclick="sendCardMessage()">
                        <i class="fas fa-paper-plane"></i> Send
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- REPLY POPUP - WhatsApp Style -->
    <div class="reply-modal-overlay" id="replyModalOverlay">
        <div class="reply-modal-container">
            <div class="reply-modal-header">
                <div>
                    <div class="reply-modal-title"> Reply</div>
                    <div class="reply-modal-sender-name" id="replySenderName">User</div>
                </div>
                <button class="reply-modal-close-btn" onclick="closeReplyModal()"></button>
            </div>

            <div class="reply-modal-content">
                <!-- Conversation Thread -->
                <div id="replyConversationThread"
                    style="max-height: 400px; overflow-y: auto; margin-bottom: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px; display: flex; flex-direction: column; gap: 10px;">
                    <!-- Messages will load here -->
                </div>

                <!-- Voice Recording Indicator -->
                <div class="reply-voice-indicator" id="replyVoiceIndicator">
                    <i class="fas fa-microphone"></i> Recording voice note... Click Stop to finish
                </div>

                <!-- Text Input Section -->
                <div class="reply-input-section">
                    <label class="reply-input-label"><i class="fas fa-comment"></i> Your Message</label>
                    <textarea class="reply-textarea" id="replyMessageInput"
                        placeholder="Type your message..."></textarea>
                </div>

                <!-- Emoji & Sticker Buttons -->
                <div class="reply-emoji-sticker-container">
                    <button class="reply-emoji-btn" onclick="toggleEmojiPicker()">
                        <i class="fas fa-smile"></i> Emoji
                    </button>
                    <button class="reply-sticker-btn" onclick="toggleStickerPicker()">
                        <i class="fas fa-star"></i> Stickers
                    </button>
                </div>

                <!-- Emoji Picker -->
                <div id="emojiPicker" class="emoji-picker"></div>

                <!-- Sticker Picker -->
                <div id="stickerPicker" class="sticker-picker"></div>

                <!-- Buttons -->
                <div class="reply-button-group">
                    <button class="reply-btn" id="replyVoiceBtn" onclick="toggleReplyVoiceRecord()">
                        <i class="fas fa-microphone"></i> <span id="replyVoiceBtnText">Voice</span>
                    </button>
                </div>

                <!-- Send Button -->
                <button class="reply-send-btn" onclick="sendReplyMessage()">
                    <i class="fas fa-paper-plane"></i> Send
                </button>
            </div>
        </div>
    </div>

    <!-- MORE MENU POPUP -->
    <div class="more-menu-overlay" id="moreMenuOverlay">
        <div class="more-menu-container">
            <div class="more-menu-title">Navigation Menu</div>
            <div class="more-menu-grid">
                <div class="more-menu-item" onclick="openFullMatchesModal()">
                    <i class="fas fa-futbol more-menu-icon"></i>
                    <div class="more-menu-text">Matches</div>
                </div>
                <div class="more-menu-item" onclick="activeNavBtn(this); closeMoreMenu();">
                    <i class="fas fa-trophy more-menu-icon"></i>
                    <div class="more-menu-text">Tournaments</div>
                </div>
                <div class="more-menu-item" onclick="openHighlightsModal()">
                    <i class="fas fa-film more-menu-icon"></i>
                    <div class="more-menu-text">Highlights</div>
                </div>
                <div class="more-menu-item" onclick="activeNavBtn(this); closeMoreMenu();">
                    <i class="fas fa-table more-menu-icon"></i>
                    <div class="more-menu-text">Tables</div>
                </div>
                <div class="more-menu-item" onclick="activeNavBtn(this); closeMoreMenu();">
                    <i class="fas fa-link more-menu-icon"></i>
                    <div class="more-menu-text">Online Linking</div>
                </div>
                <div class="more-menu-item" onclick="activeNavBtn(this); closeMoreMenu();">
                    <i class="fas fa-users more-menu-icon"></i>
                    <div class="more-menu-text">Communities</div>
                </div>
            </div>
            <button class="more-menu-close" onclick="closeMoreMenu()">Close</button>
        </div>
    </div>

    <!-- SHARE LINK MODAL -->
    <div class="share-link-overlay" id="shareLinkOverlay">
        <div class="share-link-container">
            <h2 class="share-link-title">Share Player Profile</h2>
            <p class="share-link-description">Share this link to let others view this player's card and leave ratings:
            </p>
            <div class="share-link-input-group">
                <input type="text" class="share-link-input" readonly>
                <button class="share-link-copy-btn" onclick="copyShareLink()">
                    <i class="fas fa-copy"></i> Copy Link
                </button>
            </div>
            <p style="color: var(--text-gray); font-size: 0.85em; margin-top: 15px;">
                 Anyone with this link can view the profile and rate the player
            </p>
            <button class="share-link-close-btn" onclick="closeShareLinkModal()">Close</button>
        </div>
    </div>

</body>

</html>
